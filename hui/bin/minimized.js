var hui={browser:{},ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};if(!window.n2i){var n2i=hui}hui.browser.opera=/opera/i.test(navigator.userAgent);hui.browser.msie=!hui.browser.opera&&/MSIE/.test(navigator.userAgent);hui.browser.msie6=navigator.userAgent.indexOf("MSIE 6")!==-1;hui.browser.msie7=navigator.userAgent.indexOf("MSIE 7")!==-1;hui.browser.msie8=navigator.userAgent.indexOf("MSIE 8")!==-1;hui.browser.msie9=navigator.userAgent.indexOf("MSIE 9")!==-1;hui.browser.msie9compat=hui.browser.msie7&&navigator.userAgent.indexOf("Trident/5.0")!==-1;hui.browser.webkit=navigator.userAgent.indexOf("WebKit")!==-1;hui.browser.safari=navigator.userAgent.indexOf("Safari")!==-1;hui.browser.chrome=navigator.userAgent.indexOf("Chrome")!==-1;hui.browser.webkitVersion=null;hui.browser.gecko=!hui.browser.webkit&&navigator.userAgent.indexOf("Gecko")!=-1;hui.browser.ipad=hui.browser.webkit&&navigator.userAgent.indexOf("iPad")!=-1;hui.browser.windows=navigator.userAgent.indexOf("Windows")!=-1;hui.browser.opacity=!hui.browser.msie||hui.browser.msie9;(function(){var A=/Safari\/([\d.]+)/.exec(navigator.userAgent);if(A){hui.browser.webkitVersion=parseFloat(A[1])}})();hui.log=function(A){try{console.log(A)}catch(B){}};hui.defer=function(A,B){if(B){A=A.bind(B)}window.setTimeout(A)};hui.override=function(B,A){if(A){for(prop in A){B[prop]=A[prop]}}return B};hui.wrap=function(A){if(A===null||A===undefined){return""}return A.split("").join("\u200B")};hui.trim=function(A){if(A===null||A===undefined){return""}if(typeof (A)!="string"){A=new String(A)}return A.replace(/^[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+|[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+$/g,"")};hui.escapeHTML=function(A){if(A===null||A===undefined){return""}return hui.build("div",{text:A}).innerHTML};hui.escape=function(A){if(!hui.isDefined(A)){return""}return A.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")};hui.isBlank=function(A){if(A===null||typeof (A)==="undefined"||A===""){return true}return typeof (A)=="string"&&hui.trim(A).length==0};hui.isEmpty=function(A){hui.log("hui.isEmpty is deprecated");return hui.isBlank(A)};hui.isDefined=function(A){return A!==null&&typeof (A)!=="undefined"};hui.isArray=function(A){if(A==null||A==undefined){return false}if(A.constructor==Array){return true}else{return Object.prototype.toString.call(A)==="[object Array]"}};hui.string={endsWith:function(B,A){if(!typeof (B)=="string"||!typeof (A)=="string"){return false}return(B.match(A+"$")==A)},camelize:function(F){if(F.indexOf("-")==-1){return F}var D=F.split("-");var B=F.indexOf("-")==0?D[0].charAt(0).toUpperCase()+D[0].substring(1):D[0];for(var C=1,A=D.length;C<A;C++){var E=D[C];B+=E.charAt(0).toUpperCase()+E.substring(1)}return B}};hui.inArray=function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return true}}return false};hui.indexInArray=function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return B}}return -1};hui.each=function(A,D){if(hui.isArray(A)){for(var C=0;C<A.length;C++){D(A[C],C)}}else{for(var B in A){D(B,A[B])}}};hui.intOrString=function(B){if(hui.isDefined(B)){var A=/[0-9]+/.exec(B);if(A!==null&&A[0]==B){if(parseInt(B,10)==B){return parseInt(B,10)}}}return B};hui.flipInArray=function(A,B){if(hui.inArray(A,B)){hui.removeFromArray(A,B)}else{A.push(B)}};hui.removeFromArray=function(A,C){for(var B=A.length-1;B>=0;B--){if(A[B]==C){A.splice(B,1)}}};hui.addToArray=function(A,C){if(C.constructor==Array){for(var B=0;B<C.length;B++){if(!hui.inArray(A,C[B])){A.push(C)}}}else{if(!hui.inArray(A,C)){A.push(C)}}};hui.toIntArray=function(B){var C=B.split(",");for(var A=C.length-1;A>=0;A--){C[A]=parseInt(C[A])}return C};hui.dom={isElement:function(B,A){return B.nodeType==hui.ELEMENT_NODE&&(A===undefined?true:B.nodeName.toLowerCase()==A)},isDefinedText:function(A){return A.nodeType==hui.TEXT_NODE&&A.nodeValue.length>0},addText:function(A,B){A.appendChild(document.createTextNode(B))},clear:function(C){var B=C.childNodes;for(var A=B.length-1;A>=0;A--){B[A].parentNode.removeChild(B[A])}},remove:function(A){if(A.parentNode){A.parentNode.removeChild(A)}},replaceNode:function(B,A){if(A.parentNode){A.parentNode.removeChild(A)}B.parentNode.insertBefore(A,B);B.parentNode.removeChild(B)},replaceHTML:function(B,A){B=hui.get(B);B.innerHTML=A},runScripts:function(node){var scripts=node.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){eval(scripts[i].innerHTML)}},setText:function(C,D){if(D==undefined||D==null){D=""}var E=C.childNodes;var A=false;for(var B=E.length-1;B>=0;B--){if(!A&&E[B].nodeType==hui.TEXT_NODE){E[B].nodeValue=D;A=true}else{C.removeChild(E[B])}}if(!A){hui.dom.addText(C,D)}},getText:function(C){var A="";var D=C.childNodes;for(var B=0;B<D.length;B++){if(D[B].nodeType==hui.TEXT_NODE&&D[B].nodeValue!=null){A+=D[B].nodeValue}else{if(D[B].nodeType==hui.ELEMENT_NODE){A+=hui.dom.getText(D[B])}}}return A},isVisible:function(A){while(A){if(A.style&&(hui.getStyle(A,"display")==="none"||hui.getStyle(A,"visibility")==="hidden")){return false}A=A.parentNode}return true},isDescendantOrSelf:function(A,B){while(A){if(A==B){return true}A=A.parentNode}return false}};hui.form={getValues:function(C){var D={};var A=C.getElementsByTagName("input");for(var B=0;B<A.length;B++){if(hui.isDefined(A[B].name)){D[A[B].name]=A[B].value}}return D}};hui.get=function(A){if(typeof (A)=="string"){return document.getElementById(A)}return A};hui.getChildren=function(D){var C=[];var A=D.childNodes;for(var B=0;B<A.length;B++){if(hui.dom.isElement(A[B])){C.push(A[B])}}return C};if(document.querySelector){hui.firstByClass=function(B,C,A){B=B||document.body;return B.querySelector((A?A+".":".")+C)}}else{hui.firstByClass=function(B,E,A){var D=(hui.get(B)||document.body).getElementsByTagName(A||"*");for(var C=0;C<D.length;C++){if(hui.hasClass(D[C],E)){return D[C]}}return null}}if(document.querySelectorAll){hui.byClass=function(D,F,A){D=D||document.body;var C=D.querySelectorAll((A?A+".":".")+F);var B=[];for(var E=0,G=C.length;E!=G;B.push(C[E++])){}return B}}else{hui.byClass=function(B,F,A){var E=(hui.get(B)||document.body).getElementsByTagName(A||"*"),C=[];for(var D=0;D<E.length;D++){if(hui.hasClass(E[D],F)){C[C.length]=E[D]}}return C}}hui.firstAncestorByClass=function(A,B){while(A){if(hui.hasClass(A,B)){return A}A=A.parentNode}return null};hui.byTag=function(E,C){var B=E.getElementsByTagName(C),A=[];for(var D=0,F=B.length;D!=F;A.push(B[D++])){}return A};hui.byId=function(D,E){var B=D.childNodes;for(var A=B.length-1;A>=0;A--){if(B[A].nodeType===hui.ELEMENT_NODE&&B[A].getAttribute("id")===E){return B[A]}else{var C=hui.byId(B[A],E);if(C){return C}}}return null};hui.firstParentByTag=function(C,A){var B=C;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null};hui.firstParentByClass=function(C,A){var B=C;while(B){if(hui.hasClass(B)){return B}B=B.parentNode}return null};hui.firstByTag=function(B,A){B=hui.get(B)||document.body;if(document.querySelector&&A!=="*"){return B.querySelector(A)}var C=B.getElementsByTagName(A);return C[0]};hui.build=function(A,B){var C=document.createElement(A);if(B){for(prop in B){if(prop=="text"){C.appendChild(document.createTextNode(B.text))}else{if(prop=="html"){C.innerHTML=B.html}else{if(prop=="parent"){B.parent.appendChild(C)}else{if(prop=="parentFirst"){if(B.parentFirst.childNodes.length==0){B.parentFirst.appendChild(C)}else{B.parentFirst.insertBefore(C,B.parentFirst.childNodes[0])}}else{if(prop=="className"){C.className=B.className}else{if(prop=="class"){C.className=B["class"]}else{if(prop=="style"&&(hui.browser.msie7||hui.browser.msie6)){C.style.setAttribute("cssText",B[prop])}else{if(hui.isDefined(B[prop])){C.setAttribute(prop,B[prop])}}}}}}}}}}return C};hui.getAncestors=function(A){var C=[];var B=A.parentNode;while(B){C[C.length]=B;B=B.parentNode}return C};hui.getNext=function(A){if(!A){return null}if(!A.nextSibling){return null}var B=A.nextSibling;while(B&&B.nodeType!=1){B=B.nextSibling}return B};hui.getAllNext=function(A){var C=[];var B=hui.getNext(A);while(B){C.push(B);B=hui.getNext(B)}return C};hui.getTop=function(A){A=hui.get(A);if(A){var B=A.offsetTop,C=A.offsetParent;while(C!=null){B+=C.offsetTop;C=C.offsetParent}return B}else{return 0}};hui.getScrollOffset=function(A){A=hui.get(A);var C=0,B=0;do{C+=A.scrollTop||0;B+=A.scrollLeft||0;A=A.parentNode}while(A);return{top:C,left:B}};hui.getLeft=function(A){A=hui.get(A);if(A){var B=A.offsetLeft,C=A.offsetParent;while(C!=null){B+=C.offsetLeft;C=C.offsetParent}return B}else{return 0}};hui.getPosition=function(A){return{left:hui.getLeft(A),top:hui.getTop(A)}};hui.window={getScrollTop:function(){if(window.pageYOffset){return window.pageYOffset}else{if(document.documentElement){return document.documentElement.scrollTop}}return document.body.scrollTop}};hui.scrollTo=function(D){var E=D.element;var G=hui.getPosition(E);var A=hui.window.getScrollTop();var B=hui.getViewPortHeight();var C=A+B;hui.log({pos:G,height:E.clientHeight,viewTop:A,viewBottom:C});if(A<G.top+E.clientHeight||(G.top)<C){var F=G.top-Math.round((B-E.clientHeight)/2);F=Math.max(0,F);hui.log(F);window.scrollTo(0,F)}};hui.hasClass=function(C,D){C=hui.get(C);if(!C||!C.className){return false}if(C.className==D){return true}var A=C.className.split(/\s+/);for(var B=0;B<A.length;B++){if(A[B]==D){return true}}return false};hui.addClass=function(A,B){A=hui.get(A);if(!A){return }hui.removeClass(A,B);A.className+=" "+B};hui.removeClass=function(D,E){D=hui.get(D);if(!D||!D.className){return }if(D.className=="className"){D.className="";return }var B="";var A=D.className.split(/\s+/);for(var C=0;C<A.length;C++){if(A[C]!=E){if(C>0){B+=" "}B+=A[C]}}D.className=B};hui.toggleClass=function(A,B){if(hui.hasClass(A,B)){hui.removeClass(A,B)}else{hui.addClass(A,B)}};hui.setClass=function(A,B,C){if(C){hui.addClass(A,B)}else{hui.removeClass(A,B)}};hui.fromJSON=function(A){return JSON.parse(A)};hui.toJSON=function(A){return JSON.stringify(A)};hui.listen=function(C,B,D,A){C=hui.get(C);if(document.addEventListener){C.addEventListener(B,D,A?true:false)}else{C.attachEvent("on"+B,D)}};hui.unListen=function(C,B,D,A){C=hui.get(C);if(document.removeEventListener){C.removeEventListener(B,D,A?true:false)}else{C.detachEvent("on"+B,D)}};hui.event=function(A){return new hui.Event(A)};hui.Event=function(A){this.event=A=A||window.event;this.element=A.target?A.target:A.srcElement;this.shiftKey=A.shiftKey;this.returnKey=A.keyCode==13;this.escapeKey=A.keyCode==27;this.spaceKey=A.keyCode==32;this.upKey=A.keyCode==38;this.downKey=A.keyCode==40;this.leftKey=A.keyCode==37;this.rightKey=A.keyCode==39;this.keyCode=A.keyCode};hui.Event.prototype={getLeft:function(){var A=0;if(this.event){if(this.event.pageX){A=this.event.pageX}else{if(this.event.clientX){A=this.event.clientX+hui.getScrollLeft()}}}return A},getTop:function(){var A=0;if(this.event){if(this.event.pageY){A=this.event.pageY}else{if(this.event.clientY){A=this.event.clientY+hui.getScrollTop()}}}return A},getElement:function(){return this.element},findByClass:function(A){return hui.firstAncestorByClass(this.element,A)},findByTag:function(A){var B=this.element;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null},stop:function(){hui.stop(this.event)}};hui.stop=function(A){if(!A){A=window.event}if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}A.cancelBubble=true;A.stopped=true};hui.onReady=function(A){if(window.addEventListener){window.addEventListener("DOMContentLoaded",A,false)}else{if(typeof document.addEventListener!="undefined"){document.addEventListener("load",A,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",A)}else{if(typeof window.onload=="function"){var B=window.onload;window.onload=function(){B();A()}}else{window.onload=A}}}}};hui.request=function(B){B=hui.override({method:"POST",async:true,headers:{Ajax:true}},B);var E=hui.request.createTransport();E.onreadystatechange=function(){try{if(E.readyState==4){if(E.status==200&&B.onSuccess){B.onSuccess(E)}else{if(E.status==403&&B.onForbidden){B.onForbidden(E)}else{if(E.status!==0&&B.onFailure){B.onFailure(E)}else{if(E.status==0&&B.onAbort){B.onAbort(E)}}}}}}catch(F){if(B.onException){B.onException(F,E)}else{throw F}}};var D=B.method.toUpperCase();E.open(D,B.url,B.async);var A=null;if(D=="POST"&&B.file){if(false){A=B.file;E.setRequestHeader("Content-type",B.file.type);E.setRequestHeader("X_FILE_NAME",B.file.name)}else{A=new FormData();A.append("file",B.file);if(B.parameters){for(param in B.parameters){A.append(param,B.parameters[param])}}}if(B.onProgress){E.upload.addEventListener("progress",function(F){B.onProgress(F.loaded,F.total)},false)}if(B.onLoad){E.upload.addEventListener("load",function(F){B.onLoad()},false)}}else{if(D=="POST"&&B.files){A=new FormData();for(var C=0;C<B.files.length;C++){A.append("file"+C,B.files[C])}}else{if(D=="POST"&&B.parameters){A=hui.request._buildPostBody(B.parameters);E.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")}else{A=""}}}if(B.headers){for(name in B.headers){E.setRequestHeader(name,B.headers[name])}}E.send(A);return E};hui.request.isXMLResponse=function(A){return A.responseXML&&A.responseXML.documentElement&&A.responseXML.documentElement.nodeName!="parsererror"};hui.request._buildPostBody=function(B){if(!B){return null}var A="";for(param in B){if(A.length>0){A+="&"}A+=encodeURIComponent(param)+"=";if(B[param]!==undefined&&B[param]!==null){A+=encodeURIComponent(B[param])}}return A};hui.request.createTransport=function(){try{if(window.XMLHttpRequest){var B=new XMLHttpRequest();if(B.readyState==null){B.readyState=1;B.addEventListener("load",function(){B.readyState=4;if(typeof B.onreadystatechange=="function"){B.onreadystatechange()}},false)}return B}else{if(window.ActiveXObject){return hui.request._getActiveX()}else{this.delegate.onError(this)}}}catch(A){if(this.delegate.onError){this.delegate.onError(this,A)}}};hui.request._getActiveX=function(){var C=["MSXML2","Microsoft","MSXML","MSXML3"];var D;for(var B=0;B<C.length;B++){try{D=new ActiveXObject(C[B]+".XmlHttp");return D}catch(A){}}throw new Error("Could not find an installed XML parser")};hui.getStyle=function(B,C){B=hui.get(B);var E=hui.string.camelize(C);var D=B.style[E];if(!D){if(document.defaultView&&document.defaultView.getComputedStyle){var A=document.defaultView.getComputedStyle(B,null);D=A?A.getPropertyValue(C):null}else{if(B.currentStyle){D=B.currentStyle[E]}}}if(window.opera&&["left","top","right","bottom"].include(C)){if(hui.getStyle(B,"position")=="static"){D="auto"}}return D=="auto"?"":D};hui.getTopPad=function(A){var B,C;B=parseInt(hui.getStyle(A,"padding"),10);C=parseInt(hui.getStyle(A,"padding-top"),10);if(B){return B}if(C){return C}return 0};hui.getBottomPad=function(B){var C,A;C=parseInt(hui.getStyle(B,"padding"),10);A=parseInt(hui.getStyle(B,"padding-bottom"),10);if(C){return C}if(A){return A}return 0};hui.setOpacity=function(B,A){if(!hui.browser.opacity){if(A==1){B.style["filter"]=null}else{B.style["filter"]="alpha(opacity="+(A*100)+")"}}else{B.style["opacity"]=A}};hui.setStyle=function(A,B){for(style in B){if(style==="opacity"){hui.setOpacity(A,B[style])}else{A.style[style]=B[style]}}};hui.copyStyle=function(E,F,D){for(var A=0;A<D.length;A++){var B=D[A];var C=hui.getStyle(E,B);if(C){F.style[B]=C}}};hui.getFrameDocument=function(A){if(A.contentDocument){return A.contentDocument}else{if(A.contentWindow){return A.contentWindow.document}else{if(A.document){return A.document}}}};hui.getFrameWindow=function(A){if(A.defaultView){return A.defaultView}else{if(A.contentWindow){return A.contentWindow}}};hui.selection={clear:function(){var A;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){A=window.getSelection();if(A&&A.removeAllRanges){A.removeAllRanges()}}}},getText:function(A){A=A||document;if(A.getSelection){return A.getSelection()+""}else{if(A.selection){return A.selection.createRange().text}}return""},getNode:function(B){B=B||document;if(B.getSelection){var A=B.getSelection().getRangeAt(0);return A.commonAncestorContainer()}return null},get:function(A){return{node:hui.selection.getNode(A),text:hui.selection.getText(A)}}};hui.effect={makeFlippable:function(A){if(hui.browser.webkit){hui.addClass(A.container,"hui_flip_container");hui.addClass(A.front,"hui_flip_front");hui.addClass(A.back,"hui_flip_back")}else{hui.addClass(A.front,"hui_flip_front_legacy");hui.addClass(A.back,"hui_flip_back_legacy")}},flip:function(B){if(!hui.browser.webkit){hui.toggleClass(B.element,"hui_flip_flipped_legacy")}else{var C=hui.get(B.element);var E=B.duration||"1s";var D=hui.firstByClass(C,"hui_flip_front");var A=hui.firstByClass(C,"hui_flip_back");D.style.webkitTransitionDuration=E;A.style.webkitTransitionDuration=E;hui.toggleClass(B.element,"hui_flip_flipped")}}};hui.getScrollTop=function(){if(self.pageYOffset){return self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}};hui.getScrollLeft=function(){if(self.pageYOffset){return self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}};hui.getViewPortHeight=function(){if(window.innerHeight){return window.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight}else{if(document.body){return document.body.clientHeight}}}};hui.getViewPortWidth=function(){if(window.innerWidth){return window.innerWidth}else{if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}else{if(document.body){return document.body.clientWidth}}}};hui.getDocumentWidth=function(){return Math.max(document.body.clientWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth);return document.body.scrollWidth};hui.getDocumentHeight=function(){if(hui.browser.msie6){var A=Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight);var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(hui.dom.isElement(C[B])){A=Math.max(A,C[B].clientHeight)}}return A}if(window.scrollMaxY&&window.innerHeight){return window.scrollMaxY+window.innerHeight}else{return Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight)}};hui.place=function(C){var F=0,E=0,A=C.target.element,D={left:hui.getLeft(A),top:hui.getTop(A)};F=D.left+A.clientWidth*(C.target.horizontal||0);E=D.top+A.clientHeight*(C.target.vertical||0);var G=C.source.element;F-=G.clientWidth*(C.source.horizontal||0);E-=G.clientHeight*(C.source.vertical||0);if(C.insideViewPort){var B=hui.getViewPortWidth();if(F+G.clientWidth>B){F=B-G.clientWidth-(C.viewPartMargin||0);hui.log(C.viewPartMargin)}if(F<0){F=0}if(E<0){E=0}}if(C.top){E+=C.top}if(C.left){F+=C.left}G.style.top=E+"px";G.style.left=F+"px"};hui.drag={register:function(A){hui.listen(A.element,"mousedown",function(B){hui.stop(B);hui.drag.start(A)})},start:function(B){var D=hui.browser.msie?document:window;B.onStart();var A,C;A=function(E){E=hui.event(E);B.onMove(E)}.bind(this);hui.listen(D,"mousemove",A);C=function(){hui.unListen(D,"mousemove",A);hui.unListen(D,"mouseup",C);B.onEnd()}.bind(this);hui.listen(D,"mouseup",C)},_nativeListeners:[],_activeDrop:null,listen:function(A){if(hui.browser.msie){return }hui.drag._nativeListeners.push(A);if(hui.drag._nativeListeners.length>1){return }hui.listen(document.body,"dragenter",function(F){var B=hui.drag._nativeListeners;var E=null;for(var D=0;D<B.length;D++){var C=B[D].element;if(hui.dom.isDescendantOrSelf(F.target,C)){E=B[D];if(hui.drag._activeDrop==null||hui.drag._activeDrop!=E){hui.addClass(C,E.hoverClass)}break}}if(hui.drag._activeDrop){if(hui.drag._activeDrop!=E){hui.removeClass(hui.drag._activeDrop.element,hui.drag._activeDrop.hoverClass)}}hui.drag._activeDrop=E});hui.listen(document.body,"dragover",function(B){hui.stop(B)});hui.listen(document.body,"drop",function(C){hui.stop(C);var B=hui.drag._activeDrop;hui.drag._activeDrop=null;if(B){hui.removeClass(B.element,B.hoverClass);if(B.onDrop){B.onDrop(C)}hui.log(C.dataTransfer.types);if(B.onFiles&&C.dataTransfer&&C.dataTransfer.files&&C.dataTransfer.files.length>0){B.onFiles(C.dataTransfer.files)}}})}};hui.Preloader=function(A){this.options=A||{};this.delegate={};this.images=[];this.loaded=0};hui.Preloader.prototype={addImages:function(A){if(typeof (A)=="object"){for(var B=0;B<A.length;B++){this.images.push(A[B])}}else{this.images.push(A)}},setDelegate:function(A){this.delegate=A},load:function(E){E=E||0;var B=this;this.obs=[];for(var D=E;D<this.images.length+E;D++){var C=D;if(C>=this.images.length){C=C-this.images.length}var A=new Image();A.huiPreloaderIndex=C;A.onload=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidLoad")};A.onerror=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidGiveError")};A.onabort=function(){B._imageChanged(this.huiPreloaderIndex,"imageDidAbort")};A.src=(this.options.context?this.options.context:"")+this.images[C];this.obs.push(A)}},_imageChanged:function(A,B){this.loaded++;if(this.delegate[B]){this.delegate[B](this.loaded,this.images.length,A)}if(this.loaded==this.images.length&&this.delegate.allImagesDidLoad){this.delegate.allImagesDidLoad()}}};hui.cookie={set:function(C,D,E){var A;if(E){var B=new Date();B.setTime(B.getTime()+(E*24*60*60*1000));A="; expires="+B.toGMTString()}else{A=""}document.cookie=C+"="+D+A+"; path=/"},get:function(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)==0){return E.substring(D.length,E.length)}}return null},clear:function(A){this.set(A,"",-1)}};hui.location={getParameter:function(A){var C=hui.location.getParameters();for(var B=0;B<C.length;B++){if(C[B].name==A){return C[B].value}}return null},setParameter:function(A,E){var C=hui.location.getParameters();var D=false;for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=E;D=true;break}}if(!D){C.push({name:A,value:E})}hui.location.setParameters(C)},hasHash:function(A){var B=document.location.hash;if(B!==""){return B=="#"+A}return false},getHashParameter:function(A){var D=document.location.hash;if(D!==""){var B=D.indexOf(A+"=");if(B!==-1){var C=D.substring(B+A.length+1);if(C.indexOf("&")!==-1){return C.substring(0,C.indexOf("&"))}return C}}return null},clearHash:function(){document.location.hash="#"},setParameters:function(B){var C="";for(var A=0;A<B.length;A++){C+=A==0?"?":"&";C+=B[A].name+"="+B[A].value}document.location.search=C},getBoolean:function(A){var B=hui.location.getParameter(A);return(B=="true"||B=="1")},getInt:function(A){var B=parseInt(hui.location.getParameter(A));if(B!==NaN){return B}return null},getParameters:function(){var B=document.location.search.substring(1).split("&");var A=[];for(var D=0;D<B.length;D++){var E=B[D].split("=");var C=unescape(E[0]).replace(/^\s*|\s*$/g,"");var F=unescape(E[1]).replace(/^\s*|\s*$/g,"");if(C){A.push({name:C,value:F})}}return A}};hui.animate=function(A,C,E,F,B){if(typeof (A)=="string"||hui.dom.isElement(A)){hui.animation.get(A).animate(null,E,C,F,B)}else{var D=hui.animation.get(A.node);for(prop in A.css){D.animate(null,A.css[prop],prop,A.duration,A)}}};hui.animation={objects:{},running:false,latestId:0,get:function(A){A=hui.get(A);if(!A.n2iAnimationId){A.n2iAnimationId=this.latestId++}if(!this.objects[A.n2iAnimationId]){this.objects[A.n2iAnimationId]=new hui.animation.Item(A)}return this.objects[A.n2iAnimationId]},start:function(){if(!this.running){hui.animation._render()}}};hui.animation._lengthUpater=function(C,B,A){C.style[A.property]=(A.from+(A.to-A.from)*B)+(A.unit!=null?A.unit:"")};hui.animation._transformUpater=function(D,B,A){var C=A.transform;var E="";if(C.rotate){E+=" rotate("+(C.rotate.from+(C.rotate.to-C.rotate.from)*B)+C.rotate.unit+")"}if(C.scale){E+=" scale("+(C.scale.from+(C.scale.to-C.scale.from)*B)+")"}D.style[hui.animation.TRANSFORM]=E};hui.animation._colorUpater=function(D,C,B){var F=Math.round(B.from.red+(B.to.red-B.from.red)*C);var E=Math.round(B.from.green+(B.to.green-B.from.green)*C);var A=Math.round(B.from.blue+(B.to.blue-B.from.blue)*C);value="rgb("+F+","+E+","+A+")";D.style[B.property]=value};hui.animation._propertyUpater=function(C,B,A){C[A.property]=Math.round(A.from+(A.to-A.from)*B)};hui.animation._ieOpacityUpdater=function(D,B,A){var C=(A.from+(A.to-A.from)*B);if(C==1){D.style.removeAttribute("filter")}else{D.style["filter"]="alpha(opacity="+(C*100)+")"}};hui.animation._render=function(){hui.animation.running=true;var G=false,A=new Date().getTime();for(var B in hui.animation.objects){var D=hui.animation.objects[B];if(D.work){var E=D.element;for(var F=0;F<D.work.length;F++){var H=D.work[F];if(H.finished){continue}var C=(A-H.start)/(H.end-H.start);if(C<0){G=true;continue}else{if(isNaN(C)||C>1){C=1}else{if(C<1){G=true}}}var J=C,I=null;if(H.delegate&&H.delegate.ease){J=H.delegate.ease(J)}if(H.delegate&&H.delegate.callback){H.delegate.callback(E,J)}else{if(H.updater){H.updater(E,J,H)}}if(C==1){H.finished=true;if(H.delegate&&H.delegate.onComplete){window.setTimeout(H.delegate.onComplete)}else{if(H.delegate&&H.delegate.hideOnComplete){E.style.display="none"}}}}}}if(G){window.setTimeout(hui.animation._render,0)}else{hui.animation.running=false}};hui.animation._parseStyle=function(D){var B={type:null,value:null,unit:null};var C;if(!hui.isDefined(D)){return B}else{if(!isNaN(D)){B.value=parseFloat(D)}else{if(C=D.match(/([\-]?[0-9\.]+)(px|pt|%)/)){B.type="length";B.value=parseFloat(C[1]);B.unit=C[2]}else{if(C=D.match(/rgb\(([0-9]+),[ ]?([0-9]+),[ ]?([0-9]+)\)/)){B.type="color";B.value={red:parseInt(C[1]),green:parseInt(C[2]),blue:parseInt(C[3])}}else{var A=new hui.Color(D);if(A.ok){B.value={red:A.r,green:A.g,blue:A.b}}}}}}return B};hui.animation.Item=function(A){this.element=A;this.work=[]};hui.animation.Item.prototype.animate=function(H,I,J,B,F){var G=this.getWork(hui.string.camelize(J));G.delegate=F;G.finished=false;var D=!(J=="scrollLeft"||J=="scrollTop");if(H!==null){G.from=H}else{if(J=="transform"){G.transform=hui.animation.Item.parseTransform(I,this.element)}else{if(!hui.browser.opacity&&J=="opacity"){G.from=this._getIEOpacity(this.element)}else{if(D){var A=hui.getStyle(this.element,J);var C=hui.animation._parseStyle(A);G.from=C.value}else{G.from=this.element[J]}}}}if(D){var E=hui.animation._parseStyle(I);G.to=E.value;G.unit=E.unit;if(!hui.browser.opacity&&J=="opacity"){G.updater=hui.animation._ieOpacityUpdater}else{if(J=="transform"){G.updater=hui.browser.msie?function(){}:hui.animation._transformUpater}else{if(E.value.red===undefined){G.updater=hui.animation._lengthUpater}else{G.updater=hui.animation._colorUpater}}}}else{G.to=I;G.unit=null;G.updater=hui.animation._propertyUpater}G.start=new Date().getTime();if(F&&F.delay){G.start+=F.delay}G.end=G.start+B;hui.animation.start()};hui.animation.TRANSFORM=hui.browser.gecko?"MozTransform":"WebkitTransform";hui.animation.Item.parseTransform=function(G,D){var I={};var F,E;var H=/rotate\(([0-9\.]+)([a-z]+)\)/i;var C=G.match(H);if(C){F=0;if(D.style[hui.animation.TRANSFORM]){E=D.style[hui.animation.TRANSFORM].match(H);if(E){F=parseFloat(E[1])}}I.rotate={from:F,to:parseFloat(C[1]),unit:C[2]}}var A=/scale\(([0-9\.]+)\)/i;var B=G.match(A);if(B){F=1;if(D.style[hui.animation.TRANSFORM]){E=D.style[hui.animation.TRANSFORM].match(A);if(E){F=parseFloat(E[1])}}I.scale={from:F,to:parseFloat(B[1])}}return I};hui.animation.Item.prototype._getIEOpacity=function(B){var C=hui.getStyle(B,"filter").toLowerCase();var A;if(A=C.match(/opacity=([0-9]+)/)){return parseFloat(A[1])/100}else{return 1}};hui.animation.Item.prototype.getWork=function(C){for(var B=this.work.length-1;B>=0;B--){if(this.work[B].property===C){return this.work[B]}}var A={property:C};this.work[this.work.length]=A;return A};hui.animation.Loop=function(A){this.recipe=A;this.position=-1;this.running=false};hui.animation.Loop.prototype.next=function(){this.position++;if(this.position>=this.recipe.length){this.position=0}var B=this.recipe[this.position];if(typeof (B)=="function"){B()}else{if(B.element){hui.animate(B.element,B.property,B.value,B.duration,{ease:B.ease})}}var A=this;var C=B.duration||0;if(B.wait!==undefined){C=B.wait}window.setTimeout(function(){A.next()},C)};hui.animation.Loop.prototype.start=function(){this.running=true;this.next()};hui.Color=function(F){this.ok=false;if(hui.isBlank(F)){return }if(F.charAt(0)=="#"){F=F.substr(1,6)}F=F.replace(/ /g,"");F=F.toLowerCase();for(var B in hui.Color.table){if(F==B){F=hui.Color.table[B]}}var G=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(H){return[parseInt(H[1]),parseInt(H[2]),parseInt(H[3])]}},{re:/^rgb\((\d{1,3})%,\s*(\d{1,3})%,\s*(\d{1,3})%\)$/,process:function(H){return[Math.round(parseInt(H[1])/100*255),Math.round(parseInt(H[2])/100*255),Math.round(parseInt(H[3])/100*255)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(H){return[parseInt(H[1],16),parseInt(H[2],16),parseInt(H[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(H){return[parseInt(H[1]+H[1],16),parseInt(H[2]+H[2],16),parseInt(H[3]+H[3],16)]}}];for(var A=0;A<G.length;A++){var D=G[A].re,C=G[A].process,E=D.exec(F);if(E){channels=C(E);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true;break}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b)};hui.Color.prototype={toRGB:function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},toHex:function(){var C=this.r.toString(16);var B=this.g.toString(16);var A=this.b.toString(16);if(C.length==1){C="0"+C}if(B.length==1){B="0"+B}if(A.length==1){A="0"+A}return"#"+C+B+A}};hui.Color.table={white:"ffffff",black:"000000",red:"ff0000",green:"00ff00",blue:"0000ff"};hui.Color.hex2rgb=function(D){if(hui.isBlank(D)){return null}if(D[0]=="#"){D=D.substr(1)}if(D.length==3){var A=D;D="";A=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(A).slice(1);for(var C=0;C<3;C++){D+=A[C]+A[C]}}var B=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(D).slice(1);return{r:parseInt(B[0],16),g:parseInt(B[1],16),b:parseInt(B[2],16)}};hui.Color.hsv2rgb=function(F,I,E){var N=F/360,K,P,C;if(I==0){K=E*255;P=E*255;C=E*255}else{var L=N*6,D,M,O;var J=Math.floor(L);var A=E*(1-I);var T=E*(1-I*(L-J));var Q=E*(1-I*(1-(L-J)));if(J==0){D=E;M=Q;O=A}else{if(J==1){D=T;M=E;O=A}else{if(J==2){D=A;M=E;O=Q}else{if(J==3){D=A;M=T;O=E}else{if(J==4){D=Q;M=A;O=E}else{D=E;M=A;O=T}}}}}K=Math.round(D*255);P=Math.round(M*255);C=Math.round(O*255)}return new Array(K,P,C)};hui.Color.rgb2hsv=function(G,F,B){G=(G/255);F=(F/255);B=(B/255);var D=Math.min(Math.min(G,F),B),A=Math.max(Math.max(G,F),B),H=A,E,C;if(A==D){C=0}else{if(A==G){C=(60*((F-B)/(A-D)))%360}else{if(A==F){C=60*((B-G)/(A-D))+120}else{if(A==B){C=60*((G-F)/(A-D))+240}}}}if(C<0){C+=360}if(A==0){E=0}else{E=1-(D/A)}return[Math.round(C),Math.round(E*100),Math.round(H*100)]};hui.Color.rgb2hex=function(B){var D="#";for(var A=0;A<3;A++){var C=parseInt(B[A]).toString(16);if(C.length<2){C="0"+C}D+=C}return D};hui.ease={slowFastSlow:function(C){var B=1.6;var A=1.4;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},fastSlow:function(C){var B=0.5;var A=0.7;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},elastic:function(A){return 1-hui.ease.elastic2(1-A)},elastic2:function(B,A,D){if(B<=0||B>=1){return B}if(!D){D=0.45}var C;if(!A||A<1){A=1;C=D/4}else{C=D/(2*Math.PI)*Math.asin(1/A)}return -(A*Math.pow(2,10*(B-=1))*Math.sin((B-C)*(2*Math.PI)/D))},bounce:function(A){if(A<(1/2.75)){return 7.5625*A*A}else{if(A<(2/2.75)){return(7.5625*(A-=(1.5/2.75))*A+0.75)}else{if(A<(2.5/2.75)){return(7.5625*(A-=(2.25/2.75))*A+0.9375)}else{return(7.5625*(A-=(2.625/2.75))*A+0.984375)}}}},flicker:function(A){if(A==1){return 1}return Math.random()*A},linear:function(A){return A},quadIn:function(A){return Math.pow(A,2)},quadOut:function(A){return A*(A-2)*-1},quadInOut:function(A){A=A*2;if(A<1){return Math.pow(A,2)/2}return -1*((--A)*(A-2)-1)/2},cubicIn:function(A){return Math.pow(A,3)},cubicOut:function(A){return Math.pow(A-1,3)+1},cubicInOut:function(A){A=A*2;if(A<1){return Math.pow(A,3)/2}A-=2;return(Math.pow(A,3)+2)/2},quartIn:function(A){return Math.pow(A,4)},quartOut:function(A){return -1*(Math.pow(A-1,4)-1)},quartInOut:function(A){A=A*2;if(A<1){return Math.pow(A,4)/2}A-=2;return -1/2*(Math.pow(A,4)-2)},quintIn:function(A){return Math.pow(A,5)},quintOut:function(A){return Math.pow(A-1,5)+1},quintInOut:function(A){A=A*2;if(A<1){return Math.pow(A,5)/2}A-=2;return(Math.pow(A,5)+2)/2},sineIn:function(A){return -1*Math.cos(A*(Math.PI/2))+1},sineOut:function(A){return Math.sin(A*(Math.PI/2))},sineInOut:function(A){return -1*(Math.cos(Math.PI*A)-1)/2},expoIn:function(A){return(A==0)?0:Math.pow(2,10*(A-1))},expoOut:function(A){return(A==1)?1:(-1*Math.pow(2,-10*A)+1)},expoInOut:function(A){if(A==0){return 0}if(A==1){return 1}A=A*2;if(A<1){return Math.pow(2,10*(A-1))/2}--A;return(-1*Math.pow(2,-10*A)+2)/2},circIn:function(A){return -1*(Math.sqrt(1-Math.pow(A,2))-1)},circOut:function(A){A=A-1;return Math.sqrt(1-Math.pow(A,2))},circInOut:function(A){A=A*2;if(A<1){return -1/2*(Math.sqrt(1-Math.pow(A,2))-1)}A-=2;return 1/2*(Math.sqrt(1-Math.pow(A,2))+1)},backIn:function(B){var A=1.70158;return Math.pow(B,2)*((A+1)*B-A)},backOut:function(B){B=B-1;var A=1.70158;return Math.pow(B,2)*((A+1)*B+A)+1},backInOut:function(B){var A=1.70158*1.525;B=B*2;if(B<1){return(Math.pow(B,2)*((A+1)*B-A))/2}B-=2;return(Math.pow(B,2)*((A+1)*B+A)+2)/2},elasticIn:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;C=C-1;return -1*Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B)},elasticOut:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;return Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B)+1},elasticInOut:function(C){if(C==0){return 0}C=C*2;if(C==2){return 1}var B=0.3*1.5;var A=B/4;if(C<1){C-=1;return -0.5*(Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B))}C-=1;return 0.5*(Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B))+1},bounceIn:function(A){return(1-hui.ease.bounceOut(1-A))},bounceOut:function(D){var B=7.5625;var C=2.75;var A;if(D<(1/C)){A=B*Math.pow(D,2)}else{if(D<(2/C)){D-=(1.5/C);A=B*Math.pow(D,2)+0.75}else{if(D<(2.5/C)){D-=(2.25/C);A=B*Math.pow(D,2)+0.9375}else{D-=(2.625/C);A=B*Math.pow(D,2)+0.984375}}}return A},bounceInOut:function(A){if(A<0.5){return hui.ease.bounceIn(A*2)/2}return(hui.ease.bounceOut(A*2-1)/2)+0.5}};if(!Function.prototype.bind){Function.prototype.bind=function(){if(arguments.length<2&&arguments[0]===undefined){return this}var C=this,A=Array.prototype.slice.call(arguments),B=A.shift();return function(){return C.apply(B,A.concat(Array.prototype.slice.call(arguments)))}};Function.bind=function(){var A=Array.prototype.slice.call(arguments);return Function.prototype.bind.apply(A.shift(),A)}}if(!Function.prototype.argumentNames){Function.prototype.argumentNames=function(){var A=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return A.length==1&&!A[0]?[]:A}}!function(F,T,J){var G=T.getElementsByTagName("head")[0],R={},P={},S={},D={},M="string",Q=false,H="push",K="DOMContentLoaded",B="readyState",O="addEventListener",N="onreadystatechange",U=function(V,Y){for(var X=0,W=V.length;X<W;++X){if(!Y(V[X])){return Q}}return 1};function E(V,W){U(V,function(X){return !W(X)})}if(!T[B]&&T[O]){T[O](K,function I(){T.removeEventListener(K,I,Q);T[B]="complete"},Q);T[B]="loading"}var C=function(d,Z,X){d=d[H]?d:[d];var W=Z&&Z.call,Y=W?Z:X,V=W?d.join(""):Z,a=d.length;function b(e){return e.call?e():R[e]}function c(){if(!--a){R[V]=1;Y&&Y();for(var e in S){U(e.split("|"),b)&&!E(S[e],b)&&(S[e]=[])}}}J(function(){E(d,function(e){if(D[e]){V&&(P[V]=1);c();return }D[e]=1;V&&(P[V]=1);L(C.path?C.path+e+".js":e,c)})},0);return C};function L(Y,X){var W=T.createElement("script"),V=Q;W.onload=W.onerror=W[N]=function(){if((W[B]&&!(/^c|loade/.test(W[B])))||V){return }W.onload=W[N]=null;V=1;X()};W.async=1;W.src=Y;G.insertBefore(W,G.firstChild)}C.get=L;C.ready=function(Y,W,X){Y=Y[H]?Y:[Y];var V=[];!E(Y,function(Z){R[Z]||V[H](Z)})&&U(Y,function(Z){return R[Z]})?W():!function(Z){S[Z]=S[Z]||[];S[Z][H](W);X&&X(V)}(Y.join("|"));return C};var A=F.$script;C.noConflict=function(){F.$script=A;return this};(typeof module!=="undefined"&&module.exports)?(module.exports=C):(F.hui.require=C)}(this,document,setTimeout);var SWFUpload=function(A){this.initSWFUpload(A)};SWFUpload.prototype.initSWFUpload=function(B){try{this.customSettings={};this.settings=B;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(A){delete SWFUpload.instances[this.movieName];throw A}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 Alpha";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(B,A){this.settings[B]=(this.settings[B]==undefined)?A:this.settings[B]};this.ensureDefault("upload_url","");this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id",null);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",function(A){hui.log(A)});this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+"?swfuploadrnd="+Math.floor(Math.random()*999999999)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){if(this.settings.button_placeholder_id!==""){this.replaceWithFlash()}else{this.appendFlash()}};SWFUpload.prototype.appendFlash=function(){var B,A;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}B=document.getElementsByTagName("body")[0];if(B==undefined){throw"Could not find the 'body' element."}A=document.createElement("div");A.style.width="1px";A.style.height="1px";A.style.overflow="hidden";B.appendChild(A);A.innerHTML=this.getFlashHTML()};SWFUpload.prototype.replaceWithFlash=function(){var A,B;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}A=this.settings.button_placeholder||document.getElementById(this.settings.button_placeholder_id);if(A==undefined){throw"Could not find the placeholder element."}B=document.createElement("div");B.innerHTML=this.getFlashHTML();A.parentNode.replaceChild(B.firstChild,A)};SWFUpload.prototype.getFlashHTML=function(){var A=this.settings.button_image_url===""?true:false;return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',A?"transparent":"window",'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var A=this.buildParamString();return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;params=",encodeURIComponent(A),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var C=this.settings.post_params;var B=[];if(typeof (C)==="object"){for(var A in C){if(C.hasOwnProperty(A)){B.push(encodeURIComponent(A.toString())+"="+encodeURIComponent(C[A].toString()))}}}return B.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.stopUpload();var B=null;try{B=this.getMovieElement()}catch(C){}if(B!=undefined&&B.parentNode!=undefined&&typeof B.parentNode.removeChild==="function"){var A=B.parentNode;if(A!=undefined){A.removeChild(B);if(A.parentNode!=undefined&&typeof A.parentNode.removeChild==="function"){A.parentNode.removeChild(A)}}}SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];delete this.movieElement;delete this.settings;delete this.customSettings;delete this.eventQueue;delete this.movieName;delete window[this.movieName];return true}catch(D){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(B,C,A){if(C==undefined){return(this.settings[B]=A)}else{return(this.settings[B]=C)}};SWFUpload.prototype.getSetting=function(A){if(this.settings[A]!=undefined){return this.settings[A]}return""};SWFUpload.prototype.callFlash=function(C,D){D=D||[];var A=this.getMovieElement();var B;if(typeof A[C]==="function"){if(D.length===0){B=A[C]()}else{if(D.length===1){B=A[C](D[0])}else{if(D.length===2){B=A[C](D[0],D[1])}else{if(D.length===3){B=A[C](D[0],D[1],D[2])}else{throw"Too many arguments"}}}}if(B!=undefined&&typeof B.post==="object"){B=this.unescapeFilePostParams(B)}return B}else{throw"Invalid function name: "+C}};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(A){this.callFlash("StartUpload",[A])};SWFUpload.prototype.cancelUpload=function(A){this.callFlash("CancelUpload",[A])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(A){this.callFlash("SetStats",[A])};SWFUpload.prototype.getFile=function(A){if(typeof (A)==="number"){return this.callFlash("GetFileByIndex",[A])}else{return this.callFlash("GetFile",[A])}};SWFUpload.prototype.addFileParam=function(A,B,C){return this.callFlash("AddFileParam",[A,B,C])};SWFUpload.prototype.removeFileParam=function(A,B){this.callFlash("RemoveFileParam",[A,B])};SWFUpload.prototype.setUploadURL=function(A){this.settings.upload_url=A.toString();this.callFlash("SetUploadURL",[A])};SWFUpload.prototype.setPostParams=function(A){this.settings.post_params=A;this.callFlash("SetPostParams",[A])};SWFUpload.prototype.addPostParam=function(A,B){this.settings.post_params[A]=B;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(A){delete this.settings.post_params[A];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(A,B){this.settings.file_types=A;this.settings.file_types_description=B;this.callFlash("SetFileTypes",[A,B])};SWFUpload.prototype.setFileSizeLimit=function(A){this.settings.file_size_limit=A;this.callFlash("SetFileSizeLimit",[A])};SWFUpload.prototype.setFileUploadLimit=function(A){this.settings.file_upload_limit=A;this.callFlash("SetFileUploadLimit",[A])};SWFUpload.prototype.setFileQueueLimit=function(A){this.settings.file_queue_limit=A;this.callFlash("SetFileQueueLimit",[A])};SWFUpload.prototype.setFilePostName=function(A){this.settings.file_post_name=A;this.callFlash("SetFilePostName",[A])};SWFUpload.prototype.setUseQueryString=function(A){this.settings.use_query_string=A;this.callFlash("SetUseQueryString",[A])};SWFUpload.prototype.setRequeueOnError=function(A){this.settings.requeue_on_error=A;this.callFlash("SetRequeueOnError",[A])};SWFUpload.prototype.setDebugEnabled=function(A){this.settings.debug_enabled=A;this.callFlash("SetDebugEnabled",[A])};SWFUpload.prototype.setButtonImageURL=function(A){if(A==undefined){A=""}this.settings.button_image_url=A;this.callFlash("SetButtonImageURL",[A])};SWFUpload.prototype.setButtonDimensions=function(C,A){this.settings.button_width=C;this.settings.button_height=A;var B=this.getMovieElement();if(B!=undefined){B.style.width=C+"px";B.style.height=A+"px"}this.callFlash("SetButtonDimensions",[C,A])};SWFUpload.prototype.setButtonText=function(A){this.settings.button_text=A;this.callFlash("SetButtonText",[A])};SWFUpload.prototype.setButtonTextPadding=function(B,A){this.settings.button_text_top_padding=A;this.settings.button_text_left_padding=B;this.callFlash("SetButtonTextPadding",[B,A])};SWFUpload.prototype.setButtonTextStyle=function(A){this.settings.button_text_style=A;this.callFlash("SetButtonTextStyle",[A])};SWFUpload.prototype.setButtonDisabled=function(A){this.settings.button_disabled=A;this.callFlash("SetButtonDisabled",[A])};SWFUpload.prototype.setButtonAction=function(A){this.settings.button_action=A;this.callFlash("SetButtonAction",[A])};SWFUpload.prototype.queueEvent=function(B,C){if(C==undefined){C=[]}else{if(!(C instanceof Array)){C=[C]}}var A=this;if(typeof this.settings[B]==="function"){this.eventQueue.push(function(){this.settings[B].apply(this,C)});setTimeout(function(){A.executeNextEvent()},0)}else{if(this.settings[B]!==null){throw"Event handler "+B+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var A=this.eventQueue?this.eventQueue.shift():null;if(typeof (A)==="function"){A.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(C){var E=/[$]([0-9a-f]{4})/i;var F={};var D;if(C!=undefined){for(var A in C.post){if(C.post.hasOwnProperty(A)){D=A;var B;while((B=E.exec(D))!==null){D=D.replace(B[0],String.fromCharCode(parseInt("0x"+B[1],16)))}F[D]=C.post[A]}}C.post=F}return C};SWFUpload.prototype.flashReady=function(){var A=this.getMovieElement();if(typeof A.StartUpload!=="function"){throw"ExternalInterface methods failed to initialize."}if(window[this.movieName]==undefined){window[this.movieName]=A}this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("file_queued_handler",A)};SWFUpload.prototype.fileQueueError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("file_queue_error_handler",[A,C,B])};SWFUpload.prototype.fileDialogComplete=function(A,B){this.queueEvent("file_dialog_complete_handler",[A,B])};SWFUpload.prototype.uploadStart=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("return_upload_start_handler",A)};SWFUpload.prototype.returnUploadStart=function(A){var B;if(typeof this.settings.upload_start_handler==="function"){A=this.unescapeFilePostParams(A);B=this.settings.upload_start_handler.call(this,A)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(B===undefined){B=true}B=!!B;this.callFlash("ReturnUploadStart",[B])};SWFUpload.prototype.uploadProgress=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_progress_handler",[A,C,B])};SWFUpload.prototype.uploadError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_error_handler",[A,C,B])};SWFUpload.prototype.uploadSuccess=function(B,A){B=this.unescapeFilePostParams(B);this.queueEvent("upload_success_handler",[B,A])};SWFUpload.prototype.uploadComplete=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("upload_complete_handler",A)};SWFUpload.prototype.debug=function(A){hui.log(A)};if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}Date.parseFunctions={count:0};Date.parseRegexes=[];Date.formatFunctions={count:0};Date.prototype.dateFormat=function(B){if(Date.formatFunctions[B]==null){Date.createNewFormat(B)}var A=Date.formatFunctions[B];return this[A]()};Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code="Date.prototype."+funcName+" = function(){return ";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;code+="'"+Date.escape(ch)+"' + "}else{code+=Date.getFormatCode(ch)}}}eval(code.substring(0,code.length-3)+";}")};Date.getFormatCode=function(A){switch(A){case"d":return"Date.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"Date.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"Date.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"Date.leftPad(this.getHours(), 2, '0') + ";case"i":return"Date.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"Date.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+Date.escape(A)+"' + "}};Date.parseDate=function(A,C){if(Date.parseFunctions[C]==null){Date.createParser(C)}var B=Date.parseFunctions[C];return Date[B](A)};Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;var currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input){\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {";var regex="";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;regex+=Date.escape(ch)}else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c){code+=obj.c}}}}code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}";Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$");eval(code)};Date.formatCodeToRegex=function(B,A){switch(B){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+A+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+A+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+A+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+A+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+A+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:Date.escape(B)}}};Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")};Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+Date.leftPad(Math.floor(this.getTimezoneOffset()/60),2,"0")+Date.leftPad(this.getTimezoneOffset()%60,2,"0")};Date.prototype.getDayOfYear=function(){var A=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var B=0;B<this.getMonth();++B){A+=Date.daysInMonth[B]}return A+this.getDate()-1};Date.prototype.getWeekOfYear=function(){var B=this.getDayOfYear()+(5-this.getDay());var A=new Date(this.getFullYear(),0,1);var C=(5-A.getDay());return parseInt(Date.leftPad(((B-C)/7)+1,2,"0"))};Date.prototype.isLeapYear=function(){var A=this.getFullYear();return((A&3)==0&&(A%100||(A%400==0&&A)))};Date.prototype.getFirstDayOfMonth=function(){var A=(this.getDay()-(this.getDate()-1))%7;return(A<0)?(A+7):A};Date.prototype.getLastDayOfMonth=function(){var A=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return(A<0)?(A+7):A};Date.prototype.getDaysInMonth=function(){Date.daysInMonth[1]=this.isLeapYear()?29:28;return Date.daysInMonth[this.getMonth()]};Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};Date.escape=function(A){return A.replace(/('|\\)/g,"\\$1")};Date.leftPad=function(D,B,C){var A=new String(D);if(C==null){C=" "}while(A.length<B){A=C+A}return A};Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"};hui.ui={domReady:false,context:"",language:"en",layoutWidgets:[],objects:[],delegates:[],state:"default",latestObjectIndex:0,latestIndex:500,latestPanelIndex:1000,latestAlertIndex:1500,latestTopIndex:2000,toolTips:{},confirmOverlays:{},delayedUntilReady:[],texts:{request_error:{en:"An error occurred on the server",da:"Der skete en fejl p serveren"},"continue":{en:"Continue",da:"Fortst"},reload_page:{en:"Reload page",da:"Inds siden igen"},access_denied:{en:"Access denied, maybe you are nolonger logged in",da:"Adgang ngtet, du er mske ikke lngere logget ind"}}};hui.onReady(function(){if(window.dwr&&window.dwr.engine&&window.dwr.engine.setErrorHandler){window.dwr.engine.setErrorHandler(function(C,B){hui.log(C);hui.log(B)})}hui.ui.callSuperDelegates(this,"ready");hui.listen(window,"resize",hui.ui._resize);hui.ui._resize();hui.ui.domReady=true;if(window.parent&&window.parent.hui&&window.parent.hui.ui){window.parent.hui.ui._frameLoaded(window)}for(var A=0;A<hui.ui.delayedUntilReady.length;A++){hui.ui.delayedUntilReady[A]()}});hui.ui.get=function(A){if(A){if(A.element){return A}return hui.ui.objects[A]}return null};hui.ui.getText=function(B){var A=this.texts[B];if(!A){return B}if(A[this.language]){return A[this.language]}else{return A["en"]}};hui.ui.onReady=function(A){if(hui.ui.domReady){return A()}if(hui.browser.gecko&&hui.string.endsWith(document.baseURI,"xml")){window.setTimeout(A,1000);return }hui.ui.delayedUntilReady.push(A)};hui.ui._frameLoaded=function(A){hui.ui.callSuperDelegates(this,"frameLoaded",A)};hui.ui._resize=function(){for(var A=hui.ui.layoutWidgets.length-1;A>=0;A--){hui.ui.layoutWidgets[A]["$$layout"]()}};hui.ui.confirmOverlay=function(B){var E=B.element,A;if(!E){E=document.body}if(B.widget){E=B.widget.getElement()}if(hui.ui.confirmOverlays[E]){A=hui.ui.confirmOverlays[E];A.clear()}else{A=hui.ui.Overlay.create({modal:true});hui.ui.confirmOverlays[E]=A}if(B.text){A.addText(B.text)}var C=hui.ui.Button.create({text:B.okText||"OK",highlighted:"true"});C.click(function(){if(B.onOk){B.onOk()}A.hide()});A.add(C);var D=hui.ui.Button.create({text:B.cancelText||"Cancel"});D.onClick(function(){A.hide()});A.add(D);A.show({element:E})};hui.ui.destroy=function(B){var A=hui.ui.objects;delete (A[B.name])};hui.ui.destroyDescendants=function(B){var E=hui.ui.getDescendants(B);var C=hui.ui.objects;for(var A=0;A<E.length;A++){var D=delete (C[E[A].name]);if(!D){hui.log("not found: "+E[A].name)}}};hui.ui.getAncestors=function(E){var H=[];var F=E.element;if(F){var A=hui.getAncestors(F);var G=[];for(var D in hui.ui.objects){G.push(hui.ui.objects[D])}for(var C=0;C<A.length;C++){for(var B=0;B<G.length;B++){if(G[B].element==A[C]){H.push(G[B])}}}}return H};hui.ui.getDescendants=function(H){var G=[],D=H.getElement?H.getElement():H;if(D){var F=D.getElementsByTagName("*");var E=[];for(var C in hui.ui.objects){E.push(hui.ui.objects[C])}for(var B=0;B<F.length;B++){for(var A=0;A<E.length;A++){if(F[B]==E[A].element){G.push(E[A])}}}}return G};hui.ui.getAncestor=function(D,B){var A=hui.ui.getAncestors(D);for(var C=0;C<A.length;C++){if(hui.hasClass(A[C].getElement(),B)){return A[C]}}return null};hui.ui.changeState=function(C){if(hui.ui.state===C){return }var B=hui.ui.objects,A,D;for(A in B){D=B[A];if(D.options&&D.options.state){if(D.options.state==C){D.show()}else{D.hide()}}}hui.ui.state=C;this.reLayout()};hui.ui.reLayout=function(){var A=hui.ui.objects,B;for(key in A){B=A[key];if(B["$$layoutChanged"]){B["$$layoutChanged"]()}}};hui.ui.nextIndex=function(){hui.ui.latestIndex++;return hui.ui.latestIndex};hui.ui.nextPanelIndex=function(){hui.ui.latestPanelIndex++;return hui.ui.latestPanelIndex};hui.ui.nextAlertIndex=function(){hui.ui.latestAlertIndex++;return hui.ui.latestAlertIndex};hui.ui.nextTopIndex=function(){hui.ui.latestTopIndex++;return hui.ui.latestTopIndex};hui.ui.showCurtain=function(C){var D=C.widget;if(!D.curtain){D.curtain=hui.build("div",{"class":"hui_curtain",style:"z-index:none"});var A=hui.firstByClass(document.body,"hui_body");if(!A){A=document.body}A.appendChild(D.curtain);hui.listen(D.curtain,"click",function(){if(D["$curtainWasClicked"]){D["$curtainWasClicked"]()}})}if(C.color){if(C.color=="auto"){var B=hui.getStyle(document.body,"background-color");if(B=="transparent"||B=="rgba(0, 0, 0, 0)"){B="#fff"}D.curtain.style.backgroundColor=B}else{D.curtain.style.backgroundColor=C.color}}if(hui.browser.msie){D.curtain.style.height=hui.getDocumentHeight()+"px"}else{D.curtain.style.position="fixed";D.curtain.style.top="0";D.curtain.style.left="0";D.curtain.style.bottom="0";D.curtain.style.right="0"}D.curtain.style.zIndex=C.zIndex;hui.setOpacity(D.curtain,0);D.curtain.style.display="block";hui.animate(D.curtain,"opacity",0.7,1000,{ease:hui.ease.slowFastSlow})};hui.ui.hideCurtain=function(A){if(A.curtain){hui.animate(A.curtain,"opacity",0,200,{hideOnComplete:true})}};hui.ui.confirm=function(A){if(!A.name){A.name="huiConfirm"}var D=hui.ui.get(A.name);var B;if(!D){D=hui.ui.Alert.create(A);var C=hui.ui.Button.create({name:name+"_cancel",text:A.cancel||"Cancel",highlighted:A.highlighted==="cancel"});C.listen({$click:function(){D.hide();if(A.onCancel){A.onCancel()}hui.ui.callDelegates(D,"cancel")}});D.addButton(C);B=hui.ui.Button.create({name:name+"_ok",text:A.ok||"OK",highlighted:A.highlighted==="ok"});D.addButton(B)}else{D.update(A);B=hui.ui.get(name+"_ok");B.setText(A.ok||"OK");B.setHighlighted(A.highlighted=="ok");B.clearDelegates();hui.ui.get(name+"_cancel").setText(A.ok||"Cancel");hui.ui.get(name+"_cancel").setHighlighted(A.highlighted=="cancel");if(A.cancel){hui.ui.get(name+"_cancel").setText(A.cancel)}}B.listen({$click:function(){D.hide();if(A.onOK){A.onOK()}hui.ui.callDelegates(D,"ok")}});D.show()};hui.ui.alert=function(A){if(!this.alertBox){this.alertBox=hui.ui.Alert.create(A);this.alertBoxButton=hui.ui.Button.create({name:"huiAlertBoxButton",text:"OK"});this.alertBoxButton.listen({$click$huiAlertBoxButton:function(){hui.ui.alertBox.hide();if(hui.ui.alertBoxCallBack){hui.ui.alertBoxCallBack();hui.ui.alertBoxCallBack=null}}});this.alertBox.addButton(this.alertBoxButton)}else{this.alertBox.update(A)}this.alertBoxCallBack=A.onOK;this.alertBoxButton.setText(A.button?A.button:"OK");this.alertBox.show()};hui.ui.showMessage=function(B){if(typeof (B)=="string"){B={text:B}}if(B.delay){hui.ui.messageDelayTimer=window.setTimeout(function(){B.delay=null;hui.ui.showMessage(B)},B.delay);return }window.clearTimeout(hui.ui.messageDelayTimer);if(!hui.ui.message){hui.ui.message=hui.build("div",{"class":"hui_message",html:"<div><div></div></div>"});if(!hui.browser.msie){hui.setOpacity(hui.ui.message,0)}document.body.appendChild(hui.ui.message)}var A=hui.ui.message.getElementsByTagName("div")[1];if(B.icon){hui.dom.clear(A);A.appendChild(hui.ui.createIcon(B.icon,24));hui.dom.addText(A,B.text)}else{if(B.busy){A.innerHTML='<span class="hui_message_busy"></span>';hui.dom.addText(A,B.text)}else{hui.dom.setText(A,B.text)}}hui.ui.message.style.display="block";hui.ui.message.style.zIndex=hui.ui.nextTopIndex();hui.ui.message.style.marginLeft=(hui.ui.message.clientWidth/-2)+"px";hui.ui.message.style.marginTop=hui.getScrollTop()+"px";if(hui.browser.opacity){hui.animate(hui.ui.message,"opacity",1,300)}window.clearTimeout(hui.ui.messageTimer);if(B.duration){hui.ui.messageTimer=window.setTimeout(hui.ui.hideMessage,B.duration)}};hui.ui.hideMessage=function(){window.clearTimeout(hui.ui.messageDelayTimer);if(hui.ui.message){if(hui.browser.opacity){hui.animate(hui.ui.message,"opacity",0,300,{hideOnComplete:true})}else{hui.ui.message.style.display="none"}}};hui.ui.showToolTip=function(A){var C=A.key||"common";var B=hui.ui.toolTips[C];if(!B){B=hui.build("div",{"class":"hui_tooltip",style:"display:none;",html:"<div><div></div></div>",parent:document.body});hui.ui.toolTips[C]=B}B.onclick=function(){hui.ui.hideToolTip(A)};var E=hui.get(A.element);var D=hui.getPosition(E);hui.dom.setText(B.getElementsByTagName("div")[1],A.text);if(B.style.display=="none"&&hui.browser.opacity){hui.setOpacity(B,0)}hui.setStyle(B,{"display":"block",zIndex:hui.ui.nextTopIndex()});hui.setStyle(B,{left:(D.left-B.clientWidth+4)+"px",top:(D.top+2-(B.clientHeight/2)+(E.clientHeight/2))+"px"});if(hui.browser.opacity){hui.animate(B,"opacity",1,300)}};hui.ui.hideToolTip=function(A){var C=A?A.key||"common":"common";var B=hui.ui.toolTips[C];if(B){if(!hui.browser.msie){hui.animate(B,"opacity",0,300,{hideOnComplete:true})}else{B.style.display="none"}}};hui.ui.getElement=function(A){if(hui.dom.isElement(A)){return A}else{if(A.getElement){return A.getElement()}}return null};hui.ui.isWithin=function(B,A){B=new hui.Event(B);var D={left:hui.getLeft(A),top:hui.getTop(A)};var C={width:A.clientWidth,height:A.clientHeight};return B.getLeft()>D.left&&B.getLeft()<D.left+C.width&&B.getTop()>D.top&&B.getTop()<D.top+C.height};hui.ui.getIconUrl=function(B,A){return hui.ui.context+"/hui/icons/"+B+A+".png"};hui.ui.createIcon=function(B,A){return hui.build("span",{"class":"hui_icon hui_icon_"+A,style:"background-image: url("+hui.ui.getIconUrl(B,A)+")"})};hui.ui.wrapInField=function(B){var A=hui.build("div",{"class":"hui_field",html:'<span class="hui_field_top"><span><span></span></span></span><span class="hui_field_middle"><span class="hui_field_middle"><span class="hui_field_content"></span></span></span><span class="hui_field_bottom"><span><span></span></span></span>'});hui.firstByClass(A,"hui_field_content").appendChild(B);return A};hui.ui.addFocusClass=function(B){var A=B.classElement||B.element,C=B["class"];hui.listen(B.element,"focus",function(){hui.addClass(A,C)});hui.listen(B.element,"blur",function(){hui.removeClass(A,C)})};hui.ui.NumberValidator=function(A){hui.override({allowNull:false,min:0,max:10},A);this.min=A.min;this.max=A.max;this.allowNull=A.allowNull;this.middle=Math.max(Math.min(this.max,0),this.min)};hui.ui.NumberValidator.prototype={validate:function(B){if(hui.isBlank(B)&&this.allowNull){return{valid:true,value:null}}var A=parseFloat(B);if(isNaN(A)){return{valid:false,value:this.middle}}else{if(A<this.min){return{valid:false,value:this.min}}else{if(A>this.max){return{valid:false,value:this.max}}}}return{valid:true,value:A}}};hui.ui.fadeIn=function(A,B){if(hui.getStyle(A,"display")=="none"){hui.setStyle(A,{opacity:0,display:""})}hui.animate(A,"opacity",1,B)};hui.ui.fadeOut=function(A,B){hui.animate(A,"opacity",0,B,{hideOnComplete:true})};hui.ui.bounceIn=function(A){if(hui.browser.msie){hui.setStyle(A,{"display":"block",visibility:"visible"})}else{hui.setStyle(A,{"display":"block","opacity":0,visibility:"visible"});hui.animate(A,"transform","scale(0.1)",0);window.setTimeout(function(){hui.animate(A,"opacity",1,300);hui.animate(A,"transform","scale(1)",400,{ease:hui.ease.backOut})})}};hui.ui.positionAtElement=function(C,G,B){B=B||{};C=hui.get(C);G=hui.get(G);var D=hui.getStyle(C,"display");if(D=="none"){hui.setStyle(C,{"visibility":"hidden","display":"block"})}var F=hui.getLeft(G),E=hui.getTop(G);var A=B.vertical||null;if(B.horizontal&&B.horizontal=="right"){F=F+G.clientWidth-C.clientWidth}if(A=="topOutside"){E=E-C.clientHeight}else{if(A=="bottomOutside"){E=E+G.clientHeight}}F+=(B.left||0);E+=(B.top||0);hui.setStyle(C,{"left":F+"px","top":E+"px"});if(D=="none"){hui.setStyle(C,{"visibility":"visible","display":"none"})}};hui.ui.getTextAreaHeight=function(A){var C=this.textAreaDummy;if(!C){C=this.textAreaDummy=document.createElement("div");C.className="hui_textarea_dummy";document.body.appendChild(C)}var B=A.value;if(B[B.length-1]==="\n"){B+="x"}B=hui.escape(B).replace(/\n/g,"<br/>");C.innerHTML=B;C.style.width=(A.clientWidth)+"px";return C.clientHeight};hui.ui.extend=function(B,A){if(!B.name){hui.ui.latestObjectIndex++;B.name="unnamed"+hui.ui.latestObjectIndex}if(A!==undefined){if(B.options){B.options=hui.override(B.options,A)}B.element=hui.get(A.element);B.name=A.name}hui.ui.objects[B.name]=B;B.delegates=[];B.listen=function(C){hui.addToArray(this.delegates,C);return this};B.removeDelegate=function(C){hui.removeFromArray(this.delegates,C)};B.clearDelegates=function(){this.delegates=[]};B.fire=function(E,D,C){hui.ui.callDelegates(this,E,D,C)};B.fireProperty=function(C,D){hui.ui.firePropertyChange(this,C,D)};if(!B.getElement){B.getElement=function(){return this.element}}if(!B.valueForProperty){B.valueForProperty=function(C){return this[C]}}if(B["$$layout"]){hui.ui.layoutWidgets.push(B)}};hui.ui.callDelegatesDrop=function(A,C){for(var B=0;B<hui.ui.delegates.length;B++){if(hui.ui.delegates[B]["$drop$"+A.kind+"$"+C.kind]){hui.ui.delegates[B]["$drop$"+A.kind+"$"+C.kind](A,C)}}};hui.ui.callAncestors=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}var E=hui.ui.getAncestors(D);for(var A=0;A<E.length;A++){if(E[A][F]){E[A][F](C,B)}}};hui.ui.callDescendants=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}if(!F[0]=="$"){F="$"+F}var E=hui.ui.getDescendants(D);for(var A=0;A<E.length;A++){if(E[A][F]){thisResult=E[A][F](C,B)}}};hui.ui.callVisible=function(A){hui.ui.callDescendants(A,"$visibilityChanged")};hui.ui.listen=function(A){hui.ui.delegates.push(A)};hui.ui.callDelegates=function(E,A,H,B){if(typeof (H)=="undefined"){H=E}var I=null;if(E.delegates){for(var F=0;F<E.delegates.length;F++){var G=E.delegates[F];var C=null;if(E.name&&G["$"+A+"$"+E.name]){C=G["$"+A+"$"+E.name](H,B)}else{if(G["$"+A]){C=G["$"+A](H,B)}}if(I==null&&C!=null&&typeof (C)!="undefined"){I=C}}}var D=hui.ui.callSuperDelegates(E,A,H,B);if(I==null&&D!=null){I=D}return I};hui.ui.callSuperDelegates=function(F,H,E,D){if(typeof (E)=="undefined"){E=F}var A=null;for(var B=0;B<hui.ui.delegates.length;B++){var C=hui.ui.delegates[B];var G=null;if(F.name&&C["$"+H+"$"+F.name]){G=C["$"+H+"$"+F.name](E,D)}else{if(C["$"+H]){G=C["$"+H](E,D)}}if(A==null&&G!=null&&typeof (G)!="undefined"){A=G}}return A};hui.ui.resolveImageUrl=function(G,B,F,A){for(var D=0;D<G.delegates.length;D++){if(G.delegates[D].$resolveImageUrl){return G.delegates[D].$resolveImageUrl(B,F,A)}}for(var C=0;C<hui.ui.delegates.length;C++){var E=hui.ui.delegates[C];if(E.$resolveImageUrl){return E.$resolveImageUrl(B,F,A)}}return null};hui.ui.firePropertyChange=function(C,A,B){hui.ui.callDelegates(C,"propertyChanged",{property:A,value:B})};hui.ui.bind=function(E,A){if(E.charAt(0)=="@"){var D=E.substring(1).split(".");var C=hui.ui.get(D[0]);if(!C){hui.log("Unable to bind to "+E);return }var B=D.slice(1).join(".");C.listen({$propertyChanged:function(F){if(F.property==B){A(F.value)}}});return C.valueForProperty(B)}return E};hui.ui.handleRequestError=function(B){hui.log("General request error received");var A=hui.ui.callSuperDelegates(B||this,"requestError");if(!A){hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("request_error"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})}};hui.ui.handleForbidden=function(B){hui.log("General access denied received");var A=hui.ui.callSuperDelegates(B||this,"accessDenied");if(!A){hui.ui.confirmOverlay({element:document.body,text:hui.ui.getText("access_denied"),okText:hui.ui.getText("reload_page"),cancelText:hui.ui.getText("continue"),onOk:function(){document.location.reload()}})}};hui.ui.request=function(B){B=hui.override({method:"post",parameters:{}},B);if(B.json){for(var C in B.json){B.parameters[C]=hui.toJSON(B.json[C])}}var F=B.onSuccess;var E=B.message;B.onSuccess=function(H){if(E){if(E.success){hui.ui.showMessage({text:E.success,icon:"common/success",duration:E.duration||2000})}else{if(E.start){hui.ui.hideMessage()}}}var I,G;if(typeof (F)=="string"){if(!hui.request.isXMLResponse(H)){I=H.responseText.replace(/^\s+|\s+$/g,"");if(I.length>0){G=hui.fromJSON(H.responseText)}else{G=""}hui.ui.callDelegates(G,"success$"+F)}else{hui.ui.callDelegates(H,"success$"+F)}}else{if(hui.request.isXMLResponse(H)&&B.onXML){B.onXML(H.responseXML)}else{if(B.onJSON){I=H.responseText.replace(/^\s+|\s+$/g,"");if(I.length>0){G=hui.fromJSON(H.responseText)}else{G=null}B.onJSON(G)}else{if(typeof (F)=="function"){F(H)}else{if(B.onText){B.onText(H.responseText)}}}}}};var D=B.onFailure;B.onFailure=function(G){if(typeof (D)=="string"){hui.ui.callDelegates(G,"failure$"+D)}else{if(typeof (D)=="function"){D(G)}else{if(B.message&&B.message.start){hui.ui.hideMessage()}hui.ui.handleRequestError()}}};B.onException=function(G,H){hui.log(G);hui.log(H)};var A=B.onForbidden;B.onForbidden=function(G){if(B.message&&B.message.start){hui.ui.hideMessage()}if(A){A(G)}else{B.onFailure(G);hui.ui.handleForbidden()}};if(B.message&&B.message.start){hui.ui.showMessage({text:B.message.start,busy:true,delay:B.message.delay})}hui.request(B)};hui.ui.parseItems=function(C){var A=C.documentElement;var B=[];hui.ui.parseSubItems(A,B);return B};hui.ui.parseSubItems=function(D,F){var B=D.childNodes;for(var A=0;A<B.length;A++){var E=B[A];if(E.nodeType==1&&E.nodeName=="title"){F.push({title:E.getAttribute("title"),type:"title"})}else{if(E.nodeType==1&&E.nodeName=="item"){var C=[];hui.ui.parseSubItems(E,C);F.push({title:E.getAttribute("title"),value:E.getAttribute("value"),icon:E.getAttribute("icon"),kind:E.getAttribute("kind"),badge:E.getAttribute("badge"),children:C})}}}};hui.ui.Bundle=function(A){this.strings=A};hui.ui.Bundle.prototype={get:function(B){var A=this.strings[B];if(A){return A[hui.ui.language]}hui.log(B+" not found for language:"+hui.ui.language);return B}};hui.ui.require=function(C,B){for(var A=C.length-1;A>=0;A--){C[A]=hui.ui.context+"hui/js/"+C[A]+".js"}hui.require(C,B)};hui.ui.Source=function(A){this.options=hui.override({url:null,dwr:null,parameters:[],lazy:false},A);this.name=A.name;this.data=null;this.parameters=this.options.parameters;hui.ui.extend(this);if(A.delegate){this.listen(A.delegate)}this.initial=true;this.busy=false;hui.ui.onReady(this.init.bind(this))};hui.ui.Source.prototype={init:function(){var A=this;hui.each(this.parameters,function(C){var B=hui.ui.bind(C.value,function(D){A.changeParameter(C.key,D)});C.value=A.convertValue(B)});if(!this.options.lazy){this.refresh()}},convertValue:function(A){if(A&&A.getTime){return A.getTime()}return A},refreshFirst:function(){if(this.initial){this.refresh()}},refresh:function(){if(this.delegates.length==0){return }var shouldRefresh=this.delegates.length==0;for(var i=0;i<this.delegates.length;i++){var d=this.delegates[i];if(d["$sourceShouldRefresh"]){shouldRefresh=shouldRefresh||d["$sourceShouldRefresh"]()}else{shouldRefresh=true}}if(!shouldRefresh){return }if(this.busy){this.pendingRefresh=true;return }this.initial=false;this.pendingRefresh=false;var self=this;if(this.options.url){var prms={};for(var j=0;j<this.parameters.length;j++){var p=this.parameters[j];prms[p.key]=p.value}this.busy=true;hui.ui.callDelegates(this,"sourceIsBusy");this.transport=hui.request({method:"post",url:this.options.url,parameters:prms,onSuccess:this.parse.bind(this),onException:function(e,t){hui.log("Exception while loading source...");hui.log(e);self.end()},onForbidden:function(){hui.ui.handleForbidden(self);hui.ui.callDelegates(self,"sourceFailed");self.end()},onFailure:function(t){hui.log("sourceFailed");hui.ui.callDelegates(self,"sourceFailed");self.end()}})}else{if(this.options.dwr){var pair=this.options.dwr.split(".");var facade=eval(pair[0]);var method=pair[1];var args=facade[method].argumentNames();for(var k=0;k<args.length;k++){if(this.parameters[k]){args[k]=this.parameters[k].value===undefined?null:this.parameters[k].value}}args[args.length-1]=function(r){self.parseDWR(r)};this.busy=true;hui.ui.callDelegates(this,"sourceIsBusy");facade[method].apply(facade,args)}}},end:function(){this.busy=false;if(this.pendingRefresh){this.refresh()}else{hui.ui.callDelegates(this,"sourceIsNotBusy")}},parse:function(B){if(hui.request.isXMLResponse(B)){this.parseXML(B.responseXML)}else{var C=B.responseText.replace(/^\s+|\s+$/g,""),A=null;if(C.length>0){A=hui.fromJSON(B.responseText)}this.fire("objectsLoaded",A)}this.end()},parseXML:function(A){if(A.documentElement.tagName=="items"){this.data=hui.ui.parseItems(A);this.fire("itemsLoaded",this.data)}else{if(A.documentElement.tagName=="list"){this.fire("listLoaded",A)}else{if(A.documentElement.tagName=="articles"){this.fire("articlesLoaded",A)}}}},parseDWR:function(A){this.data=A;this.fire("objectsLoaded",A);this.end()},addParameter:function(A){this.parameters.push(A)},changeParameter:function(B,C){C=this.convertValue(C);for(var A=0;A<this.parameters.length;A++){var D=this.parameters[A];if(D.key==B){D.value=C}}window.clearTimeout(this.paramDelay);this.paramDelay=window.setTimeout(function(){this.refresh()}.bind(this),100)}};hui.ui.getDragProxy=function(){if(!hui.ui.dragProxy){hui.ui.dragProxy=hui.build("div",{"class":"hui_dragproxy",style:"display:none"});document.body.appendChild(hui.ui.dragProxy)}return hui.ui.dragProxy};hui.ui.startDrag=function(E,C,A){E=new hui.Event(E);var D=C.dragDropInfo;hui.ui.dropTypes=hui.ui.findDropTypes(D);if(!hui.ui.dropTypes){return }var B=hui.ui.getDragProxy();hui.listen(document.body,"mousemove",hui.ui.dragListener);hui.listen(document.body,"mouseup",hui.ui.dragEndListener);hui.ui.dragInfo=D;if(D.icon){B.style.backgroundImage="url("+hui.ui.getIconUrl(D.icon,16)+")"}hui.ui.startDragPos={top:E.getTop(),left:E.getLeft()};B.innerHTML=D.title?"<span>"+hui.escape(D.title)+"</span>":"###";hui.ui.dragging=true;document.body.onselectstart=function(){return false}};hui.ui.findDropTypes=function(D){var A=hui.ui;var F=null;for(var C=0;C<A.delegates.length;C++){if(A.delegates[C].dragDrop){for(var B=0;B<A.delegates[C].dragDrop.length;B++){var E=A.delegates[C].dragDrop[B];if(E.drag==D.kind){if(F==null){F={}}F[E.drop]={}}}}}return F};hui.ui.dragListener=function(B){B=new hui.Event(B);hui.ui.dragProxy.style.left=(B.getLeft()+10)+"px";hui.ui.dragProxy.style.top=B.getTop()+"px";hui.ui.dragProxy.style.display="block";var A=hui.ui.findDropTarget(B.getElement());if(A&&hui.ui.dropTypes[A.dragDropInfo["kind"]]){if(hui.ui.latestDropTarget){hui.removeClass(hui.ui.latestDropTarget,"hui_drop")}hui.addClass(A,"hui_drop");hui.ui.latestDropTarget=A}else{if(hui.ui.latestDropTarget){hui.removeClass(hui.ui.latestDropTarget,"hui_drop");hui.ui.latestDropTarget=null}}return false};hui.ui.findDropTarget=function(A){while(A){if(A.dragDropInfo){return A}A=A.parentNode}return null};hui.ui.dragEndListener=function(A){hui.unListen(document.body,"mousemove",hui.ui.dragListener);hui.unListen(document.body,"mouseup",hui.ui.dragEndListener);hui.ui.dragging=false;if(hui.ui.latestDropTarget){hui.removeClass(hui.ui.latestDropTarget,"hui_drop");hui.ui.callDelegatesDrop(hui.ui.dragInfo,hui.ui.latestDropTarget.dragDropInfo);hui.ui.dragProxy.style.display="none"}else{hui.animate(hui.ui.dragProxy,"left",(hui.ui.startDragPos.left+10)+"px",200,{ease:hui.ease.fastSlow});hui.animate(hui.ui.dragProxy,"top",(hui.ui.startDragPos.top-5)+"px",200,{ease:hui.ease.fastSlow,hideOnComplete:true})}hui.ui.latestDropTarget=null;document.body.onselectstart=null};hui.ui.dropOverListener=function(A){if(hui.ui.dragging){}};hui.ui.dropOutListener=function(A){if(hui.ui.dragging){}};hui.ui.Window=function(A){this.element=hui.get(A.element);this.name=A.name;this.close=hui.firstByClass(this.element,"hui_window_close");this.titlebar=hui.firstByClass(this.element,"hui_window_titlebar");this.title=hui.firstByClass(this.titlebar,"hui_window_title");this.content=hui.firstByClass(this.element,"hui_window_body");this.front=hui.firstByClass(this.element,"hui_window_front");this.back=hui.firstByClass(this.element,"hui_window_back");if(this.back){hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.visible=false;hui.ui.extend(this);this.addBehavior()};hui.ui.Window.create=function(A){A=hui.override({title:"Window",close:true},A);var B='<div class="hui_window_front">'+(A.close?'<div class="hui_window_close"></div>':"")+'<div class="hui_window_titlebar"><div><div>';if(A.icon){B+='<span class="hui_window_icon" style="background-image: url('+hui.ui.getIconUrl(A.icon,16)+')"></span>'}B+='<span class="hui_window_title">'+A.title+'</span></div></div></div><div class="hui_window_content"><div class="hui_window_content"><div class="hui_window_body" style="'+(A.width?"width:"+A.width+"px;":"")+(A.padding?"padding:"+A.padding+"px;":"")+'"></div></div></div><div class="hui_window_bottom"><div class="hui_window_bottom"><div class="hui_window_bottom"></div></div></div></div>';A.element=hui.build("div",{"class":"hui_window"+(A.variant?" hui_window_"+A.variant:""),html:B,parent:document.body});return new hui.ui.Window(A)};hui.ui.Window.prototype={addBehavior:function(){var A=this;if(this.close){hui.listen(this.close,"click",function(B){this.hide();this.fire("userClosedWindow")}.bind(this));hui.listen(this.close,"mousedown",function(B){hui.stop(B)})}this.titlebar.onmousedown=function(B){A.startDrag(B);return false};hui.listen(this.element,"mousedown",function(){A.element.style.zIndex=hui.ui.nextPanelIndex()})},setTitle:function(A){hui.dom.setText(this.title,A)},show:function(B){if(this.visible){var D=hui.getScrollTop();var A=hui.getTop(this.element);if(A<D||A+this.element.clientHeight>hui.getViewPortHeight()+D){hui.animate({node:this.element,css:{top:(D+40)+"px"},duration:500,ease:hui.ease.slowFastSlow})}this.element.style.zIndex=hui.ui.nextPanelIndex();return }B=B||{};hui.setStyle(this.element,{zIndex:hui.ui.nextPanelIndex(),visibility:"hidden",display:"block"});var C=this.element.clientWidth;hui.setStyle(this.element,{width:C+"px",visibility:"visible"});if(B.avoid){hui.place({insideViewPort:true,target:{element:B.avoid,vertical:0.5,horizontal:1},source:{element:this.element,vertical:0.5,horizontal:0}})}else{if(!this.element.style.top){this.element.style.top=(hui.getScrollTop()+40)+"px"}if(!this.element.style.left){this.element.style.left=Math.round((hui.getViewPortWidth()-C)/2)+"px"}}if(hui.browser.opacity){hui.animate(this.element,"opacity",1,0)}this.visible=true;hui.ui.callVisible(this)},toggle:function(){(this.visible?this.hide():this.show())},hide:function(){if(!this.visible){return }if(hui.browser.opacity){hui.animate(this.element,"opacity",0,200,{onComplete:function(){this.element.style.display="none";hui.ui.callVisible(this)}.bind(this)})}else{this.element.style.display="none";hui.ui.callVisible(this)}this.visible=false},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},addToBack:function(A){if(!this.back){this.back=hui.build("div",{className:"hui_window_back"});this.element.insertBefore(this.back,this.front);hui.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.back.appendChild(hui.ui.getElement(A))},setVariant:function(A){hui.removeClass(this.element,"hui_window_dark");hui.removeClass(this.element,"hui_window_light");if(A=="dark"||A=="light"){hui.addClass(this.element,"hui_window_"+A)}},flip:function(){if(this.back){this.back.style.minHeight=this.element.clientHeight+"px";hui.effect.flip({element:this.element})}},startDrag:function(C){var B=new hui.Event(C);this.element.style.zIndex=hui.ui.nextPanelIndex();var D={top:hui.getTop(this.element),left:hui.getLeft(this.element)};this.dragState={left:B.getLeft()-D.left,top:B.getTop()-D.top};this.latestPosition={left:this.dragState.left,top:this.dragState.top};this.latestTime=new Date().getMilliseconds();var A=this;this.moveListener=function(E){A.drag(E)};this.upListener=function(E){A.endDrag(E)};hui.listen(document,"mousemove",this.moveListener);hui.listen(document,"mouseup",this.upListener);hui.listen(document,"mousedown",this.upListener);B.stop();document.body.onselectstart=function(){return false};return false},calc:function(B,A){this.a=this.latestPosition.left-A;this.b=this.latestPosition.top-B;this.dist=Math.sqrt(Math.pow((this.a),2),Math.pow((this.b),2));this.latestTime=new Date().getMilliseconds();this.latestPosition={"top":B,"left":A}},drag:function(D){var A=new hui.Event(D);this.element.style.right="auto";var C=(A.getTop()-this.dragState.top);var B=(A.getLeft()-this.dragState.left);this.element.style.top=Math.max(C,0)+"px";this.element.style.left=Math.max(B,0)+"px";return false},endDrag:function(A){hui.unListen(document,"mousemove",this.moveListener);hui.unListen(document,"mouseup",this.upListener);hui.unListen(document,"mousedown",this.upListener);document.body.onselectstart=null}};hui.ui.Formula=function(A){this.options=A;hui.ui.extend(this,A);this.addBehavior()};hui.ui.Formula.create=function(A){A=A||{};var B={"class":"hui_formula hui_formula"};if(A.action){B.action=A.action}if(A.method){B.method=A.method}A.element=hui.build("form",B);return new hui.ui.Formula(A)};hui.ui.Formula.prototype={addBehavior:function(){this.element.onsubmit=function(){return false}},submit:function(){this.fire("submit")},getValues:function(){var B={};var C=hui.ui.getDescendants(this);for(var A=0;A<C.length;A++){if(C[A].options&&C[A].options.key&&C[A].getValue){B[C[A].options.key]=C[A].getValue()}else{if(C[A].name&&C[A].getValue){B[C[A].name]=C[A].getValue()}}}return B},setValues:function(A){var D=hui.ui.getDescendants(this);for(var C=0;C<D.length;C++){if(D[C].options&&D[C].options.key){var B=D[C].options.key;if(B&&A[B]!==undefined){D[C].setValue(A[B])}}}},focus:function(){var B=hui.ui.getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].focus){B[A].focus();return }}},reset:function(){var B=hui.ui.getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].reset){B[A].reset()}}},add:function(A){this.element.appendChild(A.getElement())},createGroup:function(A){var B=hui.ui.Formula.Group.create(A);this.add(B);return B},buildGroup:function(A,C){var B=this.createGroup(A);hui.each(C,function(E){if(hui.ui.Formula[E.type]){var D=hui.ui.Formula[E.type].create(E.options);B.add(D)}else{if(hui.ui[E.type]){var D=hui.ui[E.type].create(E.options);B.add(D)}else{hui.log("buildGroup: Unable to find type: "+E.type)}}});return B},childValueChanged:function(A){this.fire("valuesChanged",this.getValues())},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.Formula.Group=function(A){this.name=A.name;this.element=hui.get(A.element);this.body=hui.firstByTag(this.element,"tbody");this.options=hui.override({above:true},A);hui.ui.extend(this)};hui.ui.Formula.Group.create=function(A){A=hui.override({above:true},A);var B=A.element=hui.build("table",{"class":"hui_formula_group"});if(A.above){hui.addClass(B,"hui_formula_group_above")}B.appendChild(hui.build("tbody"));return new hui.ui.Formula.Group(A)};hui.ui.Formula.Group.prototype={add:function(E){var D=hui.build("tr");this.body.appendChild(D);var F=hui.build("td",{"class":"hui_formula_group"});if(E.getLabel){var A=E.getLabel();if(A){if(this.options.above){hui.build("label",{text:A,parent:F})}else{var C=hui.build("th",{parent:D});hui.build("label",{text:A,parent:C})}}}var B=hui.build("div",{"class":"hui_formula_item"});B.appendChild(E.getElement());F.appendChild(B);D.appendChild(F)},createButtons:function(B){var C=hui.build("tr",{parent:this.body});var D=hui.build("td",{colspan:this.options.above?1:2,parent:C});var A=hui.ui.Buttons.create(B);D.appendChild(A.getElement());return A}};hui.ui.List=function(A){this.options=hui.override({url:null,source:null,selectable:true},A);this.element=hui.get(A.element);this.name=A.name;if(this.options.source){this.options.source.listen(this)}this.url=A.url;this.table=hui.firstByTag(this.element,"table");this.head=hui.firstByTag(this.element,"thead");this.body=hui.firstByTag(this.element,"tbody");this.columns=[];this.rows=[];this.selected=[];this.navigation=hui.firstByClass(this.element,"hui_list_navigation");this.count=hui.firstByClass(this.navigation,"hui_list_count");this.windowPage=hui.firstByClass(this.navigation,"window_page");this.windowPageBody=hui.firstByClass(this.navigation,"window_page_body");this.parameters={};this.sortKey=null;this.sortDirection=null;this.window={size:null,page:0,total:0};if(A.windowSize!=""){this.window.size=parseInt(A.windowSize)}hui.ui.extend(this);if(A.dropFiles){this._addDrop()}if(this.url){this.refresh()}};hui.ui.List.create=function(A){A=hui.override({},A);A.element=hui.build("div",{"class":"hui_list",html:'<div class="hui_list_progress"></div><div class="hui_list_navigation"><div class="hui_list_selection window_page"><div><div class="window_page_body"></div></div></div><span class="hui_list_count"></span></div><div class="hui_list_body"'+(A.maxHeight>0?' style="max-height: '+A.maxHeight+'px; overflow: auto;"':"")+'><table cellspacing="0" cellpadding="0"><thead><tr></tr></thead><tbody></tbody></table></div>'});return new hui.ui.List(A)};hui.ui.List.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_list_drop",onFiles:function(A){this.fire("filesDropped",A)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block";this.refresh()},registerColumn:function(A){this.columns.push(A)},getSelection:function(){var A=[];for(var B=0;B<this.selected.length;B++){A.push(this.rows[this.selected[B]])}return A},getRows:function(){return this.rows},getFirstSelection:function(){var A=this.getSelection();if(A.length>0){return A[0]}else{return null}},setParameter:function(A,B){this.parameters[A]=B},loadData:function(A){this.setUrl(A)},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.removeDelegate(this)}A.listen(this);this.options.source=A;A.refresh()}},setUrl:function(A){if(this.options.source){this.options.source.removeDelegate(this);this.options.source=null}this.url=A;this.selected=[];this.sortKey=null;this.sortDirection=null;this.resetState();this.refresh()},clear:function(){this.selected=[];this.columns=[];this.rows=[];this.navigation.style.display="none";hui.dom.clear(this.body);hui.dom.clear(this.head);if(this.options.source){this.options.source.removeDelegate(this)}this.options.source=null;this.url=null},resetState:function(){this.window={size:null,page:0,total:0};hui.ui.firePropertyChange(this,"window",this.window);hui.ui.firePropertyChange(this,"window.page",this.window.page)},valueForProperty:function(A){if(A=="window.page"){return this.window.page}if(A=="window.page"){return this.window.page}else{if(A=="sort.key"){return this.sortKey}else{if(A=="sort.direction"){return(this.sortDirection||"ascending")}else{return this[A]}}}},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){if(this.options.source&&hui.dom.isVisible(this.element)){this.options.source.refreshFirst()}},refresh:function(){if(this.options.source){this.options.source.refresh();return }if(!this.url){return }var A=this.url;if(typeof (this.window.page)=="number"){A+=A.indexOf("?")==-1?"?":"&";A+="windowPage="+this.window.page}if(this.window.size){A+=A.indexOf("?")==-1?"?":"&";A+="windowSize="+this.window.size}if(this.sortKey){A+=A.indexOf("?")==-1?"?":"&";A+="sort="+this.sortKey}if(this.sortDirection){A+=A.indexOf("?")==-1?"?":"&";A+="direction="+this.sortDirection}for(var B in this.parameters){A+=A.indexOf("?")==-1?"?":"&";A+=B+"="+this.parameters[B]}this._setBusy(true);hui.ui.request({url:A,onJSON:function(C){this._setBusy(false);this.$objectsLoaded(C)}.bind(this),onXML:function(C){this._setBusy(false);this.$listLoaded(C)}.bind(this)})},sort:function(A){var B=this.columns[A].key;if(B==this.sortKey){this.sortDirection=this.sortDirection=="ascending"?"descending":"ascending";hui.ui.firePropertyChange(this,"sort.direction",this.sortDirection)}else{hui.ui.firePropertyChange(this,"sort.key",B)}this.sortKey=B},$listLoaded:function(V){this._setError(false);this.selected=[];this.parseWindow(V);this.buildNavigation();hui.dom.clear(this.head);hui.dom.clear(this.body);this.rows=[];this.columns=[];var S=document.createElement("tr");var R=V.getElementsByTagName("sort");this.sortKey=null;this.sortDirection=null;if(R.length>0){this.sortKey=R[0].getAttribute("key");this.sortDirection=R[0].getAttribute("direction")}var C=V.getElementsByTagName("header");var O;for(O=0;O<C.length;O++){var D="";var G=document.createElement("th");var L=C[O].getAttribute("width");var U=C[O].getAttribute("key");var E=C[O].getAttribute("sortable")=="true";if(L&&L!=""){G.style.width=L+"%"}if(E){var K=this;G.huiIndex=O;G.onclick=function(){K.sort(this.huiIndex)};D+="sortable"}if(this.sortKey&&U==this.sortKey){D+=" sort_"+this.sortDirection}G.className=D;var N=document.createElement("span");G.appendChild(N);N.appendChild(document.createTextNode(C[O].getAttribute("title")||""));S.appendChild(G);this.columns.push({"key":U,"sortable":E,"width":L})}this.head.appendChild(S);var B=document.createDocumentFragment();var J=V.getElementsByTagName("row");for(O=0;O<J.length;O++){var F=J[O].getElementsByTagName("cell");var H=document.createElement("tr");H.setAttribute("data-index",O);var Q=J[O].getAttribute("icon");var T=J[O].getAttribute("title");var A=J[O].getAttribute("level");for(var M=0;M<F.length;M++){var I=document.createElement("td");if(F[M].getAttribute("wrap")=="false"){I.style.whiteSpace="nowrap"}if(F[M].getAttribute("vertical-align")){I.style.verticalAlign=F[M].getAttribute("vertical-align")}if(F[M].getAttribute("width")){I.style.width=F[M].getAttribute("width")+"%"}if(F[M].getAttribute("align")){I.style.textAlign=F[M].getAttribute("align")}if(F[M].getAttribute("dimmed")=="true"){I.className="hui_list_dimmed"}if(M==0&&A>1){I.style.paddingLeft=((parseInt(A)-1)*16+5)+"px"}this.parseCell(F[M],I);H.appendChild(I);if(!T){T=hui.dom.getText(F[M])}if(!Q){Q=F[M].getAttribute("icon")}}var P={id:J[O].getAttribute("id"),kind:J[O].getAttribute("kind"),icon:Q,title:T,index:O,data:this._getData(J[O])};H.dragDropInfo=P;this.addRowBehavior(H,O);B.appendChild(H);this.rows.push(P)}this.body.appendChild(B);this.fire("selectionReset")},$objectsLoaded:function(A){this._setError(false);if(A==null){}else{if(A.constructor==Array){this.setObjects(A)}else{this.setData(A)}}this.fire("selectionReset")},$sourceIsBusy:function(){this._setBusy(true)},$sourceIsNotBusy:function(){this._setBusy(false)},$sourceFailed:function(){hui.log("The source failed!");this._setError(true)},_setError:function(A){hui.setClass(this.element,"hui_list_error",A)},_setBusy:function(A){this.busy=A;window.clearTimeout(this.busytimer);if(A){var B=this.element;this.busytimer=window.setTimeout(function(){hui.addClass(B,"hui_list_busy");if(B.parentNode.className=="hui_overflow"){hui.addClass(B,"hui_list_busy_large")}},300)}else{hui.removeClass(this.element,"hui_list_busy");if(this.element.parentNode.className=="hui_overflow"){hui.removeClass(this.element,"hui_list_busy_large")}}},_wrap:function(D){var A="";var C=0;for(var B=0;B<D.length;B++){if(D[B]===" "||D[B]==="-"){C=0}else{C++}A+=D[B];if(C>10){A+="\u200B";C=0}}return A},parseCell:function(B,H){var G=B.getAttribute("icon");if(G!=null&&G!=""){H.appendChild(hui.ui.createIcon(G,16));H=hui.build("div",{parent:H,style:"margin-left: 21px"})}for(var E=0;E<B.childNodes.length;E++){var A=B.childNodes[E];if(hui.dom.isDefinedText(A)){hui.dom.addText(H,A.nodeValue)}else{if(hui.dom.isElement(A,"break")){H.appendChild(document.createElement("br"))}else{if(hui.dom.isElement(A,"icon")){var G=hui.ui.createIcon(A.getAttribute("icon"),16);if(A.getAttribute("hint")){G.setAttribute("title",A.getAttribute("hint"))}if(A.getAttribute("action")=="true"){hui.addClass(G,"hui_list_icon_action")}var D=A.getAttribute("data");if(D){G.setAttribute("data",D)}if(A.getAttribute("revealing")==="true"){hui.addClass(G,"hui_list_revealing")}H.appendChild(G)}else{if(hui.dom.isElement(A,"line")){var J=hui.build("p",{"class":"hui_list_line"});if(A.getAttribute("dimmed")=="true"){hui.addClass(J,"hui_list_dimmed")}if(A.getAttribute("minor")=="true"){hui.addClass(J,"hui_list_minor")}if(A.getAttribute("mini")=="true"){hui.addClass(J,"hui_list_mini")}H.appendChild(J);this.parseCell(A,J)}else{if(hui.dom.isElement(A,"object")){var C=hui.build("div",{"class":"object"});if(A.getAttribute("icon")){C.appendChild(hui.ui.createIcon(A.getAttribute("icon"),16))}if(A.firstChild&&A.firstChild.nodeType==hui.TEXT_NODE&&A.firstChild.nodeValue.length>0){hui.dom.addText(C,A.firstChild.nodeValue)}H.appendChild(C)}else{if(hui.dom.isElement(A,"icons")){var I=hui.build("span",{"class":"hui_list_icons"});this.parseCell(A,I);H.appendChild(I)}else{if(hui.dom.isElement(A,"button")){var F=hui.ui.Button.create({text:A.getAttribute("text"),small:true,rounded:true,data:this._getData(A)});F.click(this._buttonClick.bind(this));H.appendChild(F.getElement())}else{if(hui.dom.isElement(A,"wrap")){hui.dom.addText(H,this._wrap(hui.dom.getText(A)))}else{if(hui.dom.isElement(A,"delete")){this.parseCell(A,hui.build("del",{parent:H}))}else{if(hui.dom.isElement(A,"strong")){this.parseCell(A,hui.build("strong",{parent:H}))}else{if(hui.dom.isElement(A,"badge")){this.parseCell(A,hui.build("span",{className:"hui_list_badge",parent:H}))}}}}}}}}}}}}},_getData:function(A){var B=A.getAttribute("data");if(B){return hui.fromJSON(B)}return null},_buttonClick:function(A){var C=hui.firstParentByTag(A.getElement(),"tr");var B=this.rows[parseInt(C.getAttribute("data-index"),10)];this.fire("clickButton",{row:B,button:A})},parseWindow:function(B){var C=B.getElementsByTagName("window");if(C.length>0){var A=C[0];this.window.total=parseInt(A.getAttribute("total"));this.window.size=parseInt(A.getAttribute("size"));this.window.page=parseInt(A.getAttribute("page"))}else{this.window.total=0;this.window.size=0;this.window.page=0}},buildNavigation:function(){var C=this;var A=this.window.size>0?Math.ceil(this.window.total/this.window.size):0;if(A<2){this.navigation.style.display="none";return }this.navigation.style.display="block";var H=((this.window.page)*this.window.size+1);hui.dom.setText(this.count,(H+"-"+Math.min((this.window.page+1)*this.window.size,this.window.total)+" / "+this.window.total));var F=this.windowPageBody;F.innerHTML="";if(A<2){this.windowPage.style.display="none"}else{var G=this.buildPages(A,this.window.page);for(var E=0;E<G.length;E++){var D=G[E];if(D===""){F.appendChild(hui.build("span",{text:""}))}else{var B=document.createElement("a");B.appendChild(document.createTextNode(D+1));B.setAttribute("data-index",D);B.onmousedown=function(){C.windowPageWasClicked(this);return false};if(D==C.window.page){B.className="hui_list_selected"}F.appendChild(B)}}this.windowPage.style.display="block"}},buildPages:function(E,D){var B=[];var A=false;for(var C=0;C<E;C++){if(C<1||C>E-2||Math.abs(D-C)<5){B.push(C);A=false}else{if(!A){B.push("")}A=true}}return B},setData:function(A){this.selected=[];var B=A.window||{};this.window.total=B.total||0;this.window.size=B.size||0;this.window.page=B.page||0;this.buildNavigation();this._buildHeaders(A.headers);this._buildRows(A.rows)},_buildHeaders:function(B){hui.dom.clear(this.head);this.columns=[];var A=hui.build("tr",{parent:this.head});hui.each(B,function(D,C){var E=hui.build("th");if(D.width){E.style.width=D.width+"%"}if(D.sortable){hui.listen(E,"click",function(){this.sort(C)}.bind(this));hui.addClass(E,"sortable")}E.appendChild(hui.build("span",{text:D.title}));A.appendChild(E);this.columns.push(D)}.bind(this))},_buildRows:function(B){var A=this;hui.dom.clear(this.body);this.rows=[];if(!B){return }hui.each(B,function(E,C){var F=hui.build("tr");var D=E.icon;var H=E.title;hui.each(E.cells,function(J){var I=hui.build("td");if(J.icon){I.appendChild(hui.ui.createIcon(J.icon,16));D=D||J.icon}if(J.text){I.appendChild(document.createTextNode(J.text));H=H||J.text}F.appendChild(I)});A.body.appendChild(F);var G={id:E.id,kind:E.kind,icon:D,title:H,index:C};F.dragDropInfo=G;hui.log(this._getData(F));A.rows.push({id:E.id,kind:E.kind,icon:D,title:H,index:C,data:E.data});this.addRowBehavior(F,C)}.bind(this))},setObjects:function(I){I=I||[];this.selected=[];hui.dom.clear(this.body);this.rows=[];for(var E=0;E<I.length;E++){var J=hui.build("tr");var D=I[E];var F=null;for(var C=0;C<this.columns.length;C++){var H=hui.build("td");if(this.builder){H.appendChild(this.builder.buildColumn(this.columns[C],D))}else{var G=D[this.columns[C].key]||"";if(hui.isArray(G)){for(var B=0;B<G.length;B++){if(G[B].constructor==Object){H.appendChild(this.createObject(G[B]))}else{H.appendChild(hui.build("div",{text:G}))}}}else{if(G.constructor==Object){H.appendChild(this.createObject(G[C]))}else{hui.dom.addText(H,G);F=F==null?G:F}}}J.appendChild(H)}var A={id:D.id,kind:D.kind,title:F};J.dragDropInfo=A;this.body.appendChild(J);this.addRowBehavior(J,E);this.rows.push(D)}},createObject:function(A){var B=hui.build("div",{"class":"object"});if(A.icon){B.appendChild(hui.ui.createIcon(A.icon,16))}hui.dom.addText(B,A.text||A.name||"");return B},addRowBehavior:function(C,B){var A=this;C.onmousedown=function(F){if(A.busy){return }var D=hui.event(F);var E=D.findByClass("hui_list_icon_action");if(!E){A._rowDown(B);hui.ui.startDrag(F,C);return false}};C.ondblclick=function(D){if(A.busy){return }A._rowDoubleClick(B,D);hui.selection.clear();return false};C.onclick=function(D){if(A.busy){return }A._rowClick(B,D);return false}},changeSelection:function(A){if(!this.options.selectable){return }var C=this.body.getElementsByTagName("tr"),B;for(B=0;B<this.selected.length;B++){hui.removeClass(C[this.selected[B]],"hui_list_selected")}for(B=0;B<A.length;B++){hui.addClass(C[A[B]],"hui_list_selected")}this.selected=A;this.fire("selectionChanged",this.rows[A[0]])},_rowClick:function(B,D){D=hui.event(D);var A=D.findByClass("hui_list_icon_action");if(A){var C=A.getAttribute("data");if(C){this.fire("clickIcon",{row:this.rows[B],data:hui.fromJSON(C),node:A})}}},_rowDown:function(A){this.changeSelection([A])},_rowDoubleClick:function(A,B){B=hui.event(B);if(!B.findByClass("hui_list_icon_action")){var C=this.getFirstSelection();if(C){this.fire("listRowWasOpened",C)}}},windowPageWasClicked:function(A){var C=parseInt(A.getAttribute("data-index"));this.window.page=C;hui.ui.firePropertyChange(this,"window",this.window);hui.ui.firePropertyChange(this,"window.page",this.window.page);var B=this.windowPageBody.getElementsByTagName("a");for(var D=B.length-1;D>=0;D--){B[D].className=B[D]==A?"hui_list_selected":""}}};hui.ui.Tabs=function(D){D=D||{};this.name=D.name;this.element=hui.get(D.element);this.activeTab=-1;var A=hui.firstByClass(this.element,"hui_tabs_bar");this.bar=hui.firstByTag(A,"ul");this.tabs=[];var B=this.bar.getElementsByTagName("li");for(var C=0;C<B.length;C++){if(!hui.browser.msie){hui.firstByTag(B[C],"a").removeAttribute("href")}this.tabs.push(B[C])}this.contents=hui.byClass(this.element,"hui_tabs_tab");this.addBehavior();hui.ui.extend(this)};hui.ui.Tabs.create=function(B){B=B||{};var D=B.element=hui.build("div",{"class":"hui_tabs"});var A="hui_tabs_bar";if(B.small){A+=" hui_tabs_bar_small"}if(B.centered){A+=" hui_tabs_bar_centered"}var C=hui.build("div",{"class":A,parent:D});hui.build("ul",{parent:C});return new hui.ui.Tabs(B)};hui.ui.Tabs.prototype={addBehavior:function(){for(var A=0;A<this.tabs.length;A++){this.addTabBehavior(this.tabs[A],A)}},addTabBehavior:function(B,A){hui.listen(B,"click",function(){this.tabWasClicked(A)}.bind(this))},registerTab:function(A){A.parent=this;this.tabs.push(A)},tabWasClicked:function(A){this.activeTab=A;this.updateGUI();hui.ui.callVisible(this)},updateGUI:function(){for(var A=0;A<this.tabs.length;A++){hui.setClass(this.tabs[A],"hui_tabs_selected",A==this.activeTab);this.contents[A].style.display=A==this.activeTab?"block":"none"}},createTab:function(A){A=A||{};var B=hui.build("li",{html:"<a><span><span>"+hui.escape(A.title)+"</span></span></a>",parent:this.bar});this.addTabBehavior(B,this.tabs.length);this.tabs.push(B);var C=A.element=hui.build("div",{"class":"hui_tabs_tab"});if(A.padding>0){C.style.padding=A.padding+"px"}this.contents.push(C);this.element.appendChild(C);if(this.activeTab==-1){this.activeTab=0;hui.addClass(B,"hui_tabs_selected")}else{C.style.display="none"}return new hui.ui.Tab(A)}};hui.ui.Tab=function(A){this.name=A.name;this.element=hui.get(A.element)};hui.ui.Tab.prototype={add:function(A){this.element.appendChild(A.element)}};hui.ui.ObjectList=function(A){this.options=hui.override({key:null},A);this.name=A.name;this.element=hui.get(A.element);this.body=hui.firstByTag(this.element,"tbody");this.template=[];this.objects=[];hui.ui.extend(this)};hui.ui.ObjectList.create=function(E){E=E||{};var D=E.element=hui.build("table",{"class":"hui_objectlist",cellpadding:"0",cellspacing:"0"});if(E.template){var B="<thead><tr>";for(var A=0;A<E.template.length;A++){B+="<th>"+(E.template[A].label||"")+"</th>"}B+="</tr></thead>";D.innerHTML=B}hui.build("tbody",{parent:D});var C=new hui.ui.ObjectList(E);if(E.template){hui.each(E.template,function(F){C.registerTemplateItem(new hui.ui.ObjectList.Text(F.key))})}return C};hui.ui.ObjectList.prototype={ignite:function(){this.addObject({})},addObject:function(B,D){var C;if(this.objects.length==0||D){C=new hui.ui.ObjectList.Object(this.objects.length,B,this);this.objects.push(C);this.body.appendChild(C.getElement())}else{var A=this.objects[this.objects.length-1];hui.removeFromArray(this.objects,A);C=new hui.ui.ObjectList.Object(A.index,B,this);A.index++;this.objects.push(C);this.objects.push(A);this.body.insertBefore(C.getElement(),A.getElement())}},reset:function(){for(var B=0;B<this.objects.length;B++){var A=this.objects[B].getElement();if(!A.parentNode){hui.log("no parent for...");hui.log(A)}else{A.parentNode.removeChild(A)}}this.objects=[];this.addObject({})},addObjects:function(B){for(var A=0;A<B.length;A++){this.addObject(B[A])}},setObjects:function(A){this.reset();this.addObjects(A)},getObjects:function(C){var B=[];for(var A=0;A<this.objects.length-1;A++){B.push(this.objects[A].getData())}return B},getValue:function(){return this.getObjects()},setValue:function(A){this.setObjects(A)},registerTemplateItem:function(A){this.template.push(A)},objectDidChange:function(A){if(A.index>=this.objects.length-1){this.addObject({},true)}},getLabel:function(){return this.options.label}};hui.ui.ObjectList.Object=function(A,C,B){this.data=C;this.index=A;this.list=B;this.fields=[]};hui.ui.ObjectList.Object.prototype={getElement:function(){if(!this.element){this.element=document.createElement("tr");for(var B=0;B<this.list.template.length;B++){var C=this.list.template[B];var D=C.clone();D.object=this;this.fields.push(D);var A=document.createElement("td");if(B==0){A.className="first"}A.appendChild(D.getElement());D.setValue(this.data[C.key]);this.element.appendChild(A)}}return this.element},valueDidChange:function(){this.list.objectDidChange(this)},getData:function(){var B=this.data;for(var A=0;A<this.fields.length;A++){B[this.fields[A].key]=this.fields[A].getValue()}return B}};hui.ui.ObjectList.Text=function(A){this.key=A;this.value=null};hui.ui.ObjectList.Text.prototype={clone:function(){return new hui.ui.ObjectList.Text(this.key)},getElement:function(){var A=hui.build("input",{"class":"hui_formula_text"});var B=hui.ui.wrapInField(A);this.wrapper=new hui.ui.Input({element:A});this.wrapper.listen(this);return B},$valueChanged:function(A){this.value=A;this.object.valueDidChange()},getValue:function(){return this.value},setValue:function(A){this.value=A;this.wrapper.setValue(A)}};hui.ui.ObjectList.Select=function(A){this.key=A;this.value=null;this.options=[]};hui.ui.ObjectList.Select.prototype={clone:function(){var A=new hui.ui.ObjectList.Select(this.key);A.options=this.options;return A},getElement:function(){this.select=hui.build("select");for(var B=0;B<this.options.length;B++){this.select.options[this.select.options.length]=new Option(this.options[B].label,this.options[B].value)}var A=this;this.select.onchange=function(){A.object.valueDidChange()};return this.select},getValue:function(){return this.select.value},setValue:function(A){this.select.value=A},addOption:function(B,A){this.options.push({value:B,label:A})}};hui.ui.DropDown=function(B){this.options=hui.override({label:null,placeholder:null,url:null,source:null},B);this.name=B.name;var A=this.element=hui.get(B.element);this.inner=A.getElementsByTagName("strong")[0];this.items=B.items||[];this.index=-1;this.value=this.options.value||null;this.dirty=true;this.busy=false;hui.ui.extend(this);this._addBehavior();this._updateIndex();this._updateUI();if(this.options.url){this.options.source=new hui.ui.Source({url:this.options.url,delegate:this})}else{if(this.options.source){this.options.source.listen(this)}}};hui.ui.DropDown.create=function(A){A=A||{};A.element=hui.build("a",{"class":"hui_dropdown",href:"javascript://",html:"<span><span><strong></strong></span></span>"});return new hui.ui.DropDown(A)};hui.ui.DropDown.prototype={_addBehavior:function(){hui.ui.addFocusClass({element:this.element,"class":"hui_dropdown_focused"});hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.element,"blur",this._hideSelector.bind(this));hui.listen(this.element,"keydown",this._keyDown.bind(this))},_updateIndex:function(){this.index=-1;for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.value){this.index=A}}},_updateUI:function(){var C=this.items[this.index];if(C){var D=C.label||C.title||C.text||"";this.inner.innerHTML="";hui.dom.addText(this.inner,hui.wrap(D))}else{if(this.options.placeholder){this.inner.innerHTML="";this.inner.appendChild(hui.build("em",{text:hui.escape(this.options.placeholder)}))}else{this.inner.innerHTML=""}}if(!this.selector){return }var A=this.selector.getElementsByTagName("a");for(var B=0;B<A.length;B++){if(this.index==B){hui.addClass(A[B],"hui_selected")}else{A[B].className=""}}},_click:function(G){if(this.busy){return }hui.stop(G);this._buildSelector();var D=this.element,J=this.selector;D.focus();if(!this.items){return }var K=hui.getDocumentHeight();if(K<200){var E=hui.getLeft(this.element);hui.setStyle(this.selector,{"left":E+"px",top:"5px"})}else{var H=hui.window.getScrollTop();var F=hui.getScrollOffset(this.element).top;var C=H-F;hui.place({target:{element:this.element,vertical:1,horizontal:0},source:{element:this.selector,vertical:0,horizontal:0},top:C})}hui.setStyle(J,{visibility:"hidden",display:"block",width:""});var I=Math.min(K-hui.getTop(J)-5,200);var B=Math.max(D.clientWidth-5,100,J.clientWidth+20);var A=hui.getViewPortWidth()-hui.getLeft(D)-20;B=Math.min(B,A);hui.setStyle(J,{visibility:"visible",width:B+"px",zIndex:hui.ui.nextTopIndex(),maxHeight:I+"px"})},_keyDown:function(A){if(this.busy){return }if(this.items.length==0){return }if(A.keyCode==40){hui.stop(A);if(this.index>=this.items.length-1){this.value=this.items[0].value}else{this.value=this.items[this.index+1].value}this._updateIndex();this._updateUI();this._fireChange()}else{if(A.keyCode==38){hui.stop(A);if(this.index>0){this.index--}else{this.index=this.items.length-1}this.value=this.items[this.index].value;this._updateUI();this._fireChange()}}},selectFirst:function(){if(this.items.length>0){this.setValue(this.items[0].value)}},getValue:function(){return this.value},setValue:function(A){this.value=A;this._updateIndex();this._updateUI()},reset:function(){this.setValue(null)},getLabel:function(){return this.options.label},refresh:function(){if(this.options.source){this.options.source.refresh()}},focus:function(){try{this.element.focus()}catch(A){}},getItem:function(){if(this.index>=0){return this.items[this.index]}return 0},addItem:function(A){this.items.push(A);this.dirty=true;this._updateIndex();this._updateUI()},setItems:function(A){this.items=A;this.dirty=true;this.index=-1;this._updateIndex();this._updateUI()},$itemsLoaded:function(A){this.setItems(A)},$sourceIsBusy:function(){this.busy=true;hui.setOpacity(this.element,0.5)},$sourceIsNotBusy:function(){this.busy=false;hui.setOpacity(this.element,1)},$sourceShouldRefresh:function(){return hui.dom.isVisible(this.element)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){if(this.options.source){this.options.source.refreshFirst()}}else{this._hideSelector()}},_hideSelector:function(){if(!this.selector){return }this.selector.style.display="none"},_buildSelector:function(){if(!this.dirty||!this.items){return }if(!this.selector){this.selector=hui.build("div",{"class":"hui_dropdown_selector"});document.body.appendChild(this.selector);hui.listen(this.selector,"mousedown",function(B){hui.stop(B)})}else{this.selector.innerHTML=""}var A=this;hui.each(this.items,function(C,B){var D=hui.build("a",{href:"javascript://",text:C.label||C.title||C.text});hui.listen(D,"mousedown",function(E){hui.stop(E);A._itemClicked(C,B)});if(B==A.index){hui.addClass(D,"hui_selected")}A.selector.appendChild(D)});this.dirty=false},_itemClicked:function(B,A){this.index=A;var C=this.value!=this.items[A].value;this.value=this.items[A].value;this._updateUI();this._hideSelector();if(C){this._fireChange()}},_fireChange:function(){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)}};hui.ui.Alert=function(A){this.options=hui.override({modal:false},A);this.element=hui.get(A.element);this.name=A.name;this.body=hui.firstByClass(this.element,"hui_alert_body");this.content=hui.firstByClass(this.element,"hui_alert_content");this.emotion=this.options.emotion;this.title=hui.firstByTag(this.element,"h1");hui.ui.extend(this)};hui.ui.Alert.create=function(B){B=hui.override({title:"",text:"",emotion:null,title:null},B);var C=B.element=hui.build("div",{"class":"hui_alert"});var A=hui.build("div",{"class":"hui_alert_body",parent:C});hui.build("div",{"class":"hui_alert_content",parent:A});document.body.appendChild(C);var D=new hui.ui.Alert(B);if(B.emotion){D.setEmotion(B.emotion)}if(B.title){D.setTitle(B.title)}if(B.text){D.setText(B.text)}return D};hui.ui.Alert.prototype={show:function(){var A=hui.ui.nextAlertIndex();if(this.options.modal){hui.ui.showCurtain({widget:this,zIndex:A});A++}this.element.style.zIndex=A;this.element.style.display="block";this.element.style.top=(hui.getScrollTop()+100)+"px";hui.animate(this.element,"opacity",1,200);hui.animate(this.element,"margin-top","40px",600,{ease:hui.ease.elastic})},hide:function(){hui.animate(this.element,"opacity",0,200,{hideOnComplete:true});hui.animate(this.element,"margin-top","0px",200);hui.ui.hideCurtain(this)},setTitle:function(A){if(!this.title){this.title=hui.build("h1",{parent:this.content})}hui.dom.setText(this.title,A)},setText:function(A){if(!this.text){this.text=hui.build("p",{parent:this.content})}hui.dom.setText(this.text,A||"")},setEmotion:function(A){if(this.emotion){hui.removeClass(this.body,this.emotion)}this.emotion=A;hui.addClass(this.body,A)},update:function(A){A=A||{};this.setTitle(A.title||null);this.setText(A.text||null);this.setEmotion(A.emotion||null)},addButton:function(A){if(!this.buttons){this.buttons=hui.ui.Buttons.create({align:"right"});this.body.appendChild(this.buttons.element)}this.buttons.add(A)}};hui.ui.Button=function(A){this.options=A;this.name=A.name;this.element=hui.get(A.element);this.enabled=!hui.hasClass(this.element,"hui_button_disabled");hui.ui.extend(this);this.addBehavior()};hui.ui.Button.create=function(F){F=hui.override({text:"",highlighted:false,enabled:true},F);var D="hui_button"+(F.highlighted?" hui_button_highlighted":"");if(F.small){D+=" hui_button_small"}if(!F.enabled){D+=" hui_button_disabled"}var A=F.element=hui.build("a",{"class":D,href:"javascript://"});var E=document.createElement("span");A.appendChild(E);var C=document.createElement("span");E.appendChild(C);if(F.icon){var B=hui.build("em",{"class":"hui_button_icon",style:"background-image:url("+hui.ui.getIconUrl(F.icon,16)+")"});if(!F.text||F.text.length==0){hui.addClass(B,"hui_button_icon_notext")}C.appendChild(B)}if(F.text&&F.text.length>0){hui.dom.addText(C,F.text)}if(F.title&&F.title.length>0){hui.dom.addText(C,F.title)}return new hui.ui.Button(F)};hui.ui.Button.prototype={addBehavior:function(){var A=this;hui.listen(this.element,"mousedown",function(B){hui.stop(B)});hui.listen(this.element,"click",function(B){hui.stop(B);A.clicked()})},clicked:function(){if(this.enabled){if(this.options.confirm){hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this.fireClick.bind(this)})}else{this.fireClick()}}else{this.element.blur()}},fireClick:function(){this.fire("click");if(this.options.submit){var A=hui.ui.getAncestor(this,"hui_formula");if(A){A.submit()}}},click:function(A){if(A){this.listen({$click:A});return this}else{this.clicked()}},focus:function(){this.element.focus()},onClick:function(A){this.listen({$click:A})},setEnabled:function(A){this.enabled=A;this.updateUI()},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)},setHighlighted:function(A){hui.setClass(this.element,"hui_button_highlighted",A)},updateUI:function(){hui.setClass(this.element,"hui_button_disabled",!this.enabled)},setText:function(A){hui.dom.setText(this.element.getElementsByTagName("span")[1],A)},getData:function(){return this.options.data}};hui.ui.Buttons=function(A){this.name=A.name;this.element=hui.get(A.element);this.body=hui.firstByClass(this.element,"hui_buttons_body");hui.ui.extend(this)};hui.ui.Buttons.create=function(B){B=hui.override({top:0},B);var A=B.element=hui.build("div",{"class":"hui_buttons"});if(B.align=="right"){hui.addClass(A,"hui_buttons_right")}if(B.align=="center"){hui.addClass(A,"hui_buttons_center")}if(B.top>0){A.style.paddingTop=B.top+"px"}hui.build("div",{"class":"hui_buttons_body",parent:A});return new hui.ui.Buttons(B)};hui.ui.Buttons.prototype={add:function(A){this.body.appendChild(A.element);return this}};hui.ui.Selection=function(A){this.options=hui.override({value:null},A);this.element=hui.get(A.element);this.name=A.name;this.items=[];this.subItems=[];this.busy=0;this.selection=null;if(A.items&&A.items.length>0){for(var C=0;C<A.items.length;C++){var D=A.items[C];this.items.push(D);var B=hui.get(D.id);D.element=B;this.addItemBehavior(B,D)}this.selection=this.getSelectionWithValue(this.options.value);this.updateUI()}else{if(this.options.value!=null){this.selection={value:this.options.value}}}hui.ui.extend(this)};hui.ui.Selection.create=function(A){A=hui.override({width:0},A);var B=A.element=hui.build("div",{"class":"hui_selection"});if(A.width>0){B.style.width=A.width+"px"}return new hui.ui.Selection(A)};hui.ui.Selection.prototype={getValue:function(){return this.selection},valueForProperty:function(A){if(A==="value"){return this.selection?this.selection.value:null}else{if(A==="kind"){return this.selection?this.selection.kind:null}}return undefined},setValue:function(B){var A=this.getSelectionWithValue(B);if(A===null){this.selection=null}else{this.selection=A;this.kind=A.kind}this.updateUI();this.fireChange()},getSelectionWithValue:function(D){var C;for(C=0;C<this.items.length;C++){if(this.items[C].value==D){return this.items[C]}}for(C=0;C<this.subItems.length;C++){var A=this.subItems[C].items;for(var B=0;B<A.length;B++){if(A[B].value==D){return A[B]}}}return null},selectFirst:function(){hui.log("selecting first");var C;for(C=0;C<this.items.length;C++){this.changeSelection(this.items[C]);return }for(C=0;C<this.subItems.length;C++){var A=this.subItems[C].items;for(var B=0;B<A.length;B++){this.changeSelection(A[B]);return }}},reset:function(){this.setValue(null)},updateUI:function(){var A;for(A=0;A<this.items.length;A++){hui.setClass(this.items[A].element,"hui_selected",this.isSelection(this.items[A]))}for(A=0;A<this.subItems.length;A++){this.subItems[A].updateUI()}},changeSelection:function(B){for(var A=0;A<this.subItems.length;A++){this.subItems[A].selectionChanged(this.selection,B)}this.selection=B;this.updateUI();this.fireChange()},fireChange:function(){this.fire("selectionChanged",this.selection);this.fireProperty("value",this.selection?this.selection.value:null);this.fireProperty("kind",this.selection?this.selection.kind:null);for(var A=0;A<this.subItems.length;A++){this.subItems[A].parentValueChanged()}},registerItems:function(A){A.parent=this;this.subItems.push(A)},addItemBehavior:function(B,A){hui.listen(B,"click",function(){this.itemWasClicked(A)}.bind(this));hui.listen(B,"dblclick",function(C){hui.stop(C);this.itemWasDoubleClicked(A)}.bind(this));B.dragDropInfo=A},setObjects:function(A){this.items=[];hui.each(A,function(D){this.items.push(D);var C=hui.build("div",{"class":"hui_selection_item"});D.element=C;this.element.appendChild(C);var B=hui.build("span",{"class":"hui_selection_label",text:D.title});if(D.icon){C.appendChild(hui.ui.createIcon(D.icon,16))}C.appendChild(B);hui.listen(C,"click",function(){this.itemWasClicked(D)}.bind(this));hui.listen(C,"dblclick",function(E){hui.stop(E);this.itemWasDoubleClicked(D)}.bind(this))}.bind(this))},isSelection:function(B){if(this.selection===null){return false}var A=B.value==this.selection.value;if(this.selection.kind){A=A&&B.kind==this.selection.kind}return A},itemWasClicked:function(A){if(this.busy>0){return }this.changeSelection(A)},itemWasDoubleClicked:function(A){if(this.busy>0){return }this.fire("selectionWasOpened",A)},_setBusy:function(A){this.busy+=A?1:-1;window.clearTimeout(this.busytimer);if(this.busy>0){var B=this.element;this.busytimer=window.setTimeout(function(){hui.addClass(B,"hui_selection_busy")},300)}else{hui.removeClass(this.element,"hui_selection_busy")}},_checkValue:function(){if(!this.selection){return }var A=this.getSelectionWithValue(this.selection.value);if(!A){hui.log("Value not found: "+this.selection.value);if(!this.busy){this.selectFirst()}else{hui.log("Will not select first since im still busy")}}},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.Selection.Items=function(A){this.options=hui.override({source:null},A);this.element=hui.get(A.element);this.title=hui.get(this.element.id+"_title");this.name=A.name;this.disclosed={};this.parent=null;this.items=[];hui.ui.extend(this);if(this.options.source){this.options.source.listen(this)}};hui.ui.Selection.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$objectsLoaded:function(A){this.$itemsLoaded(A)},$itemsLoaded:function(A){this.items=[];this.element.innerHTML="";this.buildLevel(this.element,A,0,true);if(this.title){this.title.style.display=this.items.length>0?"block":"none"}this.parent.updateUI();this.parent._checkValue()},$sourceIsBusy:function(){this.parent._setBusy(true)},$sourceIsNotBusy:function(){this.parent._setBusy(false)},buildLevel:function(D,B,E,C){if(!B){return }var A=this.isHierarchy(B);var F=hui.build("div",{"class":"hui_selection_level",style:(C?"display:block":"display:none"),parent:D});hui.each(B,function(M){if(M.type=="title"){hui.build("div",{"class":"hui_selection_title",html:"<span>"+M.title+"</span>",parent:F});return }var K=M.children&&M.children.length>0;var H=E*16+6;if(!A&&E>0||A&&!K){H+=13}var I=hui.build("div",{"class":"hui_selection_item"});I.style.paddingLeft=H+"px";if(M.badge){I.appendChild(hui.build("strong",{"class":"hui_selection_badge",text:M.badge}))}var L=false;if(A&&K){var N=this;L=this.disclosed[M.value];var O=this.disclosed[M.value]?"hui_disclosure hui_disclosure_open":"hui_disclosure";var J=hui.build("span",{"class":O,parent:I});hui.listen(J,"click",function(Q){hui.stop(Q);N.toggle(J,M)})}var P=hui.build("span",{"class":"hui_selection_label",text:M.title});if(M.icon){I.appendChild(hui.build("span",{"class":"hui_icon_1",style:"background-image: url("+hui.ui.getIconUrl(M.icon,16)+")"}))}I.appendChild(P);hui.listen(I,"click",function(Q){this.parent.itemWasClicked(M)}.bind(this));hui.listen(I,"dblclick",function(Q){hui.stop(Q);this.parent.itemWasDoubleClicked(M)}.bind(this));F.appendChild(I);var G={title:M.title,icon:M.icon,badge:M.badge,kind:M.kind,element:I,value:M.value};I.dragDropInfo=G;this.items.push(G);this.buildLevel(F,M.children,E+1,L)}.bind(this))},toggle:function(B,A){if(hui.hasClass(B,"hui_disclosure_open")){this.disclosed[A.value]=false;hui.getNext(B.parentNode).style.display="none";hui.removeClass(B,"hui_disclosure_open")}else{this.disclosed[A.value]=true;hui.getNext(B.parentNode).style.display="block";hui.addClass(B,"hui_disclosure_open")}},isHierarchy:function(A){if(!A){return false}for(var B=0;B<A.length;B++){if(A[B]!==null&&A[B].children&&A[B].children.length>0){return true}}return false},getValue:function(){if(this.parent.selection==null){return null}for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.parent.selection.value){return this.items[A]}}return null},updateUI:function(){for(var A=0;A<this.items.length;A++){hui.setClass(this.items[A].element,"hui_selected",this.parent.isSelection(this.items[A]))}},selectionChanged:function(B,A){for(var C=0;C<this.items.length;C++){var D=this.items[C].value;if(D==A.value){this.fireProperty("value",A.value);return }}this.fireProperty("value",null)},parentValueChanged:function(){for(var A=0;A<this.items.length;A++){if(this.parent.isSelection(this.items[A])){this.fireProperty("value",this.items[A].value);return }}this.fireProperty("value",null)}};hui.ui.Toolbar=function(A){this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Toolbar.create=function(A){A=A||{};A.element=hui.build("div",{"class":A.labels?"hui_toolbar hui_toolbar_nolabels":"hui_toolbar"});return new hui.ui.Toolbar(A)};hui.ui.Toolbar.prototype={add:function(A){this.element.appendChild(A.getElement())},addDivider:function(){this.element.appendChild(hui.build("span",{"class":"hui_divider"}))},setSelection:function(B){var D=hui.ui.getDescendants(this);for(var A=0;A<D.length;A++){var C=D[A];if(C.setSelected){C.setSelected(C.key==B)}}}};hui.ui.RevealingToolbar=function(A){this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.RevealingToolbar.create=function(A){A=A||{};A.element=hui.build("div",{className:"hui_revealing_toolbar",style:"display:none",parent:document.body});var B=new hui.ui.RevealingToolbar(A);B.setToolbar(hui.ui.Toolbar.create());return B};hui.ui.RevealingToolbar.prototype={setToolbar:function(A){this.toolbar=A;this.element.appendChild(A.getElement())},getToolbar:function(){return this.toolbar},show:function(A){this.element.style.display="";hui.animate(this.element,"height","58px",A?0:600,{ease:hui.ease.slowFastSlow})},hide:function(){hui.animate(this.element,"height","0px",500,{ease:hui.ease.slowFastSlow,hideOnComplete:true})}};hui.ui.Toolbar.Icon=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.key=A.key;this.enabled=!hui.hasClass(this.element,"hui_toolbar_icon_disabled");this.element.tabIndex=this.enabled?0:-1;this.icon=hui.firstByClass(this.element,"hui_icon");if(!hui.browser.msie){this.element.removeAttribute("href")}hui.ui.extend(this);this.addBehavior()};hui.ui.Toolbar.Icon.create=function(B){var C=B.element=hui.build("a",{"class":"hui_toolbar_icon"});var E=hui.build("span",{"class":"hui_icon",style:"background-image: url("+hui.ui.getIconUrl(B.icon,32)+")"});var A=hui.build("span",{"class":"hui_toolbar_inner_icon",parent:C});var D=hui.build("span",{"class":"hui_toolbar_inner_icon",parent:A});var F=hui.build("strong",{text:B.title});if(B.overlay){hui.build("span",{"class":"hui_icon_overlay",parent:E,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+B.overlay,32)+")"})}D.appendChild(E);D.appendChild(F);return new hui.ui.Toolbar.Icon(B)};hui.ui.Toolbar.Icon.prototype={addBehavior:function(){var A=this;this.element.onclick=function(){A.wasClicked()}},setEnabled:function(A){this.enabled=A;this.element.tabIndex=A?0:-1;hui.setClass(this.element,"hui_toolbar_icon_disabled",!this.enabled)},disable:function(){this.setEnabled(false)},enable:function(){this.setEnabled(true)},setOverlay:function(A){var C=hui.firstByClass(this.element,"hui_icon_overlay");if(C&&!A){C.style.backgroundImage=""}else{if(C&&A){C.style.backgroundImage="url('"+hui.ui.getIconUrl("overlay/"+A,32)+"')"}else{if(A){var B=hui.firstByClass(this.element,"hui_icon");hui.build("span",{"class":"hui_icon_overlay",parent:B,style:"background-image: url("+hui.ui.getIconUrl("overlay/"+A,32)+")"})}}}},setSelected:function(A){if(A){this.element.blur()}hui.setClass(this.element,"hui_toolbar_icon_selected",A)},wasClicked:function(){if(this.enabled){if(this.options.confirm){hui.ui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this.fireClick.bind(this)})}else{this.fireClick()}}},fireClick:function(){hui.ui.callDelegates(this,"toolbarIconWasClicked");hui.ui.callDelegates(this,"click")}};hui.ui.Toolbar.SearchField=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.field=hui.firstByTag(this.element,"input");this.value=this.field.value;hui.ui.extend(this);this.addBehavior()};hui.ui.Toolbar.SearchField.create=function(A){A=A||{};A.element=hui.build("div",{"class":A.adaptive?"hui_toolbar_search hui_toolbar_search_adaptive":"hui_toolbar_search",html:'<div class="hui_searchfield"><strong class="hui_searchfield_button"></strong><div><div><input type="text"/></div></div></div><span>'+hui.escape(A.title)+"</span>"});return new hui.ui.Toolbar.SearchField(A)};hui.ui.Toolbar.SearchField.prototype={getValue:function(){return this.field.value},addBehavior:function(){var A=this;this.field.onkeyup=function(){A.fieldChanged()};if(!this.options.adaptive){this.field.onfocus=function(){hui.animate(this,"width","120px",500,{ease:hui.ease.slowFastSlow})};this.field.onblur=function(){hui.animate(this,"width","80px",500,{ease:hui.ease.slowFastSlow})}}},fieldChanged:function(){if(this.field.value!=this.value){this.value=this.field.value;hui.ui.callDelegates(this,"valueChanged");hui.ui.firePropertyChange(this,"value",this.value)}}};hui.ui.Toolbar.Badge=function(A){this.element=hui.get(A.element);this.name=A.name;this.label=hui.firstByTag(this.element,"strong");this.text=hui.firstByTag(this.element,"span");hui.ui.extend(this)};hui.ui.Toolbar.Badge.prototype={setLabel:function(A){hui.dom.setText(this.label,A)},setText:function(A){hui.dom.setText(this.text,A)}};hui.ui.ImagePicker=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);this.images=[];this.object=null;this.thumbnailsLoaded=false;hui.ui.extend(this);this.addBehavior()};hui.ui.ImagePicker.prototype={addBehavior:function(){this.element.onclick=this.showPicker.bind(this)},setObject:function(A){this.object=A;this.updateUI()},getObject:function(){return this.object},reset:function(){this.object=null;this.updateUI()},updateUI:function(){if(this.object==null){this.element.style.backgroundImage=""}else{var A=hui.ui.resolveImageUrl(this,this.object,48,48);this.element.style.backgroundImage="url("+A+")"}},showPicker:function(){if(!this.picker){var B=this;this.picker=hui.ui.BoundPanel.create();this.content=hui.build("div",{"class":"hui_imagepicker_thumbs"});var C=hui.ui.Buttons.create({align:"right"});var D=hui.ui.Button.create({text:"Luk",highlighted:true});D.listen({$click:function(){B.hidePicker()}});var A=hui.ui.Button.create({text:"Fjern"});A.listen({$click:function(){B.setObject(null);B.hidePicker()}});C.add(A).add(D);this.picker.add(this.content);this.picker.add(C)}this.picker.position(this.element);this.picker.show();if(!this.thumbnailsLoaded){this.updateImages();this.thumbnailsLoaded=true}},hidePicker:function(){this.picker.hide()},updateImages:function(){var A=this;hui.request({onSuccess:function(B){A.parse(B.responseXML)},url:this.options.source})},parse:function(G){this.content.innerHTML="";var A=G.getElementsByTagName("image");var D=this;for(var F=0;F<A.length;F++){var H=A[F].getAttribute("id");var C={id:A[F].getAttribute("id")};var E=hui.ui.resolveImageUrl(this,C,48,48);var B=hui.build("div",{"class":"hui_imagepicker_thumbnail",style:"background-image:url("+E+")"});B.huiObject={"id":H};B.onclick=function(){D.setObject(this.huiObject);D.hidePicker()};this.content.appendChild(B)}}};hui.ui.BoundPanel=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.visible=false;this.content=hui.firstByClass(this.element,"hui_boundpanel_content");this.arrow=hui.firstByClass(this.element,"hui_boundpanel_arrow");this.arrowWide=32;this.arrowNarrow=18;if(A.variant=="light"){this.arrowWide=23;this.arrowNarrow=12}hui.ui.extend(this)};hui.ui.BoundPanel.create=function(A){A=hui.override({name:null,top:0,left:0,width:null,padding:null,modal:false},A);var B='<div class="hui_boundpanel_arrow"></div><div class="hui_boundpanel_top"><div><div></div></div></div><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_body"><div class="hui_boundpanel_content" style="';if(A.width){B+="width:"+A.width+"px;"}if(A.padding){B+="padding:"+A.padding+"px;"}B+='"></div></div></div></div><div class="hui_boundpanel_bottom"><div><div></div></div></div>';A.element=hui.build("div",{"class":A.variant?"hui_boundpanel hui_boundpanel_"+A.variant:"hui_boundpanel",style:"display:none;zIndex:"+hui.ui.nextPanelIndex()+";top:"+A.top+"px;left:"+A.left+"px",html:B,parent:document.body});return new hui.ui.BoundPanel(A)};hui.ui.BoundPanel.prototype={toggle:function(){if(!this.visible){this.show()}else{this.hide()}},show:function(){if(this.visible){return }if(this.options.target){this.position(hui.ui.get(this.options.target))}if(hui.browser.opacity){hui.setOpacity(this.element,0)}var A;if(this.relativePosition=="left"){A=false;this.element.style.marginLeft="30px"}else{if(this.relativePosition=="right"){A=false;this.element.style.marginLeft="-30px"}else{if(this.relativePosition=="top"){A=true;this.element.style.marginTop="30px"}else{if(this.relativePosition=="bottom"){A=true;this.element.style.marginTop="-30px"}}}}hui.setStyle(this.element,{visibility:"hidden",display:"block"});this.element.style.visibility="visible";this.element.style.display="block";var B=hui.ui.nextPanelIndex();this.element.style.zIndex=B;hui.ui.callVisible(this);if(hui.browser.opacity){hui.animate(this.element,"opacity",1,400,{ease:hui.ease.fastSlow})}hui.animate(this.element,A?"margin-top":"margin-left","0px",800,{ease:hui.ease.bounce});this.visible=true;if(this.options.modal){hui.ui.showCurtain({widget:this,zIndex:B-1,color:"auto"})}},$curtainWasClicked:function(){hui.ui.hideCurtain(this);this.hide()},hide:function(){if(!this.visible){return }if(hui.browser.msie){this.element.style.display="none"}else{hui.animate(this.element,"opacity",0,300,{ease:hui.ease.slowFast,hideOnComplete:true})}hui.ui.callVisible(this);this.visible=false},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},addSpace:function(A){this.add(hui.build("div",{style:"font-size:0px;height:"+A+"px"}))},getDimensions:function(){var B,A;if(this.element.style.display=="none"){this.element.style.visibility="hidden";this.element.style.display="block";B=this.element.clientWidth;A=this.element.clientHeight;this.element.style.display="none";this.element.style.visibility=""}else{B=this.element.clientWidth;A=this.element.clientHeight}return{width:B,height:A}},position:function(L){if(L.getElement){L=L.getElement()}L=hui.get(L);var A={left:hui.getLeft(L),top:hui.getTop(L)};var Q=hui.getScrollOffset(L);var N={left:hui.getScrollLeft(),top:hui.getScrollTop()};var B=this.getDimensions();var O=hui.getViewPortWidth();var E=hui.getViewPortHeight();var H=A.left-N.left+hui.getScrollLeft();var D=L.clientWidth||L.offsetWidth;var I=L.clientHeight||L.offsetHeight;var F,K,G,J;var R={top:A.top-N.top-(Q.top-N.top)};var C=(A.top-N.top+Q.top)/E;C=R.top/E;hui.log(C);hui.log(hui.toJSON({nodeOffset:A}));hui.log(hui.toJSON({nodeScrollOffset:Q,windowScrollOffset:N}));if(C<0.1){this.relativePosition="top";this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_top";if(this.options.variant=="light"){K=this.arrowNarrow*-1+1}else{K=this.arrowNarrow*-1+2}G=Math.min(O-B.width-3,Math.max(3,H+(D/2)-((B.width)/2)));F=(H+D/2)-G-this.arrowNarrow;J=A.top+I+8-(Q.top-N.top)}else{if(C>0.9){this.relativePosition="bottom";this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_bottom";if(this.options.variant=="light"){K=B.height-2}else{K=B.height-6}G=Math.min(O-B.width-3,Math.max(3,H+(D/2)-((B.width)/2)));F=(H+D/2)-G-this.arrowNarrow;J=A.top-B.height-5-(Q.top-N.top)}else{if((H+D/2)/O<0.5){this.relativePosition="left";G=H+D+10;this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_left";J=A.top+(I-B.height)/2;J-=(Q.top-N.top);var M=N.top+3;var P=N.top+(E-B.height)-3;J=Math.min(Math.max(J,M),P);K=A.top-J;K-=(Q.top-N.top);if(this.options.variant=="light"){F=-11;K+=2}else{F=-14}}else{this.relativePosition="right";G=H-B.width-10;this.arrow.className="hui_boundpanel_arrow hui_boundpanel_arrow_right";J=A.top+(I-B.height)/2;J-=(Q.top-N.top);var M=N.top+3;var P=N.top+(E-B.height)-3;J=Math.min(Math.max(J,M),P);K=A.top-J;K-=(Q.top-N.top);if(this.options.variant=="light"){F=B.width-1;K+=2}else{F=B.width-4}}}}this.arrow.style.marginTop=K+"px";this.arrow.style.marginLeft=F+"px";if(this.visible){hui.animate(this.element,"top",J+"px",500,{ease:hui.ease.fastSlow});hui.animate(this.element,"left",G+"px",500,{ease:hui.ease.fastSlow})}else{this.element.style.top=J+"px";this.element.style.left=G+"px"}}};hui.ui.ImageViewer=function(A){this.options=hui.override({maxWidth:800,maxHeight:600,perimeter:100,sizeSnap:100,margin:0,ease:hui.ease.slowFastSlow,easeEnd:hui.ease.bounce,easeAuto:hui.ease.slowFastSlow,easeReturn:hui.ease.cubicInOut,transition:400,transitionEnd:1000,transitionReturn:300},A);this.element=hui.get(A.element);this.box=this.options.box;this.viewer=hui.firstByClass(this.element,"hui_imageviewer_viewer");this.innerViewer=hui.firstByClass(this.element,"hui_imageviewer_inner_viewer");this.status=hui.firstByClass(this.element,"hui_imageviewer_status");this.previousControl=hui.firstByClass(this.element,"hui_imageviewer_previous");this.controller=hui.firstByClass(this.element,"hui_imageviewer_controller");this.nextControl=hui.firstByClass(this.element,"hui_imageviewer_next");this.playControl=hui.firstByClass(this.element,"hui_imageviewer_play");this.closeControl=hui.firstByClass(this.element,"hui_imageviewer_close");this.text=hui.firstByClass(this.element,"hui_imageviewer_text");this.dirty=false;this.width=600;this.height=460;this.index=0;this.playing=false;this.name=A.name;this.images=[];this.box.listen(this);this.addBehavior();hui.ui.extend(this)};hui.ui.ImageViewer.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_imageviewer",html:'<div class="hui_imageviewer_viewer"><div class="hui_imageviewer_inner_viewer"></div></div><div class="hui_imageviewer_text"></div><div class="hui_imageviewer_status"></div><div class="hui_imageviewer_controller"><div><div><a class="hui_imageviewer_previous"></a><a class="hui_imageviewer_play"></a><a class="hui_imageviewer_next"></a><a class="hui_imageviewer_close"></a></div></div></div>'});var C=hui.ui.Box.create({absolute:true,modal:true,closable:true});C.add(B);C.addToDocument();A.box=C;return new hui.ui.ImageViewer(A)};hui.ui.ImageViewer.prototype={addBehavior:function(){var A=this;this.nextControl.onclick=function(){A.next(true)};this.previousControl.onclick=function(){A.previous(true)};this.playControl.onclick=function(){A.playOrPause()};this.closeControl.onclick=this.hide.bind(this);hui.listen(this.viewer,"click",this.zoom.bind(this));this.timer=function(){A.next(false)};this.keyListener=function(B){B=hui.event(B);if(B.rightKey){A.next(true)}else{if(B.leftKey){A.previous(true)}else{if(B.escapeKey){A.hide()}else{if(B.returnKey){A.playOrPause()}}}}},hui.listen(this.viewer,"mousemove",this.mouseMoveEvent.bind(this));hui.listen(this.controller,"mouseover",function(){A.overController=true});hui.listen(this.controller,"mouseout",function(){A.overController=false});hui.listen(this.viewer,"mouseout",function(B){if(!hui.ui.isWithin(B,this.viewer)){A.hideController()}}.bind(this))},mouseMoveEvent:function(){window.clearTimeout(this.ctrlHider);if(this.shouldShowController()){this.ctrlHider=window.setTimeout(this.hideController.bind(this),2000);if(hui.browser.msie){this.controller.show()}else{hui.ui.fadeIn(this.controller,200)}}},hideController:function(){if(!this.overController){if(hui.browser.msie){this.controller.hide()}else{hui.ui.fadeOut(this.controller,500)}}},zoom:function(D){var A=this.images[this.index];if(A.width<=this.width&&A.height<=this.height){return }if(!this.zoomer){this.zoomer=hui.build("div",{"class":"hui_imageviewer_zoomer",style:"width:"+this.viewer.clientWidth+"px;height:"+this.viewer.clientHeight+"px"});this.element.insertBefore(this.zoomer,hui.firstByTag(this.element,"*"));hui.listen(this.zoomer,"mousemove",this.zoomMove.bind(this));hui.listen(this.zoomer,"click",function(){this.style.display="none"})}this.pause();var C=this.getLargestSize({width:2000,height:2000},A);var B=hui.ui.resolveImageUrl(this,A,C.width,C.height);this.zoomer.innerHTML='<div style="width:'+C.width+"px;height:"+C.height+'px;"><img src="'+B+'"/></div>';this.zoomer.style.display="block";this.zoomInfo={width:C.width,height:C.height};this.zoomMove(D)},zoomMove:function(B){B=new hui.Event(B);if(!this.zoomInfo){return }var C={left:hui.getLeft(this.zoomer),top:hui.getTop(this.zoomer)};var A=(B.getLeft()-C.left)/this.zoomer.clientWidth*(this.zoomInfo.width-this.zoomer.clientWidth);var D=(B.getTop()-C.top)/this.zoomer.clientHeight*(this.zoomInfo.height-this.zoomer.clientHeight);this.zoomer.scrollLeft=A;this.zoomer.scrollTop=D},getLargestSize:function(A,B){if(B.width<=A.width&&B.height<=A.height){return{width:B.width,height:B.height}}else{if(A.width/A.height>B.width/B.height){return{width:Math.round(A.height/B.height*B.width),height:A.height}}else{if(A.width/A.height<B.width/B.height){return{width:A.width,height:Math.round(A.width/B.width*B.height)}}else{return{width:A.width,height:A.height}}}}},calculateSize:function(){var A=this.options.sizeSnap;var F=hui.getViewPortWidth()-this.options.perimeter;F=Math.floor(F/A)*A;F=Math.min(F,this.options.maxWidth);var B=hui.getViewPortHeight()-this.options.perimeter;B=Math.floor(B/A)*A;B=Math.min(B,this.options.maxHeight);var E=0;var D=0;for(var C=0;C<this.images.length;C++){var G=this.getLargestSize({width:F,height:B},this.images[C]);E=Math.max(E,G.width);D=Math.max(D,G.height)}B=Math.floor(Math.min(B,D));F=Math.floor(Math.min(F,E));if(F!=this.width||B!=this.height){this.width=F;this.height=B;this.dirty=true}},adjustSize:function(){},showById:function(B){for(var A=0;A<this.images.length;A++){if(this.images[A].id==B){this.show(A);break}}},show:function(A){this.index=A||0;this.calculateSize();this.updateUI();var B=this.options.margin;hui.setStyle(this.element,{width:(this.width+B)+"px",height:(this.height+B*2-1)+"px"});hui.setStyle(this.viewer,{width:(this.width+B)+"px",height:(this.height-1)+"px"});hui.setStyle(this.innerViewer,{width:((this.width+B)*this.images.length)+"px",height:(this.height-1)+"px"});hui.setStyle(this.controller,{marginLeft:((this.width-180)/2+B*0.5)+"px",display:"none"});this.box.show();this.goToImage(false,0,false);hui.listen(document,"keydown",this.keyListener)},hide:function(A){this.pause();this.box.hide();hui.unListen(document,"keydown",this.keyListener)},$boxCurtainWasClicked:function(){this.hide()},$boxWasClosed:function(){this.hide()},updateUI:function(){if(this.dirty){this.innerViewer.innerHTML="";for(var B=0;B<this.images.length;B++){var A=hui.build("div",{"class":"hui_imageviewer_image"});hui.setStyle(A,{"width":(this.width+this.options.margin)+"px","height":(this.height-1)+"px"});this.innerViewer.appendChild(A)}if(this.shouldShowController()){this.controller.style.display="block"}else{this.controller.style.display="none"}this.dirty=false;this.preload()}},shouldShowController:function(){return this.images.length>1},goToImage:function(C,D,B){if(C){if(D>1){hui.animate(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),Math.min(D*this.options.transitionReturn,2000),{ease:this.options.easeReturn})}else{var A=this.index==0||this.index==this.images.length-1;var F=(A?this.options.easeEnd:this.options.ease);if(!B){F=this.options.easeAuto}hui.animate(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),(A?this.options.transitionEnd:this.options.transition),{ease:F})}}else{this.viewer.scrollLeft=this.index*(this.width+this.options.margin)}var E=this.images[this.index].text;if(E){this.text.innerHTML=E;this.text.style.display="block"}else{this.text.innerHTML="";this.text.style.display="none"}},clearImages:function(){this.images=[];this.dirty=true},addImages:function(A){for(var B=0;B<A.length;B++){this.addImage(A[B])}},addImage:function(A){this.images.push(A);this.dirty=true},play:function(){if(!this.interval){this.interval=window.setInterval(this.timer,6000)}this.next(false);this.playing=true;this.playControl.className="hui_imageviewer_pause"},pause:function(){window.clearInterval(this.interval);this.interval=null;this.playControl.className="hui_imageviewer_play";this.playing=false},playOrPause:function(){if(this.playing){this.pause()}else{this.play()}},resetPlay:function(){if(this.playing){window.clearInterval(this.interval);this.interval=window.setInterval(this.timer,6000)}},previous:function(A){var B=1;this.index--;if(this.index<0){this.index=this.images.length-1;B=this.images.length-1}this.goToImage(true,B,A);this.resetPlay()},next:function(A){var B=1;this.index++;if(this.index==this.images.length){this.index=0;B=this.images.length-1}this.goToImage(true,B,A);this.resetPlay()},preload:function(){var B=new hui.Preloader();B.addImages(hui.ui.context+"hui/gfx/imageviewer_controls.png");var A=this;B.setDelegate({allImagesDidLoad:function(){A.preloadImages()}});B.load()},preloadImages:function(){var A=new hui.Preloader();A.setDelegate(this);for(var C=0;C<this.images.length;C++){var B=hui.ui.resolveImageUrl(this,this.images[C],this.width,this.height);if(B!==null){A.addImages(B)}}this.status.innerHTML="0%";this.status.style.display="";A.load(this.index)},allImagesDidLoad:function(){this.status.style.display="none"},imageDidLoad:function(C,D,B){this.status.innerHTML=Math.round(C/D*100)+"%";var A=hui.ui.resolveImageUrl(this,this.images[B],this.width,this.height);A=A.replace(/&amp;/g,"&");this.innerViewer.childNodes[B].style.backgroundImage="url('"+A+"')";hui.setClass(this.innerViewer.childNodes[B],"hui_imageviewer_image_abort",false);hui.setClass(this.innerViewer.childNodes[B],"hui_imageviewer_image_error",false)},imageDidGiveError:function(B,C,A){hui.setClass(this.innerViewer.childNodes[A],"hui_imageviewer_image_error",true)},imageDidAbort:function(B,C,A){hui.setClass(this.innerViewer.childNodes[A],"hui_imageviewer_image_abort",true)}};hui.ui.Picker=function(A){A=this.options=hui.override({itemWidth:100,itemHeight:150,itemsVisible:null,shadow:true,valueProperty:"value"},A);this.element=hui.get(A.element);this.name=A.name;this.container=hui.firstByClass(this.element,"hui_picker_container");this.content=hui.firstByClass(this.element,"hui_picker_content");this.title=hui.firstByClass(this.element,"hui_picker_title");this.objects=[];this.selected=null;this.value=null;this.addBehavior();hui.ui.extend(this)};hui.ui.Picker.create=function(A){A=hui.override({shadow:true},A);A.element=hui.build("div",{"class":"hui_picker",html:'<div class="hui_picker_top"><div><div></div></div></div><div class="hui_picker_middle"><div class="hui_picker_middle">'+(A.title?'<div class="hui_picker_title">'+A.title+"</div>":"")+'<div class="hui_picker_container"><div class="hui_picker_content"></div></div></div></div><div class="hui_picker_bottom"><div><div></div></div></div>'});if(A.shadow==true){hui.addClass(A.element,"hui_picker_shadow")}return new hui.ui.Picker(A)};hui.ui.Picker.prototype={addBehavior:function(){var A=this;hui.listen(this.content,"mousedown",function(B){A.startDrag(B);return false})},setObjects:function(A){this.selected=null;this.objects=A||[];this.updateUI()},setValue:function(A){this.value=A;this.updateSelection()},getValue:function(){return this.value},reset:function(){this.value=null;this.updateSelection()},updateUI:function(){var A=this,B;this.content.innerHTML="";this.container.scrollLeft=0;if(this.options.itemsVisible){B=this.options.itemsVisible*(this.options.itemWidth+14)}else{B=this.container.clientWidth}hui.setStyle(this.container,{width:B+"px",height:(this.options.itemHeight+10)+"px"});this.content.style.width=(this.objects.length*(this.options.itemWidth+14))+"px";this.content.style.height=(this.options.itemHeight+10)+"px";hui.each(this.objects,function(C,D){var E=hui.build("div",{"class":"hui_picker_item",title:C.title});if(A.value!=null&&C[A.options.valueProperty]==A.value){hui.addClass(E,"hui_picker_item_selected")}E.innerHTML='<div class="hui_picker_item_middle"><div class="hui_picker_item_middle"><div style="width:'+A.options.itemWidth+"px;height:"+A.options.itemHeight+"px; overflow: hidden; background-image:url('"+C.image+"')\"><strong>"+hui.escape(C.title)+'</strong></div></div></div><div class="hui_picker_item_bottom"><div><div></div></div></div>';hui.listen(E,"mouseup",function(){A.selectionChanged(C[A.options.valueProperty])});A.content.appendChild(E)})},updateSelection:function(){var B=this.content.childNodes;for(var A=0;A<B.length;A++){hui.setClass(B[A],"hui_picker_item_selected",this.value!=null&&this.objects[A][this.options.valueProperty]==this.value)}},selectionChanged:function(A){if(this.dragging){return }if(this.value==A){return }this.value=A;this.updateSelection();this.fire("selectionChanged",A)},startDrag:function(B){B=new hui.Event(B);B.stop();var A=this;this.dragX=B.getLeft();this.dragScroll=this.container.scrollLeft;hui.ui.Picker.mousemove=function(C){A.drag(C);return false};hui.ui.Picker.mouseup=hui.ui.Picker.mousedown=function(C){A.endDrag(C);return false};hui.listen(window.document,"mousemove",hui.ui.Picker.mousemove);hui.listen(window.document,"mouseup",hui.ui.Picker.mouseup);hui.listen(window.document,"mousedown",hui.ui.Picker.mouseup)},drag:function(A){A=new hui.Event(A);A.stop();this.dragging=true;this.container.scrollLeft=this.dragX-A.getLeft()+this.dragScroll},endDrag:function(B){this.dragging=false;hui.stop(B);hui.unListen(window.document,"mousemove",hui.ui.Picker.mousemove);hui.unListen(window.document,"mouseup",hui.ui.Picker.mouseup);hui.unListen(window.document,"mousedown",hui.ui.Picker.mouseup);var A=this.options.itemWidth+14;hui.animate(this.container,"scrollLeft",Math.round(this.container.scrollLeft/A)*A,500,{ease:hui.ease.bounceOut})},$visibilityChanged:function(){if(!hui.dom.isVisible(this.container)){return }this.container.style.display="none";var A;if(this.options.itemsVisible){A=this.options.itemsVisible*(this.options.itemWidth+14)}else{A=this.container.parentNode.clientWidth-12}A=Math.max(A,0);hui.setStyle(this.container,{width:A+"px",display:"block"})}};hui.ui.Editor=function(){this.name="huiEditor";this.options={rowClass:"row",columnClass:"column",partClass:"part"};this.parts=[];this.rows=[];this.partControllers=[];this.activePart=null;this.active=false;this.dragProxy=null;hui.ui.extend(this)};hui.ui.Editor.get=function(){if(!hui.ui.Editor.instance){hui.ui.Editor.instance=new hui.ui.Editor()}return hui.ui.Editor.instance};hui.ui.Editor.prototype={ignite:function(){this.reload()},addPartController:function(B,C,A){this.partControllers.push({key:B,"title":C,"controller":A})},setOptions:function(A){hui.override(this.options,A)},getPartController:function(A){var B=null;hui.each(this.partControllers,function(C){if(C.key==A){B=C}});return B},reload:function(){if(this.partControls){this.partControls.hide()}var A=this;this.parts=[];var B=hui.byClass(document.body,this.options.partClass);hui.each(B,function(F,E){var D=hui.byClass(F,A.options.columnClass);A.reloadColumns(D,E);hui.each(D,function(H,G){var I=H.select("."+A.options.partClass);A.reloadParts(I,E,G)})});var C=hui.byClass(document.body,this.options.partClass);hui.each(this.parts,function(D){var E=C.indexOf(D.element);if(E!=-1){delete (C[E])}});this.reloadParts(C,-1,-1)},partExists:function(A){},reloadColumns:function(B,C){var A=this;hui.each(B,function(E,D){hui.lsiten(E,"mouseover",function(){A.hoverColumn(E)});hui.listen(E,"mouseout",function(){A.blurColumn()});hui.listen(E,"contextmenu",function(F){A.contextColumn(E,C,D,F)})})},reloadParts:function(D,E,C){var A=this;var B=new RegExp(this.options.partClass+"_([\\w]+)","i");hui.each(D,function(H,J){if(!H){return }var G=H.className.match(B);if(G&&G[1]){var I=A.getPartController(G[1]);if(I){var F=new I.controller(H,E,C,J);F.type=G[1];hui.listen(H,"click",function(K){K=hui.event(K);if(!K.findByTag("a")){A.editPart(F)}});hui.listen(H,"mouseover",function(K){A.hoverPart(F)});hui.listen(H,"mouseout",function(K){A.blurPart(K)});hui.listen(H,"mousedown",function(K){A.startPartDrag(K)});A.parts.push(F)}}})},activate:function(){this.active=true},deactivate:function(){this.active=false;if(this.activePart){this.activePart.deactivate()}if(this.partControls){this.partControls.hide()}},hoverColumn:function(A){this.hoveredColumn=A;if(!this.active||this.activePart){return }hui.addClass(A,"hui_editor_column_hover")},blurColumn:function(){if(!this.active||!this.hoveredColumn){return }hui.removeClass(this.hoveredColumn,"hui_editor_column_hover")},contextColumn:function(C,G,B,E){if(!this.active||this.activePart){return }if(!this.columnMenu){var F=hui.ui.Menu.create({name:"huiEditorColumnMenu"});F.addItem({title:"Rediger kolonne",value:"editColumn"});F.addItem({title:"Slet kolonne",value:"removeColumn"});F.addItem({title:"Tilfj kolonne",value:"addColumn"});F.addDivider();for(var A=0;A<this.partControllers.length;A++){var D=this.partControllers[A];F.addItem({title:D.title,value:D.key})}this.columnMenu=F;F.listen(this)}this.hoveredRow=G;this.hoveredColumnIndex=B;this.columnMenu.showAtPointer(E)},$itemWasClicked$huiEditorColumnMenu:function(A){if(A=="removeColumn"){this.fire("removeColumn",{"row":this.hoveredRow,"column":this.hoveredColumnIndex})}else{if(A=="editColumn"){this.editColumn(this.hoveredRow,this.hoveredColumnIndex)}else{if(A=="addColumn"){this.fire("addColumn",{"row":this.hoveredRow,"position":this.hoveredColumnIndex+1})}else{this.fire("addPart",{"row":this.hoveredRow,"column":this.hoveredColumnIndex,"position":0,type:A})}}}},editColumn:function(D,A){this.closeColumn();var B=hui.byClass(document.body,"row")[D];var C=this.activeColumn=hui.byClass(B,"column")[A];hui.addClass(C,"hui_editor_column_edit");this.showColumnWindow();this.columnEditorForm.setValues({width:C.getStyle("width"),paddingLeft:C.getStyle("padding-left")})},closeColumn:function(){if(this.activeColumn){hui.removeClass(this.activeColumn,"hui_editor_column_edit")}},showColumnWindow:function(){if(!this.columnEditor){var A=this.columnEditor=hui.ui.Window.create({name:"columnEditor",title:"Rediger kolonne",width:200});var F=this.columnEditorForm=hui.ui.Formula.create();var C=F.createGroup();var B=hui.ui.TextField.create({label:"Bredde",key:"width"});B.listen({$valueChanged:function(G){this.changeColumnWidth(G)}.bind(this)});C.add(B);var E=hui.ui.TextField.create({label:"Venstremargen",key:"left"});E.listen({$valueChanged:function(G){this.changeColumnLeftMargin(G)}.bind(this)});C.add(E);var D=hui.ui.TextField.create({label:"Hjremargen",key:"right"});D.listen({$valueChanged:this.changeColumnRightMargin.bind(this)});C.add(D);A.add(F);A.listen(this)}this.columnEditor.show()},$userClosedWindow$columnEditor:function(){this.closeColumn();var A=this.columnEditorForm.getValues();A.row=this.hoveredRow;A.column=this.hoveredColumnIndex;this.fire("updateColumn",A)},changeColumnWidth:function(A){this.activeColumn.style.width=A},changeColumnLeftMargin:function(A){this.activeColumn.setStyle({"paddingLeft":A})},changeColumnRightMargin:function(A){this.activeColumn.setStyle({"paddingRight":A})},hoverPart:function(B,C){if(!this.active||this.activePart){return }this.hoveredPart=B;hui.addClass(B.element,"hui_editor_part_hover");var A=this;this.partControlTimer=window.setTimeout(function(){A.showPartControls()},200)},blurPart:function(A){window.clearTimeout(this.partControlTimer);if(!this.active){return }if(this.partControls&&!hui.ui.isWithin(A,this.partControls.element)){this.hidePartControls();hui.removeClass(this.hoveredPart.element,"hui_editor_part_hover")}if(!this.partControls&&this.hoveredPart){hui.removeClass(this.hoveredPart.element,"hui_editor_part_hover")}},showPartEditControls:function(){if(!this.partEditControls){this.partEditControls=hui.ui.Overlay.create({name:"huiEditorPartEditActions"});this.partEditControls.addIcon("save","common/save");this.partEditControls.addIcon("cancel","common/close");this.partEditControls.listen(this)}this.partEditControls.showAtElement(this.activePart.element,{"horizontal":"right","vertical":"topOutside"})},showPartControls:function(){if(!this.partControls){this.partControls=hui.ui.Overlay.create({name:"huiEditorPartActions"});this.partControls.addIcon("edit","common/edit");this.partControls.addIcon("new","common/new");this.partControls.addIcon("delete","common/delete");var A=this;hui.listen(this.partControls.getElement(),"mouseout",function(B){A.blurControls(B)});hui.listen(this.partControls.getElement(),"mouseover",function(B){A.hoverControls(B)});this.partControls.listen(this)}if(this.hoveredPart.column==-1){this.partControls.hideIcons(["new","delete"])}else{this.partControls.showIcons(["new","delete"])}this.partControls.showAtElement(this.hoveredPart.element,{"horizontal":"right"})},hoverControls:function(A){hui.addClass(this.hoveredPart.element,"hui_editor_part_hover")},blurControls:function(A){hui.removeClass(this.hoveredPart.element,"hui_editor_part_hover");if(!hui.ui.isWithin(A,this.hoveredPart.element)){this.hidePartControls()}},$iconWasClicked$huiEditorPartActions:function(A,B){if(A=="delete"){this.deletePart(this.hoveredPart)}else{if(A=="new"){this.newPart(B)}else{if(A=="edit"){this.editPart(this.hoveredPart)}}}},$iconWasClicked$huiEditorPartEditActions:function(A,B){if(A=="cancel"){this.cancelPart(this.activePart)}else{if(A=="save"){this.savePart(this.activePart)}}},hidePartControls:function(){if(this.partControls){this.partControls.hide()}},hidePartEditControls:function(){if(this.partEditControls){this.partEditControls.hide()}},editPart:function(A){if(!this.active||this.activePart){return }if(this.activePart){this.activePart.deactivate()}if(this.hoveredPart){hui.removeClass(this.hoveredPart.element,"hui_editor_part_hover")}this.activePart=A;this.showPartEditControls();hui.addClass(A.element,"hui_editor_part_active");A.activate(function(){});window.clearTimeout(this.partControlTimer);this.hidePartControls();this.blurColumn();this.showPartEditor()},showPartEditor:function(){},updatePartProperties:function(A){hui.setStyle(this.activePart.element,{marginTop:A.top,marginBottom:A.bottom,marginLeft:A.left,marginRight:A.right});this.activePart.properties=A;hui.log(A)},hidePartEditor:function(){if(this.partEditor){this.partEditor.hide()}},cancelPart:function(A){A.cancel();this.hidePartEditor()},savePart:function(A){A.save();this.hidePartEditor()},getEditorForElement:function(B){for(var A=0;A<this.parts.length;A++){if(this.parts[A].element==B){return this.parts[A]}}return null},partDidDeacivate:function(A){hui.removeClass(A.element,"hui_editor_part_active");this.activePart=null;this.hidePartEditControls()},partChanged:function(A){hui.ui.callDelegates(A,"partChanged")},deletePart:function(A){hui.ui.callDelegates(A,"deletePart");this.partControls.hide()},newPart:function(A){if(!this.newPartMenu){var B=hui.ui.Menu.create({name:"huiEditorNewPartMenu"});hui.each(this.partControllers,function(C){B.addItem({title:C.title,value:C.key})});B.listen(this);this.newPartMenu=B}this.newPartMenu.showAtPointer(A)},itemWasClicked$huiEditorNewPartMenu:function(A){var B={row:this.hoveredPart.row,column:this.hoveredPart.column,position:this.hoveredPart.position+1,type:A};hui.ui.callDelegates(this,"addPart",B)},startPartDrag:function(B){return true;if(!this.active||this.activePart){return true}if(!this.dragProxy){this.dragProxy=hui.build("div",{"class":"hui_editor_dragproxy part part_header",parent:document.body})}var A=this.hoveredPart.element;this.dragProxy.style.width=A.clientWidth+"px";this.dragProxy.innerHTML=A.innerHTML;hui.ui.Editor.startDrag(B,this.dragProxy);return ;hui.listen(document.body,"mouseup",function(){self.endPartDrag()})},dragPart:function(){},endPartDrag:function(){}};hui.ui.Editor.startDrag=function(B,A){hui.ui.Editor.dragElement=A;hui.listen(document.body,"mousemove",hui.ui.Editor.dragListener);hui.listen(document.body,"mouseup",hui.ui.Editor.dragEndListener);hui.ui.Editor.startDragPos={top:B.pointerY(),left:B.pointerX()};B.stop();return false};hui.ui.Editor.dragListener=function(B){B=hui.event(B);var A=hui.ui.Editor.dragElement;A.style.left=B.getLeft()+"px";A.style.top=B.getTop()+"px";A.style.display="block";return false};hui.ui.Editor.dragEndListener=function(A){hui.unListen(document.body,"mousemove",hui.ui.Editor.dragListener);hui.unListen(document.body,"mouseup",hui.ui.Editor.dragEndListener);hui.ui.Editor.dragElement.style.display="none";hui.ui.Editor.dragElement=null};hui.ui.Editor.getPartId=function(B){var A=B.id.match(/part\-([\d]+)/i);if(A&&A.length>0){return A[1]}};hui.ui.Editor.Header=function(B,D,C,A){this.element=hui.get(B);this.row=D;this.column=C;this.position=A;this.id=hui.ui.Editor.getPartId(this.element);this.header=hui.firstByTag(this.element,"*");this.field=null};hui.ui.Editor.Header.prototype={activate:function(){this.value=this.header.innerHTML;this.field=hui.build("textarea",{className:"hui_editor_header"});this.field.value=this.value;this.header.style.visibility="hidden";this.updateFieldStyle();this.element.insertBefore(this.field,this.header);this.field.focus();this.field.select();hui.listen(this.field,"keydown",function(A){if(A.keyCode==Event.KEY_RETURN){this.save()}}.bind(this))},save:function(){var A=this.field.value;this.header.innerHTML=A;this.deactivate();if(A!=this.value){this.value=A;hui.ui.Editor.get().partChanged(this)}},cancel:function(){this.deactivate()},deactivate:function(){this.header.style.visibility="";this.element.removeChild(this.field);hui.ui.Editor.get().partDidDeacivate(this)},updateFieldStyle:function(){hui.setStyle(this.field,{width:this.header.clientWidth+"px",height:this.header.clientHeight+"px"});hui.copyStyle(this.header,this.field,["fontSize","lineHeight","marginTop","fontWeight","fontFamily","textAlign","color","fontStyle"])},getValue:function(){return this.value}};hui.ui.Editor.Html=function(B,D,C,A){this.element=hui.get(B);this.row=D;this.column=C;this.position=A;this.id=hui.ui.Editor.getPartId(this.element);this.field=null};hui.ui.Editor.Html.prototype={activate:function(){this.value=this.element.innerHTML;this.element.innerHTML="";var A=this.buildStyle();this.editor=hui.ui.MarkupEditor.create({autoHideToolbar:false,style:A});this.element.appendChild(this.editor.getElement());this.editor.listen(this);this.editor.setValue(this.value);this.editor.focus()},buildStyle:function(){return{"textAlign":hui.getStyle(this.element,"text-align"),"fontFamily":hui.getStyle(this.element,"font-family"),"fontSize":hui.getStyle(this.element,"font-size"),"fontWeight":hui.getStyle(this.element,"font-weight"),"color":hui.getStyle(this.element,"color")}},cancel:function(){this.deactivate();this.element.innerHTML=this.value},save:function(){this.deactivate();var A=this.editor.getValue();if(A!=this.value){this.value=A;hui.ui.Editor.get().partChanged(this)}this.element.innerHTML=this.value},deactivate:function(){if(this.editor){this.editor.destroy();this.element.innerHTML=this.value}hui.ui.Editor.get().partDidDeacivate(this)},richTextDidChange:function(){},getValue:function(){return this.value}};hui.ui.Menu=function(A){this.options=hui.override({autoHide:false,parentElement:null},A);this.element=hui.get(A.element);this.name=A.name;this.value=null;this.subMenus=[];this.visible=false;hui.ui.extend(this);this._addBehavior()};hui.ui.Menu.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_menu"});var B=new hui.ui.Menu(A);document.body.appendChild(A.element);return B};hui.ui.Menu.prototype={_addBehavior:function(){this.hider=function(){this.hide()}.bind(this);if(this.options.autoHide){var A=function(B){if(!hui.ui.isWithin(B,this.element)&&(!this.options.parentElement||!hui.ui.isWithin(B,this.options.parentElement))){if(!this.isSubMenuVisible()){this.hide()}}}.bind(this);hui.listen(this.element,"mouseout",A);if(this.options.parentElement){hui.listen(this.options.parentElement,"mouseout",A)}}},addDivider:function(){hui.build("div",{"class":"hui_menu_divider",parent:this.element})},addItem:function(D){var A=this;var B=hui.build("div",{"class":"hui_menu_item",text:D.title});hui.listen(B,"click",function(E){hui.stop(E);A.itemWasClicked(D.value)});if(D.children){var C=hui.ui.Menu.create({autoHide:true,parentElement:B});C.addItems(D.children);hui.listen(B,"mouseover",function(E){C.showAtElement(B,E,"horizontal")});A.subMenus.push(C);hui.addClass(B,"hui_menu_item_children")}this.element.appendChild(B)},addItems:function(A){for(var B=0;B<A.length;B++){if(A[B]==null){this.addDivider()}else{this.addItem(A[B])}}},getValue:function(){return this.value},itemWasClicked:function(A){this.value=A;this.fire("itemWasClicked",A);this.fire("select",A);this.hide()},showAtPointer:function(A){A=hui.event(A);A.stop();this.showAtPoint({"top":A.getTop(),"left":A.getLeft()})},showAtElement:function(C,D,B){D=hui.event(D);D.stop();C=hui.get(C);var A=hui.getPosition(C);if(B=="horizontal"){A.left+=C.clientWidth}else{if(B=="vertical"){A.top+=C.clientHeight}}this.showAtPoint(A)},showAtPoint:function(H){var F=hui.getViewPortWidth();var A=hui.getViewPortHeight();var C=hui.getScrollTop();var E=hui.getScrollLeft();if(!this.visible){hui.setStyle(this.element,{"display":"block","visibility":"hidden",opacity:0})}var B=this.element.clientWidth;var I=this.element.clientHeight;var D=Math.min(H.left,F-B-26+E);var G=Math.max(0,Math.min(H.top,A-I-20+C));hui.setStyle(this.element,{"top":G+"px","left":D+"px","visibility":"visible",zIndex:hui.ui.nextTopIndex()});if(!this.element.style.width){this.element.style.width=(B+6)+"px"}if(!this.visible){hui.setStyle(this.element,{opacity:1});this.addHider();this.visible=true}},hide:function(){if(!this.visible){return }var A=this;hui.animate(this.element,"opacity",0,200,{onComplete:function(){A.element.style.display="none"}});this.removeHider();for(var B=0;B<this.subMenus.length;B++){this.subMenus[B].hide()}this.visible=false},isSubMenuVisible:function(){for(var A=0;A<this.subMenus.length;A++){if(this.subMenus[A].visible){return true}}return false},addHider:function(){hui.listen(document.body,"click",this.hider)},removeHider:function(){hui.unListen(document.body,"click",this.hider)}};hui.ui.Overlay=function(A){this.options=A;this.element=hui.get(A.element);this.content=hui.byClass(this.element,"hui_inner_overlay")[1];this.name=A.name;this.icons={};this.visible=false;hui.ui.extend(this);this.addBehavior()};hui.ui.Overlay.create=function(A){A=A||{};var B=A.element=hui.build("div",{className:"hui_overlay",style:"display:none",html:'<div class="hui_inner_overlay"><div class="hui_inner_overlay"></div></div>'});document.body.appendChild(B);return new hui.ui.Overlay(A)};hui.ui.Overlay.prototype={addBehavior:function(){var A=this;this.hider=function(B){if(A.boundElement){if(hui.ui.isWithin(B,A.boundElement)||hui.ui.isWithin(B,A.element)){return }hui.removeClass(A.boundElement,"hui_overlay_bound");A.boundElement=null;A.hide()}};hui.listen(this.element,"mouseout",this.hider)},addIcon:function(C,D){var A=this;var B=hui.build("div",{className:"hui_overlay_icon"});B.style.backgroundImage="url("+hui.ui.getIconUrl(D,32)+")";hui.listen(B,"click",function(E){A.iconWasClicked(C,E)});this.icons[C]=B;this.content.appendChild(B)},addText:function(A){this.content.appendChild(hui.build("span",{"class":"hui_overlay_text",text:A}))},add:function(A){this.content.appendChild(A.getElement())},hideIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display="none"}},showIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display=""}},iconWasClicked:function(A,B){hui.ui.callDelegates(this,"iconWasClicked",A,B)},showAtElement:function(B,A){A=A||{};hui.ui.positionAtElement(this.element,B,A);if(this.visible){return }if(hui.browser.msie){this.element.style.display="block"}else{hui.setStyle(this.element,{"display":"block","opacity":0});hui.animate(this.element,"opacity",1,150)}this.visible=true;if(A.autoHide){this.boundElement=B;hui.listen(B,"mouseout",this.hider);hui.addClass(B,"hui_overlay_bound")}if(this.options.modal){var C=hui.ui.nextAlertIndex();this.element.style.zIndex=C+1;hui.ui.showCurtain({widget:this,zIndex:C})}return },show:function(A){A=A||{};if(!this.visible){hui.setStyle(this.element,{"display":"block",visibility:"hidden"})}if(A.element){hui.place({source:{element:this.element,vertical:0,horizontal:0.5},target:{element:A.element,vertical:0.5,horizontal:0.5},insideViewPort:true,viewPartMargin:9})}if(this.visible){return }hui.ui.bounceIn(this.element);this.visible=true;if(A.autoHide&&A.element){this.boundElement=A.element;hui.listen(A.element,"mouseout",this.hider);hui.addClass(A.element,"hui_overlay_bound")}if(this.options.modal){var B=hui.ui.nextAlertIndex();this.element.style.zIndex=B+1;hui.ui.showCurtain({widget:this,zIndex:B,color:"auto"})}},$curtainWasClicked:function(){this.hide()},hide:function(){hui.ui.hideCurtain(this);this.element.style.display="none";this.visible=false},clear:function(){hui.ui.destroyDescendants(this.content);this.content.innerHTML=""}};hui.ui.Upload=function(A){this.options=hui.override({url:"",parameters:{},multiple:false,maxSize:"20480",types:"*.*",fieldName:"file",chooseButton:"Choose files..."},A);this.element=hui.get(A.element);this.itemContainer=hui.firstByClass(this.element,"hui_upload_items");this.status=hui.firstByClass(this.element,"hui_upload_status");this.placeholder=hui.firstByClass(this.element,"hui_upload_placeholder");this.name=A.name;this.items=[];this.busy=false;this._chooseImplementation();hui.ui.extend(this);this._addBehavior()};hui.ui.Upload.implementations=["Frame","HTML5","Flash"];hui.ui.Upload.nameIndex=0;hui.ui.Upload.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_upload",html:'<div class="hui_upload_items"></div><div class="hui_upload_status"></div>'+(A.placeholder?'<div class="hui_upload_placeholder"><span class="hui_upload_icon"></span>'+(A.placeholder.title?"<h2>"+hui.escape(A.placeholder.title)+"</h2>":"")+(A.placeholder.text?"<p>"+hui.escape(A.placeholder.text)+"</p>":"")+"</div>":"")});return new hui.ui.Upload(A)};hui.ui.Upload.prototype={setParameter:function(A,B){this.options.parameters[A]=B;this.impl.setParameter(A,B)},clear:function(){for(var A=0;A<this.items.length;A++){if(this.items[A]){this.items[A].destroy()}}this.items=[];this.itemContainer.style.display="none";this.status.style.display="none";if(this.placeholder){this.placeholder.style.display="block"}},addDropTarget:function(A){if(A.element){hui.drag.listen({element:A.element,hoverClass:A.hoverClass,onFiles:this._transferFiles.bind(this)})}},uploadFiles:function(A){this._transferFiles(A)},_chooseImplementation:function(){var D=hui.ui.Upload.implementations;if(this.options.implementation){D.splice(0,0,this.options.implementation)}for(var B=0;B<D.length;B++){var A=hui.ui.Upload[D[B]];var C=A.support();if(C.supported){if(!this.options.multiple&&!C.multiple){this.impl=new A(this);hui.log("Selected impl (single): "+D[B]);break}else{if(this.options.multiple&&C.multiple){this.impl=new A(this);hui.log("Selected impl (multiple): "+D[B]);break}}}}if(!this.impl){hui.log("No implementation found, using frame");this.impl=new hui.ui.Upload.Frame(this)}},_addBehavior:function(){if(!this.impl.initialize){alert(this.impl);return }hui.ui.onReady(function(){this.impl.initialize();hui.drag.listen({element:this.element,hoverClass:"hui_upload_drop",onFiles:this._transferFiles.bind(this)})}.bind(this))},_transferFiles:function(C){if(C.length>0){if(!this.options.multiple){this._transferFile(C[0])}else{for(var B=0;B<C.length;B++){var A=C[B];this._transferFile(A)}}}},_transferFile:function(A){hui.log(A);var B=this.$_addItem({name:A.name,size:A.size});hui.request({method:"post",file:A,url:this.options.url,parameters:this.options.parameters,onProgress:function(D,C){B.updateProgress(D,C)},onLoad:function(){hui.log("transferFile: load")},onAbort:function(){this.$_itemFail(B);B.setError("Afbrudt")}.bind(this),onSuccess:function(){hui.log("transferFile: success");this.$_itemSuccess(B)}.bind(this),onFailure:function(){hui.log("transferFile: fail");this.$_itemFail(B)}.bind(this)})},$_addItem:function(A){if(!this.busy){this.fire("uploadDidStartQueue");this.status.style.display="block";this._setWidgetEnabled(false);this.busy=true}return this._addItem(A)},$_itemSuccess:function(D){var E=hui.firstByClass(this.itemContainer,"hui_upload_item_success");D.setProgress(1);D.setSuccess();this.fire("uploadDidComplete",D.getInfo());this._checkQueue();var B=E!=null||this.items.length>1;B=B&&D.element.nextSibling!=null;if(B&&(E==null||E!=D.element.nextSibling)){var C=D.element.parentNode;var A=D.element.clientHeight;hui.animate({node:D.element,css:{height:"0px"},ease:hui.ease.slowFastSlow,duration:500,onComplete:function(){C.removeChild(D.element);if(E){C.insertBefore(D.element,E)}else{C.appendChild(D.element)}hui.animate({node:D.element,css:{height:A+"px"},ease:hui.ease.slowFastSlow,duration:200})}})}},$_itemFail:function(A){A.setError("Upload af filen fejlede!");this.fire("uploadDidFail",A.getInfo());this._checkQueue()},$_getButtonContainer:function(){var B=hui.build("span",{"class":"hui_upload_button"});if(this.options.widget){var A=hui.ui.get(this.options.widget);A.element.parentNode.insertBefore(B,A.element);A.element.parentNode.removeChild(A.element);B.appendChild(A.element)}else{B.innerHTML='<a href="javascript:void(0);" class="hui_button"><span><span>'+this.options.chooseButton+"</span></span></a>";this.element.appendChild(B)}return B},_setWidgetEnabled:function(B){if(this.options.widget){var A=hui.ui.get(this.options.widget);if(A&&A.setEnabled){A.setEnabled(B)}}},_checkQueue:function(){for(var A=0;A<this.items.length;A++){if(!this.items[A].isFinished()){return }}this.busy=false;this._setWidgetEnabled(true);this.fire("uploadDidCompleteQueue")},_addItem:function(C){var A=C.index;if(A===undefined){A=this.items.length;C.index=A}var B=A>4;var D=new hui.ui.Upload.Item(C,B);this.items[A]=D;var E=hui.firstByClass(this.itemContainer,"hui_upload_item_success");if(E){this.itemContainer.insertBefore(D.element,E)}else{this.itemContainer.appendChild(D.element)}this.itemContainer.style.display="block";if(this.placeholder){this.placeholder.style.display="none"}return D}};hui.ui.Upload.Item=function(B,A){this.data=B;this.rearrange=A;this.element=hui.build("div",{className:"hui_upload_item"});this.element.appendChild(hui.ui.createIcon("file/generic",32));this.content=hui.build("div",{className:"hui_upload_item_content",parent:this.element});this.progress=hui.ui.ProgressBar.create({small:true});this.content.appendChild(this.progress.getElement());var C=hui.build("p",{parent:this.content});this.info=hui.build("strong",{parent:C});this.status=hui.build("em",{parent:C});if(B.name){hui.dom.setText(this.info,B.name)}this.finished=false;this.error=false};hui.ui.Upload.Item.prototype={getInfo:function(){return this.data},isFinished:function(){return this.finished},setError:function(A){this._setStatus(A||"Fejl");hui.addClass(this.element,"hui_upload_item_error");this.progress.hide();this.progress.setValue(0);this.finished=true},setSuccess:function(A){this._setStatus("Frdig");this.progress.setValue(1);this.finished=true;hui.addClass(this.element,"hui_upload_item_success")},updateProgress:function(A,B){this.setProgress(A/B);return this},setProgress:function(A){this._setStatus("Overfrer");this.progress.setValue(Math.min(0.9999,A));return this},setWaiting:function(){this._setStatus("Venter");this.progress.setWaiting();return this},hide:function(){this.element.hide()},destroy:function(){hui.dom.remove(this.element)},_setStatus:function(A){if(this._status!==A){hui.dom.setText(this.status,A);this._status=A}}};hui.ui.Upload._nameIndex=0;hui.ui.Upload._buildForm=function(F){var B=F.options;hui.ui.Upload._nameIndex++;var A="hui_upload_"+hui.ui.Upload.Frame.nameIndex;var D=hui.build("form");D.setAttribute("action",B.url||"");D.setAttribute("method","post");D.setAttribute("enctype","multipart/form-data");D.setAttribute("encoding","multipart/form-data");D.setAttribute("target",A);if(B.parameters){for(var C in B.parameters){var E=hui.build("input",{"type":"hidden","name":C});E.value=B.parameters[C];D.appendChild(E)}}return D};hui.ui.Upload.Frame=function(A){this.parent=A};hui.ui.Upload.Frame.support=function(){return{supported:true,multiple:false}};hui.ui.Upload.Frame.prototype={initialize:function(){var B=this.parent.options;var E=this.form=hui.ui.Upload._buildForm(this.parent);var A=E.getAttribute("target");var D=this.iframe=hui.build("iframe",{name:A,id:A,src:hui.ui.context+"/hui/html/blank.html",style:"display:none"});this.parent.element.appendChild(D);hui.listen(this.iframe,"load",function(){this._uploadComplete()}.bind(this));this.fileInput=hui.build("input",{"type":"file","name":B.fieldName});hui.listen(this.fileInput,"change",this._onSubmit.bind(this));E.appendChild(this.fileInput);var C=hui.build("span",{"class":"hui_upload_button_input"});C.appendChild(E);var F=this.parent.$_getButtonContainer();F.insertBefore(C,F.firstChild)},setParameter:function(A,D){var C=this.form.getElementsByTagName("input");for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=D;return }}hui.build("input",{"type":"hidden","name":A,"value":D,parent:this.form})},_rebuildParameters:function(){if(hui.browser.msie){hui.each(this.parent.options.parameters,function(A,B){this.form[A].value=B}.bind(this))}},_getFileName:function(){return this.fileInput.value.split("\\").pop()},_onSubmit:function(){this.form.style.display="none";this.uploading=true;this._rebuildParameters();this.form.submit();this.item=this.parent.$_addItem({name:this._getFileName()});this.item.setWaiting();hui.log("Frame: Upload started")},_uploadComplete:function(){if(!this.uploading){return }this.uploading=false;var B=this._isSuccessResponse();hui.log("Frame: Upload complete: success="+B);var A=this.item;if(A){if(B){this.parent.$_itemSuccess(A);hui.log("Frame: Upload succeeded")}else{this.parent.$_itemFail(A);hui.log("Frame: Upload failed!")}}this.iframe.src=hui.ui.context+"/hui/html/blank.html";this.form.style.display="block";this.form.reset()},_isSuccessResponse:function(){var A=hui.getFrameDocument(this.iframe);return A.body.innerHTML.indexOf("SUCCESS")!==-1}};hui.ui.Upload.Flash=function(A){this.parent=A;this.items=[]};hui.ui.Upload.Flash.support=function(){if(hui.browser.chrome){}return{supported:hui.ui.Flash.getMajorVersion()>=10&&window.SWFUpload!==undefined,multiple:true}};hui.ui.Upload.Flash.prototype={initialize:function(){var E=this.parent.options;hui.log("Creating flash verison");var D=this._getAbsoluteUrl(E.url);var B=hui.cookie.get("JSESSIONID");if(B){D+=";jsessionid="+B}var F=hui.cookie.get("PHPSESSID");if(F){D+="?PHPSESSID="+F}var C=hui.build("span",{"class":"hui_upload_button"});var G=hui.build("span",{"class":"hui_upload_button_object",parent:C});if(E.widget){var A=hui.ui.get(E.widget);A.element.parentNode.insertBefore(C,A.element);A.element.parentNode.removeChild(A.element);C.appendChild(A.element)}else{C.innerHTL='<a href="javascript:void(0);" class="hui_button"><span><span>'+E.chooseButton+"</span></span></a>";this.parent.element.appendChild(C)}this.loader=new SWFUpload({upload_url:D,flash_url:hui.ui.context+"/hui/lib/swfupload/swfupload.swf",file_size_limit:E.maxSize,file_queue_limit:E.maxItems,file_post_name:E.fieldName,file_upload_limit:E.maxItems,file_types:E.types,debug:!true,post_params:E.parameters,swfupload_loaded_handler:this._onFlashLoaded.bind(this),file_queued_handler:this._onFileQueued.bind(this),file_queue_error_handler:this._onFileQueueError.bind(this),file_dialog_complete_handler:this._onFileDialogComplete.bind(this),upload_start_handler:this._onUploadStart.bind(this),upload_progress_handler:this._onUploadProgress.bind(this),upload_error_handler:this._onUploadError.bind(this),upload_success_handler:this._onUploadSuccess.bind(this),upload_complete_handler:this._onUploadComplete.bind(this)})},setParameter:function(A,B){hui.log("Flash: Warning: cannot change parameters")},_getAbsoluteUrl:function(B){var C=new String(document.location);var A=C.slice(0,C.lastIndexOf("/"));while(B.indexOf("../")===0){B=B.substring(3);A=A.slice(0,A.lastIndexOf("/"))}A+="/"+B;return A},_onFlashLoaded:function(){hui.log("Flash loaded")},_onFileQueued:function(A){var B=this.parent.$_addItem({name:A.name,size:A.size});B.setWaiting();this.items.push(B)},_onFileQueueError:function(B,A,D){hui.log("Flash: fileQueueError file:"+hui.toJSON(B)+", error:"+A+", message:"+D);if(B!==null){var C=this.parent.$_addItem({name:B.name,size:B.size});this.items.push(C);this.parent.$_itemFail(C);C.setError(hui.ui.Upload.Flash.errors[A])}else{hui.ui.showMessage({text:hui.ui.Upload.Flash.errors[A],duration:4000})}},_onFileDialogComplete:function(){hui.log("Flash: fileDialogComplete");this.loader.startUpload()},_onUploadStart:function(){},_onUploadProgress:function(B,A,D){var C=this.items[B.index];C.updateProgress(A,D)},_onUploadError:function(B,A,D){hui.log("Flash: uploadError file:"+B+", error:"+A+", message:"+D);if(B){var C=this.items[B.index];this.parent.$_itemFail(C);C.setError(hui.ui.Upload.Flash.errors[A])}},_onUploadSuccess:function(A,C){var B=this.items[A.index];B.updateProgress(A.size,A.size);this.parent.$_itemSuccess(B)},_onUploadComplete:function(A){this.loader.startUpload()}};!(function(){var B=hui.ui.Upload.Flash.errors={};var A=hui.ui.Upload.Flash.status={};if(window.SWFUpload){B[SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED]="Der er valgt for mange filer";B[SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT]="Filen er for stor";B[SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE]="Filen er tom";B[SWFUpload.QUEUE_ERROR.INVALID_FILETYPE]="Filens type er ikke understttet";B[SWFUpload.UPLOAD_ERROR.HTTP_ERROR]="Der skete en netvrksfejl";B[SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL]="Upload-adressen findes ikke";B[SWFUpload.UPLOAD_ERROR.IO_ERROR]="Der skete en IO-fejl";B[SWFUpload.UPLOAD_ERROR.SECURITY_ERROR]="Der skete en sikkerhedsfejl";B[SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED]="Upload-strrelsen er overskredet";B[SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED]="Upload af filen fejlede";B[SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND]="Filens id kunne ikke findes";B[SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED]="Validering af filen fejlede";B[SWFUpload.UPLOAD_ERROR.FILE_CANCELLED]="Filen blev afbrudt";B[SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED]="Upload af filen blev stoppet";A[SWFUpload.FILE_STATUS.QUEUED]="I k";A[SWFUpload.FILE_STATUS.IN_PROGRESS]="I gang";A[SWFUpload.FILE_STATUS.ERROR]="Filen gav fejl";A[SWFUpload.FILE_STATUS.COMPLETE]="Frdig";A[SWFUpload.FILE_STATUS.CANCELLED]="Afbrudt"}})();hui.ui.Upload.HTML5=function(A){this.parent=A};hui.ui.Upload.HTML5.support=function(){var A=window.File!==undefined&&(hui.browser.webkit||hui.browser.gecko);hui.log("HTML5: supported="+A);return{supported:A,multiple:true}};hui.ui.Upload.HTML5.prototype={initialize:function(){var A=this.parent.options;var B=hui.build("span",{"class":"hui_upload_button_input"});this.fileInput=hui.build("input",{"type":"file","name":A.fieldName,"multiple":"multiple",parent:B});var C=this.parent.$_getButtonContainer();C.insertBefore(B,C.firstChild);hui.listen(this.fileInput,"change",this._submit.bind(this))},_submit:function(B){var A=this.fileInput.files;this.parent._transferFiles(A)}};hui.ui.ProgressBar=function(A){this.element=hui.get(A.element);this.name=A.name;this.WAITING=A.small?"hui_progressbar_small_waiting":"hui_progressbar_waiting";this.COMPLETE=A.small?"hui_progressbar_small_complete":"hui_progressbar_complete";this.options=A||{};this.indicator=hui.firstByTag(this.element,"div");hui.ui.extend(this)};hui.ui.ProgressBar.create=function(B){B=B||{};var A=B.element=hui.build("div",{"class":B.small?"hui_progressbar hui_progressbar_small":"hui_progressbar"});A.appendChild(document.createElement("div"));return new hui.ui.ProgressBar(B)};hui.ui.ProgressBar.prototype={setValue:function(B){var A=this.element;if(this.waiting){hui.removeClass(A,this.WAITING)}hui.setClass(A,this.COMPLETE,B==1);hui.animate(this.indicator,"width",(B*100)+"%",200)},setWaiting:function(){this.waiting=true;this.indicator.style.width=0;hui.addClass(this.element,this.WAITING)},reset:function(){var A=this.element;if(this.waiting){hui.removeClass(A,this.WAITING)}hui.removeClass(A,this.COMPLETE);this.indicator.style.width="0%"},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block"}};hui.ui.Gallery=function(A){this.options=A||{};this.name=A.name;this.element=hui.get(A.element);this.body=hui.firstByClass(this.element,"hui_gallery_body");this.objects=[];this.nodes=[];this.selected=[];this.width=100;this.height=100;this.revealing=false;hui.ui.extend(this);if(A.dropFiles){this._addDrop()}if(this.options.source){this.options.source.listen(this)}if(this.element.parentNode&&hui.hasClass(this.element.parentNode,"hui_overflow")){this.revealing=true;hui.listen(this.element.parentNode,"scroll",this._reveal.bind(this))}};hui.ui.Gallery.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_gallery",html:'<div class="hui_gallery_progress"></div><div class="hui_gallery_body"></div>'});return new hui.ui.Gallery(A)};hui.ui.Gallery.prototype={_addDrop:function(){hui.drag.listen({element:this.element,hoverClass:"hui_gallery_drop",onFiles:function(A){this.fire("filesDropped",A)}.bind(this)})},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},setObjects:function(A){this.objects=A;this.render();this.fire("selectionReset")},getObjects:function(){return this.objects},$sourceShouldRefresh:function(){return this.element.style.display!="none"},$objectsLoaded:function(A){this.setObjects(A)},$itemsLoaded:function(A){this.setObjects(A)},render:function(){this.nodes=[];this.maxRevealed=0;this.body.innerHTML="";var A=this;hui.each(this.objects,function(D,E){var C=A.resolveImageUrl(D),G=0;if(C!==null){C=C.replace(/&amp;/,"&")}if(!A.revealing&&D.height<D.width){G=(A.height-(A.height*D.height/D.width))/2}var B=hui.build("img",{style:"margin:"+G+"px auto 0px"});B.setAttribute(A.revealing?"data-src":"src",C);if(A.revealing){}var F=hui.build("div",{"class":"hui_gallery_item",style:"width:"+A.width+"px; height:"+A.height+"px"});F.appendChild(B);hui.listen(F,"click",function(){A.itemClicked(E)});F.dragDropInfo={kind:"image",icon:"common/image",id:D.id,title:D.name||D.title};F.onmousedown=function(H){hui.ui.startDrag(H,F);return false};hui.listen(F,"dblclick",function(){A.itemDoubleClicked(E)});A.body.appendChild(F);A.nodes.push(F)});this._reveal()},$$layout:function(){if(this.nodes.length>0){this._reveal()}},_reveal:function(){if(!this.revealing){return }var C=this.element.parentNode;var B=C.scrollTop+C.clientHeight;if(B<=this.maxRevealed){return }this.maxRevealed=B;for(var F=0,A=this.nodes.length;F<A;F++){var G=this.nodes[F];if(G.revealed){continue}if(G.offsetTop<B){var E=G.getElementsByTagName("img")[0];G.className="hui_gallery_item hui_gallery_item_busy";var D=this;E.onload=function(){this.parentNode.className="hui_gallery_item";if(this.height<this.width){var H=(D.height-(D.height*this.height/this.width))/2;this.style.marginTop=H+"px"}};E.onerror=function(){this.parentNode.className="hui_gallery_item hui_gallery_item_error"};E.src=E.getAttribute("data-src");G.revealed=true}}},updateUI:function(){var B=this.selected;for(var A=0;A<this.nodes.length;A++){hui.setClass(this.nodes[A],"hui_gallery_item_selected",hui.inArray(B,A))}},resolveImageUrl:function(A){return hui.ui.resolveImageUrl(this,A,this.width,this.height);for(var B=0;B<this.delegates.length;B++){if(this.delegates[B]["$resolveImageUrl"]){return this.delegates[B]["$resolveImageUrl"](A,this.width,this.height)}}return""},itemClicked:function(A){if(this.busy){return }this.selected=[A];this.fire("selectionChanged");this.updateUI()},getFirstSelection:function(){if(this.selected.length>0){return this.objects[this.selected[0]]}return null},itemDoubleClicked:function(A){if(this.busy){return }this.fire("itemOpened",this.objects[A])},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.removeDelegate(this)}A.listen(this);this.options.source=A;A.refresh()}},$sourceIsBusy:function(){this._setBusy(true)},$sourceIsNotBusy:function(){this._setBusy(false)},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){this._reveal()}},_setBusy:function(A){this.busy=A;window.clearTimeout(this.busytimer);if(A){var B=this.element;this.busytimer=window.setTimeout(function(){hui.addClass(B,"hui_gallery_busy")},300)}else{hui.removeClass(this.element,"hui_gallery_busy")}}};hui.ui.Calendar=function(A){this.name=A.name;this.options=hui.override({startHour:7,endHour:24},A);this.element=hui.get(A.element);this.head=hui.firstByTag(this.element,"thead");this.body=hui.firstByTag(this.element,"tbody");this.date=new Date();hui.ui.extend(this);this.buildUI();this.updateUI();if(this.options.source){this.options.source.listen(this)}};hui.ui.Calendar.prototype={show:function(){this.element.style.display="block";if(this.options.source){this.options.source.refresh()}},hide:function(){this.element.style.display="none"},getFirstDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+1);A.setHours(0);A.setMinutes(0);A.setSeconds(0);return A},getLastDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+7);A.setHours(23);A.setMinutes(59);A.setSeconds(59);return A},clearEvents:function(){this.events=[];var A=hui.byClass(this.element,"hui_calendar_event");for(var B=0;B<A.length;B++){hui.dom.remove(A[B])}this.hideEventViewer()},$objectsLoaded:function(A){try{this.setEvents(A)}catch(B){hui.log(B)}},$sourceIsBusy:function(){this.setBusy(true)},$sourceShouldRefresh:function(){return this.element.style.display!="none"},setEvents:function(D){D=D||[];for(var C=0;C<D.length;C++){var F=D[C];if(typeof (F.startTime)!="object"){F.startTime=new Date(parseInt(F.startTime)*1000)}if(typeof (F.endTime)!="object"){F.endTime=new Date(parseInt(F.endTime)*1000)}}this.setBusy(false);this.clearEvents();this.events=D;var A=this;var G=(this.options.endHour-this.options.startHour)*40;var B=this.getFirstDay().getWeekOfYear();var E=this.getFirstDay().getYear();hui.each(this.events,function(L){var I=hui.byClass(A.body,"hui_calendar_day")[L.startTime.getDay()-1];if(!I){return }if(L.startTime.getWeekOfYear()!=B||L.startTime.getYear()!=E){return }var K=hui.build("div",{"class":"hui_calendar_event",parent:I});var M=((L.startTime.getHours()*60+L.startTime.getMinutes())/60-A.options.startHour)*40-1;var H=(L.endTime.getTime()-L.startTime.getTime())/1000/60/60*40+1;H=Math.min(G-M,H);hui.setStyle(K,{"marginTop":M+"px","height":H+"px",visibility:"hidden"});var J=hui.build("div",{parent:K});hui.build("p",{"class":"hui_calendar_event_time",text:L.startTime.dateFormat("H:i"),parent:J});hui.build("p",{"class":"hui_calendar_event_text",text:L.text,parent:J});if(L.location){hui.build("p",{"class":"hui_calendar_event_location",text:L.location,parent:J})}window.setTimeout(function(){hui.ui.bounceIn(K)},Math.random()*200);hui.listen(K,"click",function(){A.eventWasClicked(K)})})},eventWasClicked:function(A){this.showEvent(A)},setBusy:function(A){hui.setClass(this.element,"hui_calendar_busy",A)},updateUI:function(){var C=this.getFirstDay();var D=hui.byClass(this.head,"day");for(var B=0;B<D.length;B++){var A=new Date(C.getTime());A.setDate(A.getDate()+B);hui.dom.setText(D[B],A.dateFormat("l \\d. d M"))}},buildUI:function(){var F=hui.firstByClass(this.element,"hui_calendar_bar");this.toolbar=hui.ui.Toolbar.create({labels:false});F.appendChild(this.toolbar.getElement());var E=hui.ui.Button.create({name:"huiCalendarPrevious",text:"",icon:"monochrome/previous"});E.listen(this);this.toolbar.add(E);var A=hui.ui.Button.create({name:"huiCalendarToday",text:"Idag"});A.click(function(){this.setDate(new Date())}.bind(this));this.toolbar.add(A);var C=hui.ui.Button.create({name:"huiCalendarNext",text:"",icon:"monochrome/next"});C.listen(this);this.toolbar.add(C);this.datePickerButton=hui.ui.Button.create({name:"huiCalendarDatePicker",text:"Vlg dato..."});this.datePickerButton.listen(this);this.toolbar.add(this.datePickerButton);var G=hui.firstByClass(this.body,"hui_calendar_day");for(var B=this.options.startHour;B<=this.options.endHour;B++){var D=hui.build("div",{"class":"hui_calendar_time",html:"<span><em>"+B+":00</em></span>"});if(B==this.options.startHour){hui.addClass(D,"hui_calendar_time_first")}if(B==this.options.endHour){hui.addClass(D,"hui_calendar_time_last")}G.appendChild(D)}},$click$huiCalendarPrevious:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()-7);this.setDate(A)},$click$huiCalendarNext:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()+7);this.setDate(A)},setDate:function(A){this.date=new Date(A.getTime());this.updateUI();this.refresh();if(this.datePicker){this.datePicker.setValue(this.date)}},$click$huiCalendarDatePicker:function(){this.showDatePicker()},refresh:function(){this.clearEvents();this.setBusy(true);var A={"startTime":this.getFirstDay(),"endTime":this.getLastDay()};this.fire("calendarSpanChanged",A);hui.ui.firePropertyChange(this,"startTime",this.getFirstDay());hui.ui.firePropertyChange(this,"endTime",this.getLastDay())},valueForProperty:function(A){if(A=="startTime"){return this.getFirstDay()}if(A=="endTime"){return this.getLastDay()}return this[A]},showDatePicker:function(){if(!this.datePickerPanel){this.datePickerPanel=hui.ui.BoundPanel.create();this.datePicker=hui.ui.DatePicker.create({name:"huiCalendarDatePicker",value:this.date});this.datePicker.listen(this);this.datePickerPanel.add(this.datePicker);this.datePickerPanel.addSpace(3);var A=hui.ui.Button.create({name:"huiCalendarDatePickerClose",text:"Luk",small:true,rounded:true});A.listen(this);this.datePickerPanel.add(A)}this.datePickerPanel.position(this.datePickerButton.getElement());this.datePickerPanel.show()},$click$huiCalendarDatePickerClose:function(){this.datePickerPanel.hide()},$dateChanged$huiCalendarDatePicker:function(A){this.setDate(A)},showEvent:function(B){if(!this.eventViewerPanel){this.eventViewerPanel=hui.ui.BoundPanel.create({width:270,padding:3});this.eventInfo=hui.ui.InfoView.create(null,{height:240,clickObjects:true});this.eventViewerPanel.add(this.eventInfo);this.eventViewerPanel.addSpace(5);var A=hui.ui.Button.create({name:"huiCalendarEventClose",text:"Luk"});A.listen(this);this.eventViewerPanel.add(A)}this.eventInfo.clear();this.eventInfo.setBusy(true);this.eventViewerPanel.position(B);this.eventViewerPanel.show();hui.ui.callDelegates(this,"requestEventInfo");return },updateEventInfo:function(A,B){this.eventInfo.setBusy(false);this.eventInfo.update(B)},$click$huiCalendarEventClose:function(){this.hideEventViewer()},hideEventViewer:function(){if(this.eventViewerPanel){this.eventViewerPanel.hide()}}};hui.ui.DatePicker=function(A){this.name=A.name;this.element=hui.get(A.element);this.options={};hui.override(this.options,A);this.cells=[];this.title=hui.firstByTag(this.element,"strong");this.today=new Date();this.value=this.options.value?new Date(this.options.value.getTime()):new Date();this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);hui.ui.extend(this);this._addBehavior();this._updateUI()};hui.ui.DatePicker.create=function(J){var C=J.element=hui.build("div",{"class":"hui_datepicker",html:'<div class="hui_datepicker_header"><a class="hui_datepicker_next"></a><a class="hui_datepicker_previous"></a><strong></strong></div>'}),H=hui.build("table",{parent:C}),F=hui.build("thead",{parent:H}),G=hui.build("tr",{parent:F});for(var D=0;D<7;D++){G.appendChild(hui.build("th",{text:Date.dayNames[D].substring(0,3)}))}var E=hui.build("tbody",{parent:H});for(var B=0;B<6;B++){var I=hui.build("tr",{parent:E});for(var A=0;A<7;A++){hui.build("td",{parent:I})}}return new hui.ui.DatePicker(J)};hui.ui.DatePicker.prototype={_addBehavior:function(){var A=this;this.cells=hui.byTag(this.element,"td");hui.each(this.cells,function(D,E){hui.listen(D,"mousedown",function(){A._selectCell(E)})});var B=hui.firstByClass(this.element,"hui_datepicker_next");var C=hui.firstByClass(this.element,"hui_datepicker_previous");hui.listen(B,"mousedown",function(){A.next()});hui.listen(C,"mousedown",function(){A.previous()})},setValue:function(A){this.value=new Date(A.getTime());this.viewDate=new Date(A.getTime());this.viewDate.setDate(1);this._updateUI()},_updateUI:function(){hui.dom.setText(this.title,this.viewDate.dateFormat("F Y"));var C=this.value.getFullYear()==this.viewDate.getFullYear();var E=this.viewDate.getMonth();for(var D=0;D<this.cells.length;D++){var B=this._indexToDate(D);var A=this.cells[D];if(B.getMonth()<E){A.className="hui_datepicker_dimmed"}else{if(B.getMonth()>E){A.className="hui_datepicker_dimmed"}else{A.className=""}}if(B.getDate()==this.value.getDate()&&B.getMonth()==this.value.getMonth()&&C){hui.addClass(A,"hui_datepicker_selected")}if(B.getDate()==this.today.getDate()&&B.getMonth()==this.today.getMonth()&&B.getFullYear()==this.today.getFullYear()){hui.addClass(A,"hui_datepicker_today")}hui.dom.setText(A,B.getDate())}},_getPreviousMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()-1);return A},_getNextMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()+1);return A},previous:function(){this.viewDate=this._getPreviousMonth();this._updateUI()},next:function(){this.viewDate=this._getNextMonth();this._updateUI()},_selectCell:function(A){this.value=this._indexToDate(A);this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);this._updateUI();hui.ui.callDelegates(this,"dateChanged",this.value)},_indexToDate:function(B){var D=this.viewDate.getDay(),E=this.viewDate.getDaysInMonth(),C=this._getPreviousMonth().getDaysInMonth(),A;if(B<D){A=this._getPreviousMonth();A.setDate(C-D+B+1)}else{if(B>D+E-1){A=this._getPreviousMonth();A.setDate(B-D-E+1)}else{A=new Date(this.viewDate.getTime());A.setDate(B+1-D)}}return A}};Date.monthNames=["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"];Date.dayNames=["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"];hui.ui.Layout=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);hui.ui.extend(this)};hui.ui.Layout.prototype={$$layout:function(){if(hui.browser.gecko){var C=hui.firstByClass(this.element,"hui_layout_center");if(C){C.style.height="100%"}}if(!hui.browser.msie7&&!hui.browser.msie8&&!hui.browser.msie9){return }if(!hui.dom.isVisible(this.element)){return }if(this.diff===undefined){var G=hui.firstByClass(this.element,"hui_layout_top");var H=hui.firstByTag(G,"*").clientHeight;var F=hui.firstByTag(hui.firstByTag(this.element,"tfoot"),"td");var D=0;if(F){D=hui.firstByTag(F,"*").clientHeight}H+=hui.getTop(this.element);this.diff=D+H;if(this.element.parentNode!==document.body){this.diff+=15}else{}}var E=hui.firstByTag(this.element,"tbody");var B=hui.firstByTag(E,"td");var A=(hui.getViewPortHeight()-this.diff+5);B.style.height=A+"px"}};hui.ui.Columns=function(A){this.name=A.name;this.options=A||{};this.element=hui.get(A.element);this.body=hui.firstByTag(this.element,"tr");hui.ui.extend(this)};hui.ui.Columns.create=function(A){A=A||{};A.element=hui.build("table",{"class":"hui_columns",html:"<tbody><tr></tr></tbody>"});return new hui.ui.Columns(A)};hui.ui.Columns.prototype={addToColumn:function(A,B){var C=this.ensureColumn(A);C.appendChild(B.getElement())},setColumnStyle:function(A,B){var C=this.ensureColumn(A);hui.setStyle(C,B)},setColumnWidth:function(A,B){var C=this.ensureColumn(A);C.style.width=B+"px"},ensureColumn:function(A){var C=hui.getChildren(this.body);for(var B=C.length-1;B<A;B++){this.body.appendChild(hui.build("td",{"class":"hui_columns_column"}))}return hui.getChildren(this.body)[A]}};hui.ui.Dock=function(A){this.options=A;this.element=hui.get(A.element);this.iframe=hui.firstByTag(this.element,"iframe");this.progress=hui.firstByClass(this.element,"hui_dock_progress");this.resizer=hui.firstByClass(this.element,"hui_dock_sidebar_line");hui.listen(this.iframe,"load",this._load.bind(this));this.name=A.name;hui.ui.extend(this);this.diff=-69;if(this.options.tabs){this.diff-=15}this.busy=true;hui.ui.listen(this);this._addBehavior()};hui.ui.Dock.prototype={_addBehavior:function(){if(this.resizer){this.sidebar=hui.firstByClass(this.element,"hui_dock_sidebar");this.main=hui.firstByClass(this.element,"hui_dock_sidebar_main");hui.drag.register({element:this.resizer,onStart:function(){this.hasDragged=false;hui.addClass(this.element,"hui_dock_sidebar_resizing");this._setBusy(true)}.bind(this),onMove:function(B){var A=B.getLeft();if(A<10){A=10}this._updateSidebarWidth(A);if(!this.hasDragged){hui.removeClass(this.element,"hui_dock_sidebar_collapsed")}this.hasDragged=true}.bind(this),onEnd:function(){this._setBusy(false);if(!this.hasDragged){this.toggle()}else{if(this.latestWidth==10){this.collapse()}else{this.latestExpandedWidth=this.latestWidth}}hui.removeClass(this.element,"hui_dock_sidebar_resizing");hui.ui.callVisible(this);hui.ui.reLayout()}.bind(this)})}},_updateSidebarWidth:function(A){this.latestWidth=A;this.sidebar.style.width=(A-1)+"px";this.main.style.left=A+"px";this.resizer.style.left=(A-5)+"px"},setUrl:function(A){this._setBusy(true);hui.getFrameDocument(this.iframe).location.href="about:blank";hui.getFrameDocument(this.iframe).location.href=A},collapse:function(){hui.addClass(this.element,"hui_dock_sidebar_collapsed");this._updateSidebarWidth(10);hui.ui.callVisible(this)},expand:function(){hui.removeClass(this.element,"hui_dock_sidebar_collapsed");this._updateSidebarWidth(this.latestExpandedWidth||200);hui.ui.callVisible(this)},toggle:function(){if(hui.hasClass(this.element,"hui_dock_sidebar_collapsed")){this.expand()}else{this.collapse()}},_load:function(){this._setBusy(false)},_setBusy:function(A){if(A){hui.setStyle(this.progress,{display:"block",height:this.iframe.clientHeight+"px",width:this.iframe.clientWidth+"px"})}else{this.progress.style.display="none"}},$frameLoaded:function(A){if(A==hui.getFrameWindow(this.iframe)){this._setBusy(false)}},$$layout:function(){var A=hui.getViewPortHeight();this.iframe.style.height=(A+this.diff)+"px";this.progress.style.width=(this.iframe.clientWidth)+"px";this.progress.style.height=(A+this.diff)+"px"}};hui.ui.Box=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);this.body=hui.firstByClass(this.element,"hui_box_body");this.close=hui.firstByClass(this.element,"hui_box_close");this.visible=!this.options.absolute;if(this.close){hui.listen(this.close,"click",function(B){hui.stop(B);this.hide();this.fire("boxWasClosed")}.bind(this))}hui.ui.extend(this)};hui.ui.Box.create=function(A){A=A||{};A.element=hui.build("div",{"class":A.absolute?"hui_box hui_box_absolute":"hui_box",html:(A.closable?'<a class="hui_box_close" href="#"></a>':"")+'<div class="hui_box_top"><div><div></div></div></div><div class="hui_box_middle"><div class="hui_box_middle">'+(A.title?'<div class="hui_box_header"><strong class="hui_box_title">'+hui.escape(A.title)+"</strong></div>":"")+'<div class="hui_box_body" style="'+(A.padding?"padding: "+A.padding+"px;":"")+(A.width?"width: "+A.width+"px;":"")+'"></div></div></div><div class="hui_box_bottom"><div><div></div></div></div>',style:A.width?A.width+"px":null});return new hui.ui.Box(A)};hui.ui.Box.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(A){if(A.getElement){this.body.appendChild(A.getElement())}else{this.body.appendChild(A)}},show:function(){var D=this.element;if(this.options.modal){var B=hui.ui.nextPanelIndex();D.style.zIndex=B+1;hui.ui.showCurtain({widget:this,zIndex:B})}if(this.options.absolute){hui.setStyle(D,{display:"block",visibility:"hidden"});var A=D.clientWidth;var C=(hui.getViewPortHeight()-D.clientHeight)/2+hui.getScrollTop();hui.setStyle(D,{"marginLeft":(A/-2)+"px",top:C+"px"});hui.setStyle(D,{display:"block",visibility:"visible"})}else{D.style.display="block"}this.visible=true;hui.ui.callVisible(this)},$$layout:function(){if(this.options.absolute&&this.visible){var C=this.element;var A=C.clientWidth;var B=(hui.getViewPortHeight()-C.clientHeight)/2+hui.getScrollTop();hui.setStyle(C,{"marginLeft":(A/-2)+"px",top:B+"px"})}},hide:function(){hui.ui.hideCurtain(this);this.element.style.display="none";this.visible=false;hui.ui.callVisible(this)},curtainWasClicked:function(){this.fire("boxCurtainWasClicked")}};hui.ui.Wizard=function(A){this.options=A||{};this.element=hui.get(A.element);this.name=A.name;this.container=hui.firstByClass(this.element,"hui_wizard_steps");this.steps=hui.byClass(this.element,"hui_wizard_step");this.anchors=hui.byClass(this.element,"hui_wizard_selection");this.selected=0;hui.ui.extend(this);this._addBehavior()};hui.ui.Wizard.prototype={_addBehavior:function(){var A=this;hui.each(this.anchors,function(C,B){hui.listen(C,"mousedown",function(D){hui.stop(D);A.goToStep(B)});hui.listen(C,"click",function(D){hui.stop(D)})})},getStep:function(){return this.selected},goToStep:function(A){var B=this.container;B.style.height=B.clientHeight+"px";hui.removeClass(this.anchors[this.selected],"hui_selected");this.steps[this.selected].style.display="none";hui.addClass(this.anchors[A],"hui_selected");this.steps[A].style.display="block";this.selected=A;hui.animate(B,"height",this.steps[A].clientHeight+"px",500,{ease:hui.ease.slowFastSlow,onComplete:function(){B.style.height=""}});hui.ui.callVisible(this);this.fire("stepChanged",this.selected)},isFirst:function(){return this.selected==0},isLast:function(){return this.selected==this.steps.length-1},next:function(){if(this.selected<this.steps.length-1){this.goToStep(this.selected+1)}},previous:function(){if(this.selected>0){this.goToStep(this.selected-1)}}};hui.ui.Input=function(A){this.options=hui.override({placeholderElement:null,validator:null},A);var B=this.element=hui.get(A.element);this.element.setAttribute("autocomplete","off");this.value=this._validate(this.element.value);this.isPassword=this.element.type=="password";this.name=A.name;hui.ui.extend(this);this._addBehavior();if(this.options.placeholderElement&&this.value!=""){hui.ui.fadeOut(this.options.placeholderElement,0)}this._checkPlaceholder();try{if(B==document.activeElement){this._focused()}}catch(B){}};hui.ui.Input.prototype={_addBehavior:function(){var B=this.element,A=this.options.placeholderElement;hui.listen(B,"keyup",this.keyDidStrike.bind(this));hui.listen(B,"blur",this.onBlur.bind(this));if(A){hui.listen(B,"focus",this._focused.bind(this));hui.listen(B,"blur",this._checkPlaceholder.bind(this));if(A){A.style.cursor="text";hui.listen(A,"mousedown",this.focus.bind(this));hui.listen(A,"click",this.focus.bind(this))}}if(B.type=="submit"){hui.listen(B,"click",function(C){this.fire("click",C)}.bind(this))}},_focused:function(){var B=this.element,A=this.options.placeholderElement;if(A&&B.value==""){hui.ui.fadeOut(A,0)}},_validate:function(C){var B=this.options.validator;var A;if(B){A=B.validate(C);hui.setClass(this.element,"hui_invalid",!A.valid);return A.value}return C},_checkPlaceholder:function(){if(this.options.placeholderElement&&this.value==""){hui.ui.fadeIn(this.options.placeholderElement,200)}if(this.isPassword&&!hui.browser.msie){this.element.type="password"}},keyDidStrike:function(){if(this.value!==this.element.value){var A=this._validate(this.element.value);var B=A!==this.value;this.value=A;if(B){this.fire("valueChanged",this.value)}}},onBlur:function(){hui.removeClass(this.element,"hui_invalid");this.element.value=this.value||""},getValue:function(){return this.value},setValue:function(A){if(A===undefined||A===null){A=""}this.element.value=A;this.value=this._validate(A)},isEmpty:function(){return this.value==""},isBlank:function(){return hui.isBlank(this.value)},focus:function(){this.element.focus()},setError:function(A){var B=A?true:false;hui.setClass(this.element,"hui_field_error",B);if(typeof (A)=="string"){hui.ui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){hui.ui.hideToolTip({key:this.name})}}};hui.ui.InfoView=function(A){this.options=hui.override({clickObjects:false},A);this.element=hui.get(A.element);this.body=hui.firstByTag(this.element,"tbody");this.name=A.name;hui.ui.extend(this)};hui.ui.InfoView.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_infoview",html:"<table><tbody></tbody></table>"});if(A.height){hui.setStyle(B,{height:A.height+"px","overflow":"auto","overflowX":"hidden"})}if(A.margin){B.style.margin=A.margin+"px"}return new hui.ui.InfoView(A)};hui.ui.InfoView.prototype={addHeader:function(B){var A=hui.build("tr",{parent:this.body});hui.build("th",{"class":"hui_infoview_header",colspan:"2",text:B,parent:A})},addProperty:function(A,C){var B=hui.build("tr",{parent:this.body});hui.build("th",{parent:B,text:A});hui.build("td",{parent:B,text:C})},addObjects:function(B,D){if(!D||D.length==0){return }var E=hui.build("tr",{parent:this.body});E.appendChild(hui.build("th",{text:B}));var A=hui.build("td",{parent:E});var C=this.options.clickObjects;hui.each(D,function(G){var F=hui.build("div",{text:G.title,parent:A});if(C){hui.addClass(F,"hui_infoview_click");hui.listen(F,"click",function(){hui.ui.callDelegates(this,"objectWasClicked",G)})}})},setBusy:function(A){hui.setClass(this,element,"hui_infoview_busy",A)},clear:function(){hui.dom.clear(this.body)},update:function(B){this.clear();for(var A=0;A<B.length;A++){switch(B[A].type){case"header":this.addHeader(B[A].value);break;case"property":this.addProperty(B[A].label,B[A].value);break;case"objects":this.addObjects(B[A].label,B[A].value);break}}}};hui.ui.Overflow=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Overflow.create=function(A){A=A||{};var B=A.element=hui.build("div",{"class":"hui_overflow"});if(A.height){B.style.height=A.height+"px"}return new hui.ui.Overflow(A)};hui.ui.Overflow.prototype={_calculate:function(){var A=hui.getViewPortHeight(),D=this.element.parentNode,F=hui.getTop(this.element),B=hui.getTop(D)+D.clientHeight,E=hui.getAllNext(this.element);for(var C=0;C<E.length;C++){if(hui.getStyle(E[C],"position")!="absolute"){B-=E[C].clientHeight}}this.diff=-1*(F+(A-B));if(hui.browser.webkit&&this.element.parentNode.className=="hui_layout_center"){this.diff++}},show:function(){this.element.style.display="";hui.ui.callVisible(this)},hide:function(){this.element.style.display="none";hui.ui.callVisible(this)},add:function(A){if(A.getElement){this.element.appendChild(A.getElement())}else{this.element.appendChild(A)}return this},$$layoutChanged:function(){if(!this.options.dynamic){return }this.element.style.height="0px";window.setTimeout(function(){this._calculate();this.$$layout()}.bind(this))},$$layout:function(){var A;if(!this.options.dynamic){if(this.options.vertical){A=hui.getViewPortHeight();this.element.style.height=Math.max(0,A-this.options.vertical)+"px"}return }if(this.diff===undefined){this._calculate()}A=hui.getViewPortHeight();this.element.style.height=Math.max(0,A+this.diff)+"px"}};hui.ui.SearchField=function(A){this.options=hui.override({expandedWidth:null},A);this.element=hui.get(A.element);this.name=A.name;this.field=hui.firstByTag(this.element,"input");this.value=this.field.value;this.adaptive=hui.hasClass(this.element,"hui_searchfield_adaptive");hui.ui.onReady(function(){this.initialWidth=parseInt(hui.getStyle(this.element,"width"))}.bind(this));hui.ui.extend(this);this.addBehavior();this.updateClass()};hui.ui.SearchField.create=function(A){A=A||{};A.element=hui.build("span",{"class":A.adaptive?"hui_searchfield hui_searchfield_adaptive":"hui_searchfield",html:'<em class="hui_searchfield_placeholder"></em><a href="javascript:void(0);" class="hui_searchfield_reset"></a><span><span><input type="text"/></span></span>'});return new hui.ui.SearchField(A)};hui.ui.SearchField.prototype={addBehavior:function(){var B=this;hui.listen(this.field,"keyup",this.onKeyUp.bind(this));var C=hui.firstByTag(this.element,"a");C.tabIndex=-1;if(!hui.browser.ipad){var A=function(){B.field.focus();B.field.select()};hui.listen(this.element,"mousedown",A);hui.listen(this.element,"mouseup",A);hui.listen(hui.firstByTag(this.element,"em"),"mousedown",A)}else{var A=function(){B.field.focus()};hui.listen(hui.firstByTag(this.element,"em"),"click",A)}hui.listen(C,"mousedown",function(D){hui.stop(D);B.reset();A()});hui.listen(this.field,"focus",function(){B.focused=true;B.updateClass()});hui.listen(this.field,"blur",function(){B.focused=false;B.updateClass()});if(this.options.expandedWidth>0){this.field.onfocus=function(){hui.animate(B.element,"width",B.options.expandedWidth+"px",500,{ease:hui.ease.slowFastSlow})};this.field.onblur=function(){hui.animate(B.element,"width",B.initialWidth+"px",500,{ease:hui.ease.slowFastSlow,delay:100})}}},onKeyUp:function(A){this.fieldChanged();if(A.keyCode===hui.KEY_RETURN){this.fire("submit")}},setValue:function(A){this.field.value=A===undefined||A===null?"":A;this.fieldChanged()},getValue:function(){return this.field.value},isEmpty:function(){return this.field.value==""},isBlank:function(){return hui.isBlank(this.field.value)},reset:function(){this.field.value="";this.fieldChanged()},updateClass:function(){var A="hui_searchfield";if(this.adaptive){A+=" hui_searchfield_adaptive"}if(this.focused&&this.value!=""){A+=" hui_searchfield_focus_dirty"}else{if(this.focused){A+=" hui_searchfield_focus"}else{if(this.value!=""){A+=" hui_searchfield_dirty"}}}this.element.className=A},fieldChanged:function(){if(this.field.value!=this.value){this.value=this.field.value;this.updateClass();this.fire("valueChanged",this.value);hui.ui.firePropertyChange(this,"value",this.value)}}};hui.ui.Fragment=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Fragment.prototype={show:function(){this.element.style.display="block";hui.ui.callVisible(this)},hide:function(){this.element.style.display="none";hui.ui.callVisible(this)}};hui.ui.LocationPicker=function(A){A=A||{};this.name=A.name;this.options=A.options||{};this.element=hui.get(A.element);this.backendLoaded=false;this.defered=[];hui.ui.extend(this)};hui.ui.LocationPicker.prototype={show:function(B){if(!this.panel){var A=this.panel=hui.ui.BoundPanel.create({width:300});var E=hui.build("div",{style:"width:300px;height:300px"});A.add(E);var D=hui.ui.Buttons.create({align:"right",top:5});var C=hui.ui.Button.create({text:"Luk"});C.listen({$click:function(){A.hide()}});A.add(D.add(C));hui.setStyle(A.element,{left:"-10000px",top:"-10000px",display:""});this._whenReady(function(){var F={zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN};this.defaultCenter=new google.maps.LatLng(57.0465,9.9185);this.map=new google.maps.Map(E,F);google.maps.event.addListener(this.map,"click",function(G){var H={latitude:G.latLng.lat(),longitude:G.latLng.lng()};this.setLocation(H);this.fire("locationChanged",H)}.bind(this));this.setLocation(B.location)}.bind(this))}if(B.node){this.panel.position(B.node)}this.panel.show()},_whenReady:function(A){if(this.backendLoaded){A();return }this.defered.push(A);if(this.loadingBackend){return }this.loadingBackend=true;window.huiLocationPickerReady=function(){this.loadingBackend=false;this.backendLoaded=true;hui.log("Google maps loaded!");for(var B=0;B<this.defered.length;B++){this.defered[B]()}window.huiLocationPickerReady=null}.bind(this);hui.log("Loading google maps...");hui.require("http://maps.google.com/maps/api/js?sensor=false&callback=huiLocationPickerReady")},setLocation:function(A){this._whenReady(function(){hui.log("Setting location...");if(!A&&this.marker){this.marker.setMap(null);this.map.setCenter(this.defaultCenter);return }A=this._buildLatLng(A);if(!this.marker){this.marker=new google.maps.Marker({position:A,map:this.map})}else{this.marker.setPosition(A);this.marker.setMap(this.map)}this.map.setCenter(A)}.bind(this))},_buildLatLng:function(A){if(!A){A={latitude:57.0465,longitude:9.9185}}return new google.maps.LatLng(A.latitude,A.longitude)}};hui.ui.Bar=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);this.visible=this.element.style.display=="none"?false:null;this.body=hui.firstByClass(this.element,"hui_bar_body");hui.ui.extend(this)};hui.ui.Bar.create=function(B){B=B||{};var A="hui_bar";if(B.variant){A+=" hui_bar_"+B.variant}if(B.absolute){A+=" hui_bar_absolute"}B.element=hui.build("div",{"class":A});hui.build("div",{"class":"hui_bar_body",parent:B.element});return new hui.ui.Bar(B)};hui.ui.Bar.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(A){this.body.appendChild(A.getElement())},addDivider:function(){hui.build("span",{"class":"hui_bar_divider",parent:this.body})},placeAbove:function(A){if(A.getElement){A=A.getElement()}hui.place({source:{element:this.element,vertical:1,horizontal:0},target:{element:A,vertical:0,horizontal:0}});this.element.style.zIndex=hui.ui.nextTopIndex()},setVisible:function(A){if(this.visible===A){return }if(A){this.show()}else{this.hide()}},show:function(){if(this.options.absolute){this.element.style.visibility="visible"}else{this.element.style.display="";hui.ui.reLayout()}this.visible=true},hide:function(){if(this.options.absolute){this.element.style.visibility="hidden"}else{this.element.style.display="none";hui.ui.reLayout()}this.visible=false}};hui.ui.Bar.Button=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.element,"mousedown",this._mousedown.bind(this));hui.listen(this.element,"mouseup",function(B){hui.stop(B)});hui.ui.extend(this)};hui.ui.Bar.Button.create=function(A){A=A||{};var B=A.element=hui.build("a",{"class":"hui_bar_button"});if(A.icon){B.appendChild(hui.ui.createIcon(A.icon,16))}return new hui.ui.Bar.Button(A)};hui.ui.Bar.Button.prototype={_mousedown:function(A){this.fire("mousedown");if(this.options.stopEvents){hui.stop(A)}},_click:function(A){this.fire("click");if(this.options.stopEvents){hui.stop(A)}},setSelected:function(A){hui.setClass(this.element,"hui_bar_button_selected",A)}};hui.ui.Bar.Text=function(A){this.options=hui.override({},A);this.name=A.name;this.element=hui.get(A.element);hui.ui.extend(this)};hui.ui.Bar.Text.prototype={setText:function(A){hui.dom.setText(this.element,A)}};hui.ui.IFrame=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.IFrame.prototype={setUrl:function(A){this.element.setAttribute("src",A)},clear:function(){this.setUrl("about:blank")},getDocument:function(){return hui.getFrameDocument(this.element)},getWindow:function(){return hui.getFrameWindow(this.element)},reload:function(){this.getWindow().location.reload()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};hui.ui.VideoPlayer=function(A){this.options=A;this.element=hui.get(A.element);this.placeholder=hui.firstByTag(this.element,"div");this.name=A.name;this.state={duration:0,time:0,loaded:0};this.handlers=[hui.ui.VideoPlayer.HTML5,hui.ui.VideoPlayer.QuickTime,hui.ui.VideoPlayer.Embedded];this.handler=null;hui.ui.extend(this);if(this.options.video){if(this.placeholder){hui.listen(this.placeholder,"click",function(){this.setVideo(this.options.video)}.bind(this))}else{hui.ui.onReady(function(){this.setVideo(this.options.video)}.bind(this))}}};hui.ui.VideoPlayer.prototype={setVideo:function(A){if(this.placeholder){this.placeholder.style.display="none"}this.handler=this.getHandler(A);this.element.appendChild(this.handler.element);if(this.handler.showController()){this.buildController()}},getHandler:function(C){for(var A=0;A<this.handlers.length;A++){var B=this.handlers[A];if(B.isSupported(C)){return new B(C,this)}}},buildController:function(){var A=hui.build("div",{"class":"hui_videoplayer_controller",parent:this.element});this.playButton=hui.build("a",{href:"javascript:void(0);","class":"hui_videoplayer_playpause",text:"wait!",parent:A});hui.listen(this.playButton,"click",this.playPause.bind(this));this.status=hui.build("span",{"class":"hui_videoplayer_status",parent:A})},onCanPlay:function(){this.playButton.update("Play")},onLoad:function(){this.state.loaded=this.state.duration;this.updateStatus()},onDurationChange:function(A){this.state.duration=A;this.updateStatus()},onTimeChange:function(A){this.state.time=A;this.updateStatus()},onLoadProgressChange:function(A){this.state.loaded=A;this.updateStatus()},playPause:function(){if(this.handler.isPlaying()){this.pause()}else{this.play()}},play:function(){this.handler.play()},pause:function(){this.handler.pause()},updateStatus:function(){this.status.innerHTML=this.state.time+" / "+this.state.duration+" / "+this.state.loaded}};hui.ui.VideoPlayer.HTML5=function(B,A){var C=this.element=hui.build("video",{width:B.width,height:B.height,src:B.src});hui.listen(C,"load",A.onLoad.bind(A));hui.listen(C,"canplay",A.onCanPlay.bind(A));hui.listen(C,"durationchange",function(D){A.onDurationChange(C.duration)});hui.listen(C,"timeupdate",function(){A.onTimeChange(this.element.currentTime)}.bind(this))};hui.ui.VideoPlayer.HTML5.isSupported=function(A){if(hui.browser.webkitVersion>528&&(A.type==="video/quicktime"||A.type==="video/mp4")){return true}return false};hui.ui.VideoPlayer.HTML5.prototype={showController:function(){return true},pause:function(){this.element.pause()},play:function(){this.element.play()},getTime:function(){return this.element.currentTime},isPlaying:function(){return !this.element.paused}};hui.ui.VideoPlayer.QuickTime=function(B,A){this.player=A;var C=this.element=hui.build("object",{width:B.width,height:B.height,data:B.src,type:"video/quicktime"});C.innerHTML='<param value="false" name="controller"/><param value="true" name="enablejavascript"/><param value="undefined" name="posterframe"/><param value="false" name="showlogo"/><param value="false" name="autostart"/><param value="true" name="cache"/><param value="white" name="bgcolor"/><param value="false" name="aggressivecleanup"/><param value="true" name="saveembedtags"/><param value="true" name="postdomevents"/>';hui.listen(C,"qt_canplay",A.onCanPlay.bind(A));hui.listen(C,"qt_load",A.onLoad.bind(A));hui.listen(C,"qt_progress",function(){A.onLoadProgressChange(C.GetMaxTimeLoaded()/3000)});hui.listen(C,"qt_durationchange",function(D){A.onDurationChange(C.GetDuration()/3000)});hui.listen(C,"qt_timechanged",function(){A.onTimeChange(C.GetTime())})};hui.ui.VideoPlayer.QuickTime.isSupported=function(A){return A.html==undefined};hui.ui.VideoPlayer.QuickTime.prototype={showController:function(){return true},pause:function(){window.clearInterval(this.observer);this.element.Stop()},play:function(){this.element.Play();this.observer=window.setInterval(this.observeVideo.bind(this),100)},observeVideo:function(){this.player.onTimeChange(this.element.GetTime()/3000)},getTime:function(){return this.element.GetTime()},isPlaying:function(){return this.element.GetRate()!==0}};hui.ui.VideoPlayer.Embedded=function(B,A){this.element=hui.build("div",{width:B.width,height:B.height,html:B.html})};hui.ui.VideoPlayer.Embedded.isSupported=function(A){return A.html!==undefined};hui.ui.VideoPlayer.Embedded.prototype={showController:function(){return false},pause:function(){},play:function(){},getTime:function(){},isPlaying:function(){}};hui.ui.Segmented=function(A){this.options=hui.override({value:null,allowNull:false},A);this.element=hui.get(A.element);this.name=A.name;this.value=this.options.value;hui.ui.extend(this);hui.listen(this.element,"mousedown",this.onClick.bind(this))};hui.ui.Segmented.prototype={onClick:function(E){E=new hui.Event(E);var B=E.findByTag("a");if(B){var F=false;var D=B.getAttribute("rel");var A=hui.byClass(this.element,"hui_segmented_selected");for(var C=0;C<A.length;C++){hui.removeClass(A[C],"hui_segmented_selected")}if(D===this.value&&this.options.allowNull){F=true;this.value=null}else{hui.addClass(B,"hui_segmented_selected");F=this.value!==D;this.value=D}if(F){this.fire("valueChanged",this.value);hui.ui.firePropertyChange(this,"value",this.value)}}},setValue:function(C){if(C===undefined){C=null}var A=this.element.getElementsByTagName("a");this.value=null;for(var B=0;B<A.length;B++){if(A[B].getAttribute("rel")===C){hui.addClass(A[B],"hui_segmented_selected");this.value=C}else{hui.removeClass(A[B],"hui_segmented_selected")}}},getValue:function(){return this.value}};hui.ui.Flash={fullVersion:undefined,getMajorVersion:function(){var B=this.getFullVersion();if(B===null||B===undefined){return null}var A=(B+"").match(/[0-9]+/gi);return A.length>0?parseInt(A[0]):null},getFullVersion:function(){if(this.fullVersion!==undefined){return this.fullVersion}var G=null;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];var D=E[3];if(D==""){D=E[4]}if(D[0]=="d"){D=D.substring(1)}else{if(D[0]=="r"){D=D.substring(1);if(D.indexOf("d")>0){D=D.substring(0,D.indexOf("d"))}}}G=H+"."+B+"."+D}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2}else{if(hui.browser.msie){G=this.getActiveXVersion()}}}}}this.fullVersion=G;return G},getActiveXVersion:function(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version")}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0"}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11"}catch(C){A=-1}}return A}};hui.ui.Link=function(A){this.options=A;this.name=A.name;this.element=hui.get(A.element);hui.ui.extend(this);this.addBehavior()};hui.ui.Link.prototype={addBehavior:function(){var A=this;hui.listen(this.element,"click",function(B){hui.stop(B);window.setTimeout(function(){A.fire("click")})})}};hui.ui.Links=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this);this.items=[];this.addBehavior();this.selectedIndex=null;this.inputs={}};hui.ui.Links.prototype={addBehavior:function(){hui.listen(this.element,"click",this.onClick.bind(this));hui.listen(this.element,"dblclick",this.onDblClick.bind(this))},reset:function(){this.setValue([])},setValue:function(A){this.items=A;this.selectedIndex=null;this.build()},getValue:function(){return this.items},onDblClick:function(D){D=new hui.Event(D);hui.selection.clear();D.stop(D);var B=this.selectAndGetRow(D);var A={text:B.text};A[B.kind]=B.value;this.editedLink=B;var C=this.getEditWindow();this.editForm.reset();this.editForm.setValues(A);C.show()},onClick:function(B){B=new hui.Event(B);B.stop();var A=B.getElement();if(hui.hasClass(A,"hui_links_remove")){var C=B.findByClass("hui_links_row");hui.ui.confirmOverlay({element:A,text:"Vil du fjerne linket?",okText:"Ja, fjern",cancelText:"Annuller",onOk:function(){this.items.splice(C.hui_index,1);if(this.selectedIndex===C.hui_index){this.selectedIndex=null}this.build()}.bind(this)})}else{this.selectAndGetRow(B)}},selectAndGetRow:function(C){var D=C.findByClass("hui_links_row");if(D){var B=D.hui_index;if(this.selectedIndex!==null){var A=hui.byClass(this.element,"hui_links_row")[this.selectedIndex];hui.removeClass(A,"hui_links_row_selected")}this.selectedIndex=B;hui.addClass(D,"hui_links_row_selected");return this.items[B]}},build:function(){var E=this.list||hui.firstByClass(this.element,"hui_links_list"),B,D,G,C,F,A;E.innerHTML="";for(B=0;B<this.items.length;B++){D=this.items[B];G=hui.build("div",{"class":"hui_links_row"});G.hui_index=B;G.appendChild(hui.ui.createIcon(D.icon,16));F=hui.build("div",{"class":"hui_links_text",text:D.text});G.appendChild(F);C=hui.build("div",{"class":"hui_links_info",text:hui.wrap(D.info)});G.appendChild(C);A=hui.ui.createIcon("monochrome/delete",16);hui.addClass(A,"hui_links_remove");G.appendChild(A);E.appendChild(G)}},addLink:function(){this.editedLink=null;this.getEditWindow().show();this.editForm.reset();this.editForm.focus()},getEditWindow:function(){if(!this.editWindow){var F=this.editWindow=hui.ui.Window.create({title:"Link",width:300,padding:5});var E=this.editForm=hui.ui.Formula.create();var D=E.buildGroup({above:false},[{type:"TextField",options:{label:"Tekst",key:"text"}}]);var C=hui.ui.TextField.create({label:"URL",key:"url"});D.add(C);this.inputs["url"]=C;var B=hui.ui.TextField.create({label:"E-mail",key:"email"});D.add(B);this.inputs["email"]=B;page=hui.ui.DropDown.create({label:"Side",key:"page",source:this.options.pageSource});D.add(page);this.inputs["page"]=page;file=hui.ui.DropDown.create({label:"Fil",key:"file",source:this.options.fileSource});D.add(file);this.inputs["file"]=file;var A=this;hui.each(this.inputs,function(G,H){H.listen({$valueChanged:function(){A.changeType(G)}})});D.createButtons().add(hui.ui.Button.create({text:"Gem",submit:true,highlighted:true}));this.editForm.listen({$submit:this.saveLink.bind(this)});F.add(E);if(this.options.pageSource){this.options.pageSource.refresh()}if(this.options.fileSource){this.options.fileSource.refresh()}}return this.editWindow},saveLink:function(){var A=this.editForm.getValues();var B=this.valuesToLink(A);var C=this.editedLink;if(C){hui.override(C,B)}else{this.items.push(B)}this.build();this.editForm.reset();this.editWindow.hide();this.editedLink=null},valuesToLink:function(A){var B={};B.text=A.text;if(A.email!=""){B.kind="email";B.value=A.email;B.info=A.email;B.icon="monochrome/email"}else{if(A.url!=""){B.kind="url";B.value=A.url;B.info=A.url;B.icon="monochrome/globe"}else{if(hui.isDefined(A.page)){B.kind="page";B.value=A.page;B.info=this.inputs["page"].getItem().title;B.icon="common/page"}else{if(hui.isDefined(A.file)){B.kind="file";B.value=A.file;B.info=this.inputs["file"].getItem().title;B.icon="monochrome/file"}}}}return B},changeType:function(A){hui.each(this.inputs,function(B,C){if(B!=A){C.setValue()}})}};hui.ui.MarkupEditor=function(A){this.name=A.name;this.options=hui.override({debug:false,value:"",autoHideToolbar:true,style:"font-family: sans-serif; font-size: 11px;"},A);if(this.options.replace){this.options.replace=hui.get(A.replace);this.options.element=hui.build("div",{className:"hui_markupeditor "+this.options.replace.className});this.options.replace.parentNode.insertBefore(this.options.element,this.options.replace);this.options.replace.style.display="none";this.options.value=this.options.replace.innerHTML}this.ready=false;this.pending=[];this.element=hui.get(this.options.element);if(hui.browser.msie){this.impl=hui.ui.MarkupEditor.MSIE}else{this.impl=hui.ui.MarkupEditor.webkit}this.impl.initialize({element:this.element,controller:this});if(this.options.value){this.setValue(this.options.value)}hui.ui.extend(this)};hui.ui.MarkupEditor.create=function(A){A=A||{};A.element=hui.build("div",{className:"hui_markupeditor"});return new hui.ui.MarkupEditor(A)};hui.ui.MarkupEditor.prototype={implIsReady:function(){this.ready=true;for(var A=0;A<this.pending.length;A++){this.pending[A]()}},implFocused:function(){this._showBar()},implBlurred:function(){this.bar.hide();this.fire("blur")},implValueChanged:function(){this._valueChanged()},destroy:function(){hui.dom.remove(this.element);hui.ui.destroy(this)},getValue:function(){return this.impl.getHTML()},setValue:function(A){this._whenReady(function(){this.impl.setHTML(A)}.bind(this))},focus:function(){this._whenReady(this.impl.focus.bind(this.impl))},_whenReady:function(A){if(this.ready){A()}else{this.pending.push(A)}},_showBar:function(){if(!this.bar){var A=[{key:"bold",icon:"edit/text_bold"},{key:"italic",icon:"edit/text_italic"},{divider:true},{key:"color",icon:"common/color"},{key:"addLink",icon:"monochrome/link"},{divider:true},{key:"align",value:"left",icon:"edit/text_align_left"},{key:"align",value:"center",icon:"edit/text_align_center"},{key:"align",value:"right",icon:"edit/text_align_right"},{key:"align",value:"justify",icon:"edit/text_align_justify"},{divider:true},{key:"clear",icon:"edit/clear"}];this.bar=hui.ui.Bar.create({absolute:true,variant:"mini",small:true});hui.each(A,function(C){if(C.divider){this.bar.addDivider();return }var B=new hui.ui.Bar.Button.create({icon:C.icon,stopEvents:true});B.listen({$mousedown:function(){this._buttonClicked(C)}.bind(this)});this.bar.add(B)}.bind(this));this.bar.addToDocument()}hui.log("Showing bar");this.bar.placeAbove(this);this.bar.show()},_buttonClicked:function(A){this.impl.saveSelection();if(A.key=="color"){this._showColorPicker()}else{if(A.key=="addLink"){this._showLinkEditor()}else{if(A.key=="align"){this.impl.align(A.value)}else{if(A.key=="clear"){this.impl.removeFormat()}else{this.impl.format(A)}}}}this._valueChanged();this.impl.restoreSelection()},_showColorPicker:function(){if(!this.colorPicker){this.colorPicker=hui.ui.Window.create();var A=hui.ui.ColorPicker.create();A.listen(this);this.colorPicker.add(A);this.colorPicker.listen({$userClosedWindow:function(){this.impl.restoreSelection()}.bind(this)})}this.colorPicker.show({avoid:this.element})},_highlightNode:function(A){if(this._highlightedNode){hui.removeClass(this._highlightedNode,"hui_markupeditor_highlighted")}this._highlightedNode=A;if(A){hui.addClass(A,"hui_markupeditor_highlighted")}},_showLinkEditor:function(){this.temporaryLink=this.impl.getOrCreateLink();this._highlightNode(this.temporaryLink);if(this.options.linkDelegate){var B=this.options.linkDelegate;B.editLink({node:this.temporaryLink,onSuccess:function(){this._highlightNode(null);this.temporaryLink=null;hui.log("success");this._valueChanged()}.bind(this),onCancel:function(){this._highlightNode(null);hui.log("cancelled");this.temporaryLink=null;this._valueChanged()}.bind(this)})}else{if(!this.linkEditor){this.linkEditor=hui.ui.Window.create({padding:5,width:300});this.linkForm=hui.ui.Formula.create();this.linkEditor.add(this.linkForm);var D=this.linkForm.buildGroup({},[{type:"TextField",options:{key:"url",label:"Address:"}}]);var C=D.createButtons();var A=hui.ui.Button.create({text:"OK",submit:true});this.linkForm.listen({$submit:this._updateLink.bind(this)});C.add(A)}}if(this.linkEditor){this.linkForm.setValues({url:this.temporaryLink.href});this.linkEditor.show({avoid:this.element});this.linkForm.focus()}},_updateLink:function(){var A=this.linkForm.getValues();this.temporaryLink.href=A.url;this.linkForm.reset();this.temporaryLink=null;this.linkEditor.hide();this._valueChanged()},_valueChanged:function(){this.fire("valueChanged",this.impl.getHTML())},$colorWasSelected:function(A){this.impl.restoreSelection(function(){this.impl.colorize(A);this._valueChanged()}.bind(this))}};hui.ui.MarkupEditor.webkit={initialize:function(A){this.element=A.element;this.element.style.overflow="auto";this.element.contentEditable=true;var B=this.controller=A.controller;hui.listen(this.element,"focus",function(){hui.log("Webkit focus");B.implFocused()});hui.listen(this.element,"blur",function(){B.implBlurred()});hui.listen(this.element,"keyup",this._keyUp.bind(this));B.implIsReady()},saveSelection:function(){},restoreSelection:function(A){if(A){A()}},focus:function(){this.element.focus()},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{document.execCommand(A.key,null,A.value)}}},getOrCreateLink:function(){var A=this._getSelectedNode();if(A&&A.tagName.toLowerCase()=="a"){return A}document.execCommand("createLink",null,"#");return this._getSelectedNode()},_getSelectedNode:function(){var C=window.getSelection();var A=C.getRangeAt(0);var B=A.commonAncestorContainer;if(!hui.dom.isElement(B)){B=B.parentNode}return B},colorize:function(A){document.execCommand("forecolor",null,A)},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};document.execCommand(A[B],null,null)},_keyUp:function(){this.controller.implValueChanged();this._selectionChanged()},_wrapInTag:function(A){var D=window.getSelection();if(D.rangeCount<1){return }var B=D.getRangeAt(0);var C=B.commonAncestorContainer;if(!hui.dom.isElement(C)){C=C.parentNode}if(C.tagName.toLowerCase()==A){this._unWrap(C)}else{var E=document.createElement(A);B.surroundContents(E);D.selectAllChildren(E)}},_getInlineTag:function(){var A=window.getSelection();if(A.rangeCount<1){return }},_unWrap:function(B){var C=B.childNodes;for(var A=0;A<C.length;A++){B.parentNode.insertBefore(C[A],B)}B.parentNode.removeChild(B)},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},_selectionChanged:function(){hui.log({bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic")})},removeFormat:function(){document.execCommand("removeFormat",null,null)},setHTML:function(A){hui.log("Setting html");this.element.innerHTML=A},getHTML:function(){var A=hui.ui.MarkupEditor.util.clean(this.element);return A.innerHTML}};hui.ui.MarkupEditor.MSIE={initialize:function(A){this.element=A.element;this.iframe=hui.build("iframe",{style:"display:block; width: 100%; border: 0;",parent:this.element});hui.listen(this.iframe,"load",this._load.bind(this));this.controller=A.controller},saveSelection:function(){this.savedRange=this.document.selection.createRange()},restoreSelection:function(A){window.setTimeout(function(){this.body.focus();this.savedRange.select();if(A){A()}}.bind(this))},_load:function(){this.document=hui.getFrameDocument(this.iframe);this.body=this.document.body;this.body.contentEditable=true;hui.listen(this.body,"keyup",this._keyUp.bind(this));hui.listen(this.body,"mouseup",this._mouseUp.bind(this));this.controller.implIsReady()},_keyUp:function(){this.controller.implValueChanged();this.saveSelection()},_mouseUp:function(){this.saveSelection()},focus:function(){this.body.focus();this.controller.implFocused()},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};this.document.execCommand(A[B],null,null)},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{this.document.execCommand(A.key,null,null)}}},removeFormat:function(){this.document.execCommand("removeFormat",null,null)},colorize:function(A){this.document.execCommand("forecolor",null,A);this.restoreSelection()},_wrapInTag:function(A){document.execCommand("inserthtml",null,"<"+A+">"+hui.escape(hui.selection.getText())+"</"+A+">")},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},setHTML:function(A){this.body.innerHTML=A},getHTML:function(){var A=hui.ui.MarkupEditor.util.clean(this.body);return A.innerHTML}};hui.ui.MarkupEditor.util={clean:function(C){var D=C.cloneNode(true);this.replaceNodes(D,{b:"strong",i:"em",font:"span"});var B=hui.byClass(D,"Apple-style-span");for(var A=B.length-1;A>=0;A--){B[A].removeAttribute("class")}this.convertAttributesToStyle(D);return D},replaceNodes:function(C,I){for(var J in I){var K=C.getElementsByTagName(J);for(var F=K.length-1;F>=0;F--){var H=K[F];var B=document.createElement(I[J]);var D=K[F].getAttribute("color");if(D){B.style.color=D}hui.dom.replaceNode(H,B);var A=H.childNodes;for(var E=0;E<A.length;E++){var G=H.removeChild(A[E]);B.appendChild(G)}}}},convertAttributesToStyle:function(C){var B=C.getElementsByTagName("*");for(var A=0;A<B.length;A++){var E=B[A];var D=E.getAttribute("align");if(D){E.style.textAlign=D;E.removeAttribute("align")}}}};hui.ui.ColorPicker=function(A){this.options=A||{};this.name=A.name;this.element=hui.get(A.element);this.color=null;this.buttons=[];this.preview=hui.firstByClass(this.element,"hui_colorpicker_preview");this.pages=hui.byClass(this.element,"hui_colorpicker_page");this.input=hui.firstByTag(this.element,"input");this.wheel1=this.pages[0];this.wheel2=this.pages[1];this.wheel3=this.pages[2];this.swatches=this.pages[3];hui.ui.extend(this);this.addBehavior();this.buildData()};hui.ui.ColorPicker.create=function(C){var A="",F,E,B;for(var D=0;D<360;D+=30){for(B=0.05;B<=1;B+=0.15){F=hui.Color.hsv2rgb(D,B,1);E=hui.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}for(B=1;B>=0.2;B-=0.15){F=hui.Color.hsv2rgb(D,1,B);E=hui.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}}for(B=255;B>=0;B-=255/12){E=hui.Color.rgb2hex([B,B,B]);A+='<a style="background: rgb('+Math.round(B)+","+Math.round(B)+","+Math.round(B)+')" rel="'+E+'"></a>'}C=C||{};C.element=hui.build("div",{"class":"hui_colorpicker",html:'<div class="hui_bar hui_bar_window_mini"><div class="hui_bar_body"><a class="hui_bar_button hui_bar_button_selected" href="javascript:void(0)" rel="0"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_pastels",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="1"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_brightness",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="2"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/wheel_saturated",16)+')"></span></a><a class="hui_bar_button" href="javascript:void(0)" rel="3"><span class="hui_icon_16" style="background: url('+hui.ui.getIconUrl("colorpicker/swatches",16)+')"></span></a><input class="hui_colorpicker"/></div></div><div class="hui_colorpicker_pages"><div class="hui_colorpicker_page hui_colorpicker_wheel1"></div><div class="hui_colorpicker_page hui_colorpicker_wheel2"></div><div class="hui_colorpicker_page hui_colorpicker_wheel3"></div><div class="hui_colorpicker_page hui_colorpicker_swatches">'+A+'</div></div><div class="hui_colorpicker_preview"></div>'});return new hui.ui.ColorPicker(C)};hui.ui.ColorPicker.prototype={addBehavior:function(){var A=hui.byClass(this.element,"hui_bar_button");for(var C=0;C<A.length;C++){var B=new hui.ui.Bar.Button({element:A[C]});B.listen(this);this.buttons.push(B)}hui.listen(this.element,"click",this._click.bind(this));hui.listen(this.wheel1,"mousemove",this._hoverWheel1.bind(this));hui.listen(this.wheel1,"click",this._pickColor.bind(this));hui.listen(this.wheel2,"mousemove",this._hoverWheel2.bind(this));hui.listen(this.wheel2,"click",this._pickColor.bind(this));hui.listen(this.wheel3,"mousemove",this._hoverWheel3.bind(this));hui.listen(this.wheel3,"click",this._pickColor.bind(this));hui.listen(this.element,"mousedown",function(D){hui.stop(D)});hui.listen(this.swatches,"mousemove",function(D){D=hui.event(D);this._hoverColor(D.element.getAttribute("rel"))}.bind(this));hui.listen(this.swatches,"click",this._pickColor.bind(this))},$click:function(B){var C=parseInt(B.element.getAttribute("rel")),A;for(A=this.pages.length-1;A>=0;A--){this.pages[A].style.display=A==C?"block":"none"}for(A=0;A<this.buttons.length;A++){this.buttons[A].setSelected(this.buttons[A]==B)}},_click:function(B){B=hui.event(B);B.stop();var A=B.findByTag("input");if(A){A.focus()}},_pickColor:function(A){hui.stop(A);this.fire("colorWasSelected",this.color)},_hoverColor:function(A){this.preview.style.background=A;this.color=A;this.fire("colorWasHovered",this.color);this.input.value=A},buildData:function(){var A=new Array();A[0]=new Array(0,1,0);A[1]=new Array(-1,0,0);A[2]=new Array(0,0,1);A[3]=new Array(0,-1,0);A[4]=new Array(1,0,0);A[5]=new Array(0,0,-1);A[6]=new Array(255,1,1);var E=new Array(360);for(var D=0;D<6;D++){for(var C=0;C<60;C++){E[60*D+C]=new Array(3);for(var B=0;B<3;B++){E[60*D+C][B]=A[6][B];A[6][B]+=(A[D][B]*4)}}}this.colorArray=E},_hoverWheel1:function(O){O=hui.event(O);var B=hui.getPosition(this.wheel1);var E=4*(O.getLeft()-B.left);var C=4*(O.getTop()-B.top);var I=E-512;var G=C-512;var S=(I<0)?0:1;var R=(G<0)?0:1;var J=2*R+S;var D=new Array(-180,360,180,0);var N=Math.abs(I);var A=Math.abs(G);var P=A*45/N;if(A>N){P=90-(N*45/A)}var F=Math.floor(Math.abs(D[J]-P));I=Math.abs(E-512);G=Math.abs(C-512);var H=Math.sqrt((I*I)+(G*G));if(E==512&C==512){var Q="000000"}else{var K=0;for(var M=0;M<3;M++){var L=this.colorArray[F][M]*H/256;if(H>256){L+=Math.floor(H-256)}if(L>255){L=255}K=256*K+Math.floor(L)}Q=K.toString(16)}while(Q.length<6){Q="0"+Q}this._hoverColor("#"+Q)},_hoverWheel2:function(J){var K,E,D;J=hui.event(J);var L=hui.getPosition(this.wheel2);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{if(A>=0.5){E=1-((A-0.5)*2);D=1;K=hui.Color.hsv2rgb(O,E,D)}else{E=1;D=A*2;K=hui.Color.hsv2rgb(O,E,D)}}}this._hoverColor(hui.Color.rgb2hex(K))},_hoverWheel3:function(J){var K,E,D;J=hui.event(J);var L=hui.getPosition(this.wheel3);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{E=A;D=1;K=hui.Color.hsv2rgb(O,E,D)}}this._hoverColor(hui.Color.rgb2hex(K))}};hui.ui.LocationField=function(A){this.options=hui.override({value:null},A);this.name=A.name;this.element=hui.get(A.element);this.chooser=hui.firstByTag(this.element,"a");this.latField=new hui.ui.Input({element:hui.firstByTag(this.element,"input"),validator:new hui.ui.NumberValidator({min:-90,max:90,allowNull:true})});this.latField.listen(this);this.lngField=new hui.ui.Input({element:this.element.getElementsByTagName("input")[1],validator:new hui.ui.NumberValidator({min:-180,max:180,allowNull:true})});this.lngField.listen(this);this.value=this.options.value;hui.ui.extend(this);this.setValue(this.value);this.addBehavior()};hui.ui.LocationField.create=function(B){B=B||{};var C=B.element=hui.build("div",{"class":"hui_locationfield"});var A=hui.build("span",{html:'<span class="hui_locationfield_latitude"><span><input/></span></span><span class="hui_locationfield_longitude"><span><input/></span></span>'});C.appendChild(hui.ui.wrapInField(A));C.appendChild(hui.build("a",{"class":"hui_locationfield_picker",href:"javascript:void(0);"}));return new hui.ui.LocationField(B)};hui.ui.LocationField.prototype={addBehavior:function(){hui.listen(this.chooser,"click",this.showPicker.bind(this));hui.ui.addFocusClass({element:this.latField.element,classElement:this.element,"class":"hui_field_focused"});hui.ui.addFocusClass({element:this.lngField.element,classElement:this.element,"class":"hui_field_focused"})},getLabel:function(){return this.options.label},reset:function(){this.setValue()},getValue:function(){return this.value},setValue:function(A){if(A){this.latField.setValue(A.latitude);this.lngField.setValue(A.longitude);this.value=A}else{this.latField.setValue();this.lngField.setValue();this.value=null}this.updatePicker()},updatePicker:function(){if(this.picker){this.picker.setLocation(this.value)}},showPicker:function(){if(!this.picker){this.picker=new hui.ui.LocationPicker();this.picker.listen(this)}this.picker.show({node:this.chooser,location:this.value})},$locationChanged:function(A){this.setValue(A)},$valueChanged:function(){var B=this.latField.getValue();var A=this.lngField.getValue();if(B===null||A===null){this.value=null}else{this.value={latitude:B,longitude:A}}this.updatePicker()}};hui.ui.StyleLength=function(C){this.options=hui.override({value:null,min:0,max:1000,units:["px","pt","em","%"],defaultUnit:"px",allowNull:false},C);this.name=C.name;var B=this.element=hui.get(C.element);this.input=hui.firstByTag(B,"input");var A=B.getElementsByTagName("a");this.up=A[0];this.down=A[1];this.value=this.parseValue(this.options.value);hui.ui.extend(this);this.addBehavior()};hui.ui.StyleLength.prototype={addBehavior:function(){var A=this.element;hui.listen(this.input,"focus",function(){hui.addClass(A,"hui_numberfield_focused")});hui.listen(this.input,"blur",this.blurEvent.bind(this));hui.listen(this.input,"keyup",this.keyEvent.bind(this));hui.listen(this.up,"mousedown",this.upEvent.bind(this));hui.listen(this.down,"mousedown",this.downEvent.bind(this))},parseValue:function(E){if(E===null||E===undefined){return null}var B=parseFloat(E,10);if(isNaN(B)){return null}var A={number:B,unit:this.options.defaultUnit};for(var C=0;C<this.options.units.length;C++){var D=this.options.units[C];if(E.indexOf(D)!=-1){A.unit=D;break}}A.number=Math.max(this.options.min,Math.min(this.options.max,A.number));return A},blurEvent:function(){hui.removeClass(this.element,"hui_numberfield_focused");this.updateInput()},keyEvent:function(A){A=A||window.event;if(A.keyCode==hui.KEY_UP){hui.stop(A);this.upEvent()}else{if(A.keyCode==hui.KEY_DOWN){this.downEvent()}else{this.checkAndSetValue(this.parseValue(this.input.value))}}},updateInput:function(){this.input.value=this.getValue()},checkAndSetValue:function(B){var A=this.value;var C=false;if(A===null&&B===null){}else{if(A!=null&&B!=null&&A.number===B.number&&A.unit===B.unit){}else{C=true}}this.value=B;if(C){hui.ui.callAncestors(this,"childValueChanged",this.input.value);this.fire("valueChanged",this.getValue())}},downEvent:function(){if(this.value){this.checkAndSetValue({number:Math.max(this.options.min,this.value.number-1),unit:this.value.unit})}else{this.checkAndSetValue({number:this.options.min,unit:this.options.defaultUnit})}this.updateInput()},upEvent:function(){if(this.value){this.checkAndSetValue({number:Math.min(this.options.max,this.value.number+1),unit:this.value.unit})}else{this.checkAndSetValue({number:this.options.min+1,unit:this.options.defaultUnit})}this.updateInput()},getValue:function(){return this.value?this.value.number+this.value.unit:""},setValue:function(A){this.value=this.parseValue(A);this.updateInput()},focus:function(){try{this.input.focus()}catch(A){}},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")}};hui.ui.DateTimeField=function(A){this.inputFormats=["d-m-Y","d/m-Y","d/m/Y","d-m-Y H:i:s","d/m-Y H:i:s","d/m/Y H:i:s","d-m-Y H:i","d/m-Y H:i","d/m/Y H:i","d-m-Y H","d/m-Y H","d/m/Y H","d-m","d/m","d","Y","m-d-Y","m-d","m/d"];this.outputFormat="d-m-Y H:i:s";this.name=A.name;this.element=hui.get(A.element);this.input=hui.firstByTag(this.element,"input");this.options=hui.override({returnType:null,label:null,allowNull:true,value:null},A);this.value=this.options.value;hui.ui.extend(this);this.addBehavior();this.updateUI()};hui.ui.DateTimeField.create=function(A){var B=hui.build("span",{"class":"hui_formula_text_singleline"});hui.build("input",{"class":"hui_formula_text",parent:B});A.element=hui.ui.wrapInField(B);return new hui.ui.DateTimeField(A)};hui.ui.DateTimeField.prototype={addBehavior:function(){hui.ui.addFocusClass({element:this.input,classElement:this.element,"class":"hui_field_focused"});hui.listen(this.input,"blur",this.check.bind(this))},updateFromNode:function(A){if(A.firstChild){this.setValue(A.firstChild.nodeValue)}else{this.setValue(null)}},updateFromObject:function(A){this.setValue(A.value)},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")},setValue:function(A){if(!A){this.value=null}else{if(A.constructor==Date){this.value=A}else{this.value=new Date();this.value.setTime(parseInt(A)*1000)}}this.updateUI()},check:function(){var C=this.input.value;var A=null;for(var B=0;B<this.inputFormats.length&&A==null;B++){A=Date.parseDate(C,this.inputFormats[B])}if(this.options.allowNull||A!=null){this.value=A}this.updateUI()},getValue:function(){if(this.value!=null&&this.options.returnType=="seconds"){return Math.round(this.value.getTime()/1000)}return this.value},getElement:function(){return this.element},getLabel:function(){return this.options.label},updateUI:function(){if(this.value){this.input.value=this.value.dateFormat(this.outputFormat)}else{this.input.value=""}}};hui.ui.TokenField=function(A){this.options=hui.override({label:null,key:null},A);this.element=hui.get(A.element);this.name=A.name;this.value=[""];hui.ui.extend(this);this.updateUI()};hui.ui.TokenField.create=function(A){A=A||{};A.element=hui.build("div",{"class":"hui_tokenfield"});return new hui.ui.TokenField(A)};hui.ui.TokenField.prototype={setValue:function(A){this.value=A;this.value.push("");this.updateUI()},reset:function(){this.value=[""];this.updateUI()},getValue:function(){var A=[];hui.each(this.value,function(B){B=hui.trim(B);if(B.length>0){A.push(B)}});return A},getLabel:function(){return this.options.label},updateUI:function(){this.element.innerHTML="";hui.each(this.value,function(C,B){var A=hui.build("input",{"class":"hui_tokenfield_token",parent:this.element});if(this.options.width){A.style.width=this.options.width+"px"}A.value=C;hui.listen(A,"keyup",function(){this.inputChanged(A,B)}.bind(this))}.bind(this))},inputChanged:function(A,B){if(B==this.value.length-1&&A.value!=this.value[B]){this.addField()}this.value[B]=A.value;hui.animate({node:A,css:{width:Math.min(Math.max(A.value.length*7+3,50),150)+"px"},duration:200})},addField:function(){var B=hui.build("input",{"class":"hui_tokenfield_token"});if(this.options.width){B.style.width=this.options.width+"px"}var C=this.value.length;this.value.push("");this.element.appendChild(B);var A=this;hui.listen(B,"keyup",function(){A.inputChanged(B,C)})}};hui.ui.Checkbox=function(A){this.element=hui.get(A.element);this.control=hui.firstByTag(this.element,"span");this.options=A;this.name=A.name;this.value=A.value==="true"||A.value===true;hui.ui.extend(this);this.addBehavior()};hui.ui.Checkbox.create=function(B){var A=B.element=hui.build("a",{"class":"hui_checkbox",href:"javascript://",html:"<span><span></span></span>"});if(B.value){hui.addClass(A,"hui_checkbox_selected")}return new hui.ui.Checkbox(B)};hui.ui.Checkbox.prototype={addBehavior:function(){hui.ui.addFocusClass({element:this.element,"class":"hui_checkbox_focused"});hui.listen(this.element,"click",this.click.bind(this))},click:function(A){hui.stop(A);this.element.focus();this.value=!this.value;this.updateUI();hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)},updateUI:function(){hui.setClass(this.element,"hui_checkbox_selected",this.value)},setValue:function(A){this.value=A===true||A==="true";this.updateUI()},getValue:function(){return this.value},reset:function(){this.setValue(false)},getLabel:function(){return this.options.label}};hui.ui.Checkboxes=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.items=A.items||[];this.sources=[];this.subItems=[];this.values=A.values||A.value||[];hui.ui.extend(this);this.addBehavior();this.updateUI();if(A.url){new hui.ui.Source({url:A.url,delegate:this})}};hui.ui.Checkboxes.create=function(A){A.element=hui.build("div",{"class":A.vertical?"hui_checkboxes hui_checkboxes_vertical":"hui_checkboxes"});if(A.items){hui.each(A.items,function(C){var B=hui.build("a",{"class":"hui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+C.title});hui.ui.addFocusClass({element:B,"class":"hui_checkbox_focused"});A.element.appendChild(B)})}return new hui.ui.Checkboxes(A)};hui.ui.Checkboxes.prototype={addBehavior:function(){var A=hui.byClass(this.element,"hui_checkbox");hui.each(A,function(B,C){hui.listen(B,"click",function(D){hui.stop(D);this.flipValue(this.items[C].value)}.bind(this))}.bind(this))},getValue:function(){return this.values},getValues:function(){return this.values},checkValues:function(){var B=[];for(var C=0;C<this.values.length;C++){var E=this.values[C],D=false,A;for(A=0;A<this.items.length;A++){D=D||this.items[A].value===E}for(A=0;A<this.subItems.length;A++){D=D||this.subItems[A].hasValue(E)}if(D){B.push(E)}}this.values=B},setValue:function(A){this.values=A;this.checkValues();this.updateUI()},setValues:function(A){this.setValue(A)},flipValue:function(A){hui.flipInArray(this.values,A);this.checkValues();this.updateUI();this.fire("valueChanged",this.values);hui.ui.callAncestors(this,"childValueChanged",this.values)},updateUI:function(){var B,C,D;for(B=0;B<this.subItems.length;B++){this.subItems[B].updateUI()}var A=hui.byClass(this.element,"hui_checkbox");for(B=0;B<this.items.length;B++){C=this.items[B];D=hui.inArray(this.values,C.value);hui.setClass(A[B],"hui_checkbox_selected",D)}},refresh:function(){for(var A=0;A<this.subItems.length;A++){this.subItems[A].refresh()}},reset:function(){this.setValues([])},registerSource:function(A){A.parent=this;this.sources.push(A)},registerItem:function(A){if(parseInt(A.value)==A.value){A.value=parseInt(A.value)}this.items.push(A)},registerItems:function(A){hui.log("registerItems");A.parent=this;this.subItems.push(A)},getLabel:function(){return this.options.label},$itemsLoaded:function(A){hui.each(A,function(C){var B=hui.build("a",{"class":"hui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+hui.escape(C.title)});hui.listen(B,"click",function(D){hui.stop(D);this.flipValue(C.value)}.bind(this));hui.ui.addFocusClass({element:B,"class":"hui_checkbox_focused"});this.element.appendChild(B);this.items.push(C)}.bind(this));this.checkValues();this.updateUI()}};hui.ui.Checkboxes.Items=function(A){this.element=hui.get(A.element);this.name=A.name;this.parent=null;this.options=A;this.checkboxes=[];hui.ui.extend(this);if(this.options.source){this.options.source.listen(this)}hui.log("itms")};hui.ui.Checkboxes.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$itemsLoaded:function(B){this.checkboxes=[];this.element.innerHTML="";var A=this;hui.each(B,function(D){var C=hui.build("a",{"class":"hui_checkbox",href:"javascript://",html:"<span><span></span></span>"+D.title});hui.listen(C,"click",function(E){hui.stop(E);C.focus();A.itemWasClicked(D)});hui.ui.addFocusClass({element:C,"class":"hui_checkbox_focused"});A.element.appendChild(C);A.checkboxes.push({title:D.title,element:C,value:D.value})});this.parent.checkValues();this.updateUI()},itemWasClicked:function(A){this.parent.flipValue(A.value)},updateUI:function(){try{for(var B=0;B<this.checkboxes.length;B++){var C=this.checkboxes[B];var A=hui.indexInArray(this.parent.values,C.value);hui.setClass(C.element,"hui_checkbox_selected",A!=-1)}}catch(D){alert(typeof (this.parent.values));alert(D)}},hasValue:function(B){for(var A=0;A<this.checkboxes.length;A++){if(this.checkboxes[A].value==B){return true}}return false}};hui.ui.Radiobuttons=function(A){this.options=A;this.element=hui.get(A.element);this.name=A.name;this.radios=[];this.value=A.value;this.defaultValue=this.value;this.enabled=true;hui.ui.extend(this)};hui.ui.Radiobuttons.prototype={updateUI:function(){for(var B=0;B<this.radios.length;B++){var A=this.radios[B];hui.setClass(hui.get(A.id),"hui_radiobutton_selected",A.value==this.value)}},setValue:function(A){this.value=A;this.updateUI()},getValue:function(){if(!this.enabled){return null}return this.value},reset:function(){this.setValue(this.defaultValue)},setEnabled:function(A){this.enabled=A==true;hui.setClass(this.element,"hui_radiobuttons_disabled",!this.enabled)},registerRadiobutton:function(B){this.radios.push(B);var C=hui.get(B.id);var A=this;C.onclick=function(){if(!A.enabled){return }A.setValue(B.value);A.fire("valueChanged",B.value);hui.ui.callAncestors(A,"childValueChanged",B.value)}}};hui.ui.NumberField=function(B){this.options=hui.override({min:0,max:10000,value:null,decimals:0,allowNull:false},B);this.name=B.name;var A=this.element=hui.get(B.element);this.input=hui.firstByTag(A,"input");this.up=hui.firstByClass(A,"hui_numberfield_up");this.down=hui.firstByClass(A,"hui_numberfield_down");this.value=this.options.value;hui.ui.extend(this);this.addBehavior()};hui.ui.NumberField.create=function(A){A.element=hui.build("span",{"class":"hui_numberfield",html:'<span><span><input type="text" value="'+(A.value!==undefined?A.value:"0")+'"/><a class="hui_numberfield_up"></a><a class="hui_numberfield_down"></a></span></span>'});return new hui.ui.NumberField(A)};hui.ui.NumberField.prototype={addBehavior:function(){var A=this.element;hui.listen(this.input,"focus",function(){hui.addClass(A,"hui_numberfield_focused")});hui.listen(this.input,"blur",this.blurEvent.bind(this));hui.listen(this.input,"keyup",this.keyEvent.bind(this));hui.listen(this.up,"mousedown",this.upEvent.bind(this));hui.listen(this.up,"dblclick",this.upEvent.bind(this));hui.listen(this.down,"mousedown",this.downEvent.bind(this));hui.listen(this.down,"dblclick",this.upEvent.bind(this))},blurEvent:function(){hui.removeClass(this.element,"hui_numberfield_focused");this.updateField()},keyEvent:function(B){B=B||window.event;if(B.keyCode==hui.KEY_UP){hui.stop(B);this.upEvent()}else{if(B.keyCode==hui.KEY_DOWN){this.downEvent()}else{var A=parseInt(this.input.value,10);if(!isNaN(A)){this.setLocalValue(A,true)}else{this.setLocalValue(null,true)}}}},downEvent:function(A){hui.stop(A);if(this.value===null){this.setLocalValue(this.options.min,true)}else{this.setLocalValue(this.value-1,true)}this.updateField()},upEvent:function(A){hui.stop(A);this.setLocalValue(this.value+1,true);this.updateField()},focus:function(){try{this.input.focus()}catch(A){}},getValue:function(){return this.value},getLabel:function(){return this.options.label},setValue:function(A){A=parseInt(A,10);if(!isNaN(A)){this.setLocalValue(A,false)}this.updateField()},updateField:function(){this.input.value=this.value===null||this.value===undefined?"":this.value},setLocalValue:function(B,A){var C=this.value;if(B===null||B===undefined&&this.options.allowNull){this.value=null}else{this.value=Math.min(Math.max(B,this.options.min),this.options.max)}if(A&&C!==this.value){hui.ui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)}},reset:function(){if(this.options.allowNull){this.value=null}else{this.value=Math.min(Math.max(0,this.options.min),this.options.max)}this.updateField()}};hui.ui.TextField=function(B){this.options=hui.override({label:null,key:null,lines:1,live:false,maxHeight:100,animateValueChage:true,animateUserChange:true},B);this.element=hui.get(B.element);this.name=B.name;hui.ui.extend(this);this.input=hui.firstByClass(this.element,"hui_formula_text");this.multiline=this.input.tagName.toLowerCase()=="textarea";this.placeholder=hui.firstByClass(this.element,"hui_field_placeholder");this.value=this.input.value;if(this.placeholder){var A=this;hui.ui.onReady(function(){window.setTimeout(function(){A.value=A.input.value;A.updateClass()},500)})}this.addBehavior()};hui.ui.TextField.create=function(B){B=hui.override({lines:1},B);var C,A;if(B.lines>1||B.multiline){A=hui.build("textarea",{"class":"hui_formula_text","rows":B.lines,style:"height: 32px;"});C=hui.build("span",{"class":"hui_formula_text_multiline"});C.appendChild(A)}else{A=hui.build("input",{"class":"hui_formula_text"});if(B.secret){A.setAttribute("type","password")}C=hui.build("span",{"class":"hui_field_singleline"});C.appendChild(A)}if(B.value!==undefined){A.value=B.value}B.element=hui.ui.wrapInField(C);return new hui.ui.TextField(B)};hui.ui.TextField.prototype={addBehavior:function(){hui.ui.addFocusClass({element:this.input,classElement:this.element,"class":"hui_field_focused"});hui.listen(this.input,"keyup",this.onKeyUp.bind(this));var A=this.element.getElementsByTagName("em")[0];if(A){this.updateClass();hui.listen(A,"mousedown",function(){window.setTimeout(function(){this.input.focus();this.input.select()}.bind(this))}.bind(this));hui.listen(A,"mouseup",function(){this.input.focus();this.input.select()}.bind(this))}},updateClass:function(){hui.setClass(this.element,"hui_field_dirty",this.value.length>0)},onKeyUp:function(B){if(!this.multiline&&B.keyCode===hui.KEY_RETURN){this.fire("submit");var A=hui.ui.getAncestor(this,"hui_formula");if(A){A.submit()}return }if(this.input.value==this.value){return }this.value=this.input.value;this.updateClass();this.expand(this.options.animateUserChange);hui.ui.callAncestors(this,"childValueChanged",this.input.value);this.fire("valueChanged",this.input.value)},updateFromNode:function(A){if(A.firstChild){this.setValue(A.firstChild.nodeValue)}else{this.setValue(null)}},updateFromObject:function(A){this.setValue(A.value)},focus:function(){try{this.input.focus()}catch(A){}},select:function(){try{this.input.focus();this.input.select()}catch(A){}},reset:function(){this.setValue("")},setValue:function(A){if(A===undefined||A===null){A=""}this.value=A;this.input.value=A;this.expand(this.options.animateValueChange)},getValue:function(){return this.input.value},getLabel:function(){return this.options.label},isEmpty:function(){return this.input.value==""},isBlank:function(){return hui.isBlank(this.input.value)},setError:function(A){var B=A?true:false;hui.setClass(this.element,"hui_field_error",B);if(typeof (A)=="string"){hui.ui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){hui.ui.hideToolTip({key:this.name})}},$visibilityChanged:function(){if(hui.dom.isVisible(this.element)){window.setTimeout(this.expand.bind(this))}},expand:function(A){if(!this.multiline){return }if(!hui.dom.isVisible(this.element)){return }var B=hui.ui.getTextAreaHeight(this.input);B=Math.max(32,B);B=Math.min(B,this.options.maxHeight);if(A){this.updateOverflow();hui.animate(this.input,"height",B+"px",300,{ease:hui.ease.slowFastSlow,onComplete:function(){this.updateOverflow()}.bind(this)})}else{this.input.style.height=B+"px";this.updateOverflow()}},updateOverflow:function(){if(!this.multiline){return }this.input.style.overflowY=this.input.clientHeight>=this.options.maxHeight?"auto":"hidden"}};hui.ui.Rendering=function(A){this.options=hui.override({clickObjects:false},A);this.element=hui.get(A.element);this.name=A.name;hui.ui.extend(this)};hui.ui.Rendering.prototype={_click:function(A){A=hui.event(A)},setContent:function(A){this.element.innerHTML=A}}