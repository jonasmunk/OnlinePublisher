var n2i={browser:{},ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};if(!window.hui){var hui=n2i}n2i.browser.opera=/opera/i.test(navigator.userAgent);n2i.browser.msie=!n2i.browser.opera&&/MSIE/.test(navigator.userAgent);n2i.browser.msie6=navigator.userAgent.indexOf("MSIE 6")!==-1;n2i.browser.msie7=navigator.userAgent.indexOf("MSIE 7")!==-1;n2i.browser.msie8=navigator.userAgent.indexOf("MSIE 8")!==-1;n2i.browser.msie9=navigator.userAgent.indexOf("MSIE 9")!==-1;n2i.browser.webkit=navigator.userAgent.indexOf("WebKit")!==-1;n2i.browser.safari=navigator.userAgent.indexOf("Safari")!==-1;n2i.browser.webkitVersion=null;n2i.browser.gecko=!n2i.browser.webkit&&navigator.userAgent.indexOf("Gecko")!=-1;n2i.browser.opacity=!n2i.browser.msie||n2i.browser.msie9;(function(){var A=/Safari\/([\d.]+)/.exec(navigator.userAgent);if(A){n2i.browser.webkitVersion=parseFloat(A[1])}})();n2i.log=function(A){try{console.log(A)}catch(B){}};n2i.camelize=function(F){if(F.indexOf("-")==-1){return F}var D=F.split("-");var B=F.indexOf("-")==0?D[0].charAt(0).toUpperCase()+D[0].substring(1):D[0];for(var C=1,A=D.length;C<A;C++){var E=D[C];B+=E.charAt(0).toUpperCase()+E.substring(1)}return B};n2i.override=function(B,A){if(A){for(prop in A){B[prop]=A[prop]}}return B};n2i.wrap=function(A){if(A===null||A===undefined){return""}return A.split("").join("\u200B")};n2i.trim=function(A){if(A===null||A===undefined){return""}if(typeof (A)!="string"){A=new String(A)}return A.replace(/^[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+|[\s\x0b\xa0\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u200b\u2028\u2029\u3000]+$/g,"")};n2i.escapeHTML=function(A){if(A===null||A===undefined){return""}return n2i.build("div",{text:A}).innerHTML};n2i.escape=function(A){if(!n2i.isDefined(A)){return""}return A.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")};n2i.isBlank=function(A){if(A===null||typeof (A)==="undefined"||A===""){return true}return typeof (A)=="string"&&n2i.trim(A).length==0};n2i.isEmpty=function(A){n2i.log("n2i.isEmpty is deprecated");return n2i.isBlank(A)};n2i.isDefined=function(A){return A!==null&&typeof (A)!=="undefined"};n2i.isArray=function(A){if(A==null||A==undefined){return false}if(A.constructor==Array){return true}else{return Object.prototype.toString.call(A)==="[object Array]"}};n2i.string={endsWith:function(B,A){if(!typeof (B)=="string"||!typeof (A)=="string"){return false}return(B.match(A+"$")==A)}};n2i.inArray=function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return true}}return false};n2i.indexInArray=function(A,C){for(var B=0;B<A.length;B++){if(A[B]===C){return B}}return -1};n2i.each=function(A,D){if(n2i.isArray(A)){for(var C=0;C<A.length;C++){D(A[C],C)}}else{for(var B in A){D(B,A[B])}}};n2i.intOrString=function(B){if(n2i.isDefined(B)){var A=/[0-9]+/.exec(B);if(A!==null&&A[0]==B){if(parseInt(B,10)==B){return parseInt(B,10)}}}return B};n2i.flipInArray=function(A,B){if(n2i.inArray(A,B)){n2i.removeFromArray(A,B)}else{A.push(B)}};n2i.removeFromArray=function(A,C){for(var B=A.length-1;B>=0;B--){if(A[B]==C){A.splice(B,1)}}};n2i.addToArray=function(A,C){if(C.constructor==Array){for(var B=0;B<C.length;B++){if(!n2i.inArray(A,C[B])){A.push(C)}}}else{if(!n2i.inArray(A,C)){A.push(C)}}};n2i.toIntArray=function(B){var C=B.split(",");for(var A=C.length-1;A>=0;A--){C[A]=parseInt(C[A])}return C};n2i.scrollTo=function(A){A=n2i.get(A);if(A){var B=n2i.getPosition(A);window.scrollTo(B.left,B.top-50)}};n2i.dom={isElement:function(B,A){return B.nodeType==n2i.ELEMENT_NODE&&(A===undefined?true:B.nodeName.toLowerCase()==A)},isDefinedText:function(A){return A.nodeType==n2i.TEXT_NODE&&A.nodeValue.length>0},addText:function(A,B){A.appendChild(document.createTextNode(B))},clear:function(C){var B=C.childNodes;for(var A=B.length-1;A>=0;A--){B[A].parentNode.removeChild(B[A])}},remove:function(A){if(A.parentNode){A.parentNode.removeChild(A)}},replaceNode:function(B,A){A.parentNode.removeChild(A);B.parentNode.insertBefore(A,B);B.parentNode.removeChild(B)},replaceHTML:function(B,A){B=n2i.get(B);B.innerHTML=A},runScripts:function(node){var scripts=node.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){eval(scripts[i].innerHTML)}},setText:function(C,D){var E=C.childNodes;var A=false;for(var B=E.length-1;B>=0;B--){if(!A&&E[B].nodeType==n2i.TEXT_NODE){E[B].nodeValue=D;A=true}else{C.removeChild(E[B])}}if(!A){n2i.dom.addText(C,D)}},getText:function(C){var A="";var D=C.childNodes;for(var B=0;B<D.length;B++){if(D[B].nodeType==n2i.TEXT_NODE&&D[B].nodeValue!=null){A+=D[B].nodeValue}else{if(D[B].nodeType==n2i.ELEMENT_NODE){A+=n2i.dom.getText(D[B])}}}return A},isVisible:function(A){while(A){if(A.style&&(n2i.getStyle(A,"display")==="none"||n2i.getStyle(A,"visibility")==="hidden")){return false}A=A.parentNode}return true}};n2i.form={getValues:function(C){var D={};var A=C.getElementsByTagName("input");for(var B=0;B<A.length;B++){if(n2i.isDefined(A[B].name)){D[A[B].name]=A[B].value}}return D}};n2i.get=function(A){if(typeof (A)=="string"){return document.getElementById(A)}return A};n2i.getChildren=function(D){var C=[];var A=D.childNodes;for(var B=0;B<A.length;B++){if(n2i.dom.isElement(A[B])){C.push(A[B])}}return C};if(document.querySelector){n2i.firstByClass=function(B,C,A){B=B||document.body;return B.querySelector((A?A+".":".")+C)}}else{n2i.firstByClass=function(B,E,A){var D=(n2i.get(B)||document.body).getElementsByTagName(A||"*");for(var C=0;C<D.length;C++){if(n2i.hasClass(D[C],E)){return D[C]}}return null}}if(document.querySelectorAll){n2i.byClass=function(D,F,A){D=D||document.body;var C=D.querySelectorAll((A?A+".":".")+F);var B=[];for(var E=0,G=C.length;E!=G;B.push(C[E++])){}return B}}else{n2i.byClass=function(B,F,A){var E=(n2i.get(B)||document.body).getElementsByTagName(A||"*");var C=[];for(var D=0;D<E.length;D++){if(n2i.hasClass(E[D],F)){C[C.length]=E[D]}}return C}}n2i.byId=function(D,E){var B=D.childNodes;for(var A=B.length-1;A>=0;A--){if(B[A].nodeType===hui.ELEMENT_NODE&&B[A].getAttribute("id")===E){return B[A]}else{var C=n2i.byId(B[A],E);if(C){return C}}}return null};n2i.firstParentByTag=function(C,A){var B=C;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null};n2i.firstParentByClass=function(C,A){var B=C;while(B){if(n2i.hasClass(B)){return B}B=B.parentNode}return null};n2i.firstByTag=function(B,A){B=n2i.get(B)||document.body;if(document.querySelector&&A!=="*"){return B.querySelector(A)}var C=B.getElementsByTagName(A);return C[0]};n2i.build=function(A,B){var C=document.createElement(A);if(B){for(prop in B){if(prop=="text"){C.appendChild(document.createTextNode(B.text))}else{if(prop=="html"){C.innerHTML=B.html}else{if(prop=="parent"){B.parent.appendChild(C)}else{if(prop=="parentFirst"){if(B.parentFirst.childNodes.length==0){B.parentFirst.appendChild(C)}else{B.parentFirst.insertBefore(C,B.parentFirst.childNodes[0])}}else{if(prop=="className"){C.className=B.className}else{if(prop=="class"){C.className=B["class"]}else{if(prop=="style"&&(n2i.browser.msie7||n2i.browser.msie6)){C.style.setAttribute("cssText",B[prop])}else{if(n2i.isDefined(B[prop])){C.setAttribute(prop,B[prop])}}}}}}}}}}return C};n2i.getAncestors=function(A){var C=[];var B=A.parentNode;while(B){C[C.length]=B;B=B.parentNode}return C};n2i.getNext=function(A){if(!A){return null}if(!A.nextSibling){return null}var B=A.nextSibling;while(B&&B.nodeType!=1){B=B.nextSibling}return B};n2i.getAllNext=function(A){var C=[];var B=n2i.getNext(A);while(B){C.push(B);B=n2i.getNext(B)}return C};n2i.getTop=function(A){A=n2i.get(A);if(A){var B=A.offsetTop;var C=A.offsetParent;while(C!=null){B+=C.offsetTop;C=C.offsetParent}return B}else{return 0}};n2i.getLeft=function(A){A=n2i.get(A);if(A){var B=A.offsetLeft;var C=A.offsetParent;while(C!=null){B+=C.offsetLeft;C=C.offsetParent}return B}else{return 0}};n2i.getPosition=function(A){return{left:n2i.getLeft(A),top:n2i.getTop(A)}};n2i.hasClass=function(C,D){C=n2i.get(C);if(!C||!C.className){return false}var A=C.className.split(/\s+/);for(var B=0;B<A.length;B++){if(A[B]==D){return true}}return false};n2i.addClass=function(A,B){A=n2i.get(A);if(!A){return }n2i.removeClass(A,B);A.className+=" "+B};n2i.removeClass=function(D,E){D=n2i.get(D);if(!D){return }var B="";var A=D.className.split(/\s+/);for(var C=0;C<A.length;C++){if(A[C]!=E){if(C>0){B+=" "}B+=A[C]}}D.className=B};n2i.toggleClass=function(A,B){if(n2i.hasClass(A,B)){n2i.removeClass(A,B)}else{n2i.addClass(A,B)}};n2i.setClass=function(A,B,C){if(C){n2i.addClass(A,B)}else{n2i.removeClass(A,B)}};n2i.fromJSON=function(A){return JSON.parse(A)};n2i.toJSON=function(A){return JSON.stringify(A)};n2i.listen=function(C,B,D,A){C=n2i.get(C);if(document.addEventListener){C.addEventListener(B,D,A?true:false)}else{C.attachEvent("on"+B,D)}};n2i.unListen=function(C,B,D,A){C=n2i.get(C);if(document.removeEventListener){C.removeEventListener(B,D,A?true:false)}else{C.detachEvent("on"+B,D)}};n2i.event=function(A){return new n2i.Event(A)};n2i.Event=function(A){this.event=A=A||window.event;this.element=A.target?A.target:A.srcElement;this.shiftKey=A.shiftKey;this.returnKey=A.keyCode==13;this.escapeKey=A.keyCode==27;this.spaceKey=A.keyCode==32;this.upKey=A.keyCode==38;this.downKey=A.keyCode==40;this.leftKey=A.keyCode==37;this.rightKey=A.keyCode==39;this.keyCode=A.keyCode};n2i.Event.prototype={left:function(){var A=0;if(this.event){if(this.event.pageX){A=this.event.pageX}else{if(this.event.clientX){A=this.event.clientX+n2i.getScrollLeft()}}}return A},getLeft:function(){return this.left()},top:function(){var A=0;if(this.event){if(this.event.pageY){A=this.event.pageY}else{if(this.event.clientY){A=this.event.clientY+n2i.getScrollTop()}}}return A},getTop:function(){return this.top()},getElement:function(){return this.element},findByClass:function(A){var B=this.element;while(B){if(n2i.hasClass(B,A)){return B}B=B.parentNode}return null},findByTag:function(A){var B=this.element;while(B){if(B.tagName&&B.tagName.toLowerCase()==A){return B}B=B.parentNode}return null},stop:function(){n2i.stop(this.event)}};n2i.stop=function(A){if(!A){A=window.event}if(A.stopPropagation){A.stopPropagation()}if(A.preventDefault){A.preventDefault()}A.cancelBubble=true;A.stopped=true};n2i.onReady=function(A){if(window.addEventListener){window.addEventListener("DOMContentLoaded",A,false)}else{if(typeof document.addEventListener!="undefined"){document.addEventListener("load",A,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onload",A)}else{if(typeof window.onload=="function"){var B=window.onload;window.onload=function(){B();A()}}else{window.onload=A}}}}};n2i.request=function(B){B=n2i.override({method:"POST",async:true},B);var D=n2i.request.createTransport();D.onreadystatechange=function(){try{if(D.readyState==4){if(D.status==200&&B.onSuccess){B.onSuccess(D)}else{if(B.onFailure){B.onFailure(D)}}}}catch(E){if(B.onException){B.onException(E,D)}else{throw E}}};var C=B.method.toUpperCase();D.open(C,B.url,B.async);var A="";if(C=="POST"&&B.parameters){A=n2i.request.buildPostBody(B.parameters);D.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8")}D.send(A)};n2i.request.isXMLResponse=function(A){return A.responseXML&&A.responseXML.documentElement&&A.responseXML.documentElement.nodeName!="parsererror"};n2i.request.buildPostBody=function(B){if(!B){return null}var A="";for(param in B){if(A.length>0){A+="&"}A+=encodeURIComponent(param)+"=";if(B[param]!==undefined&&B[param]!==null){A+=encodeURIComponent(B[param])}}return A};n2i.request.createTransport=function(){try{if(window.XMLHttpRequest){var B=new XMLHttpRequest();if(B.readyState==null){B.readyState=1;B.addEventListener("load",function(){B.readyState=4;if(typeof B.onreadystatechange=="function"){B.onreadystatechange()}},false)}return B}else{if(window.ActiveXObject){return n2i.request.getActiveX()}else{this.delegate.onError(this)}}}catch(A){if(this.delegate.onError){this.delegate.onError(this,A)}}};n2i.request.getActiveX=function(){var C=["MSXML2","Microsoft","MSXML","MSXML3"];var D;for(var B=0;B<C.length;B++){try{D=new ActiveXObject(C[B]+".XmlHttp");return D}catch(A){}}throw new Error("Could not find an installed XML parser")};n2i.getStyle=function(B,C){B=n2i.get(B);var E=n2i.camelize(C);var D=B.style[E];if(!D){if(document.defaultView&&document.defaultView.getComputedStyle){var A=document.defaultView.getComputedStyle(B,null);D=A?A.getPropertyValue(C):null}else{if(B.currentStyle){D=B.currentStyle[E]}}}if(window.opera&&["left","top","right","bottom"].include(C)){if(n2i.getStyle(B,"position")=="static"){D="auto"}}return D=="auto"?null:D};n2i.setOpacity=function(B,A){if(!n2i.browser.opacity){if(A==1){B.style["filter"]=null}else{B.style["filter"]="alpha(opacity="+(A*100)+")"}}else{B.style["opacity"]=A}};n2i.setStyle=function(A,B){for(style in B){if(style==="opacity"){n2i.setOpacity(A,B[style])}else{A.style[style]=B[style]}}};n2i.copyStyle=function(E,F,D){for(var A=0;A<D.length;A++){var B=D[A];var C=n2i.getStyle(E,B);if(C){F.style[B]=C}}};n2i.getFrameDocument=function(A){if(A.contentDocument){return A.contentDocument}else{if(A.contentWindow){return A.contentWindow.document}else{if(A.document){return A.document}}}};n2i.getFrameWindow=function(A){if(A.defaultView){return A.defaultView}else{if(A.contentWindow){return A.contentWindow}}};n2i.getSelectedText=function(A){A=A||document;if(A.getSelection){return A.getSelection()+""}else{if(A.selection){return A.selection.createRange().text}}return""};n2i.selection={clear:function(){var A;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){A=window.getSelection();if(A&&A.removeAllRanges){A.removeAllRanges()}}}},getText:function(A){A=A||document;if(A.getSelection){return A.getSelection()+""}else{if(A.selection){return A.selection.createRange().text}}return""}};n2i.effect={makeFlippable:function(A){n2i.addClass(A.container,"in2igui_flip_container");n2i.addClass(A.front,"in2igui_flip_front");n2i.addClass(A.back,"in2igui_flip_back")},flip:function(B){var C=n2i.get(B.element);var E=B.duration||"1s";var D=n2i.firstByClass(C,"in2igui_flip_front");var A=n2i.firstByClass(C,"in2igui_flip_back");D.style.webkitTransitionDuration=E;A.style.webkitTransitionDuration=E;n2i.toggleClass(B.element,"in2igui_flip_flipped")}};n2i.getScrollTop=function(){if(self.pageYOffset){return self.pageYOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}};n2i.getScrollLeft=function(){if(self.pageYOffset){return self.pageXOffset}else{if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollLeft}else{if(document.body){return document.body.scrollLeft}}}};n2i.getViewPortHeight=function(){if(window.innerHeight){return window.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight}else{if(document.body){return document.body.clientHeight}}}};n2i.getViewPortWidth=function(){if(window.innerWidth){return window.innerWidth}else{if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth}else{if(document.body){return document.body.clientWidth}}}};n2i.getDocumentWidth=function(){return Math.max(document.body.clientWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth);return document.body.scrollWidth};n2i.getDocumentHeight=function(){if(n2i.browser.msie6){var A=Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight);var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(n2i.dom.isElement(C[B])){A=Math.max(A,C[B].clientHeight)}}return A}if(window.scrollMaxY&&window.innerHeight){return window.scrollMaxY+window.innerHeight}else{return Math.max(document.body.clientHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight)}};n2i.place=function(C){var F=0,E=0;var A=C.target.element;var D={left:n2i.getLeft(A),top:n2i.getTop(A)};F=D.left+A.clientWidth*C.target.horizontal;E=D.top+A.clientHeight*C.target.vertical;var G=C.source.element;F-=G.clientWidth*C.source.horizontal;E-=G.clientHeight*C.source.vertical;if(C.insideViewPort){var B=n2i.getViewPortWidth();n2i.log((F+G.clientWidth)+">"+B);if(F+G.clientWidth>B){F=B-G.clientWidth}if(F<0){F=0}if(E<0){E=0}}G.style.top=E+"px";G.style.left=F+"px"};n2i.Preloader=function(A){this.options=A||{};this.delegate={};this.images=[];this.loaded=0};n2i.Preloader.prototype={addImages:function(A){if(typeof (A)=="object"){for(var B=0;B<A.length;B++){this.images.push(A[B])}}else{this.images.push(A)}},setDelegate:function(A){this.delegate=A},load:function(E){E=E||0;var B=this;this.obs=[];for(var D=E;D<this.images.length+E;D++){var C=D;if(C>=this.images.length){C=C-this.images.length}var A=new Image();A.n2iPreloaderIndex=C;A.onload=function(){B.imageChanged(this.n2iPreloaderIndex,"imageDidLoad")};A.onerror=function(){B.imageChanged(this.n2iPreloaderIndex,"imageDidGiveError")};A.onabort=function(){B.imageChanged(this.n2iPreloaderIndex,"imageDidAbort")};A.src=(this.options.context?this.options.context:"")+this.images[C];this.obs.push(A)}},imageChanged:function(A,B){this.loaded++;if(this.delegate[B]){this.delegate[B](this.loaded,this.images.length,A)}if(this.loaded==this.images.length&&this.delegate.allImagesDidLoad){this.delegate.allImagesDidLoad()}}};n2i.cookie={set:function(C,D,E){var A;if(E){var B=new Date();B.setTime(B.getTime()+(E*24*60*60*1000));A="; expires="+B.toGMTString()}else{A=""}document.cookie=C+"="+D+A+"; path=/"},get:function(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)==0){return E.substring(D.length,E.length)}}return null},clear:function(A){this.set(A,"",-1)}};n2i.URL=function(A){this.url=A||""};n2i.URL.prototype={addParameter:function(A,B){this.url+=this.url.indexOf("?")!=-1?"&":"?";this.url+=A+"="+(n2i.isDefined(B)?B:"")},toString:function(){return this.url}};n2i.location={getParameter:function(A){var C=n2i.location.getParameters();for(var B=0;B<C.length;B++){if(C[B].name==A){return C[B].value}}return null},setParameter:function(A,E){var C=n2i.location.getParameters();var D=false;for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=E;D=true;break}}if(!D){C.push({name:A,value:E})}n2i.location.setParameters(C)},hasHash:function(A){var B=document.location.hash;if(B!==""){return B=="#"+A}return false},getHashParameter:function(A){var D=document.location.hash;if(D!==""){var B=D.indexOf(A+"=");if(B!==-1){var C=D.substring(B+A.length+1);if(C.indexOf("&")!==-1){return C.substring(0,C.indexOf("&"))}return C}}return null},clearHash:function(){document.location.hash="#"},setParameters:function(B){var C="";for(var A=0;A<B.length;A++){C+=A==0?"?":"&";C+=B[A].name+"="+B[A].value}document.location.search=C},getBoolean:function(A){var B=n2i.location.getParameter(A);return(B=="true"||B=="1")},getParameters:function(){var B=document.location.search.substring(1).split("&");var A=[];for(var D=0;D<B.length;D++){var E=B[D].split("=");var C=unescape(E[0]).replace(/^\s*|\s*$/g,"");var F=unescape(E[1]).replace(/^\s*|\s*$/g,"");if(C){A.push({name:C,value:F})}}return A}};n2i.ani=n2i.animate=function(A,C,D,E,B){n2i.animation.get(A).animate(null,D,C,E,B)};n2i.animation={objects:{},running:false,latestId:0,get:function(A){A=n2i.get(A);if(!A.n2iAnimationId){A.n2iAnimationId=this.latestId++}if(!this.objects[A.n2iAnimationId]){this.objects[A.n2iAnimationId]=new n2i.animation.Item(A)}return this.objects[A.n2iAnimationId]},start:function(){if(!this.running){n2i.animation.render()}}};n2i.animation.render=function(G){this.running=true;var I=false;var A=new Date().getTime();for(var B in this.objects){var F=this.objects[B];if(F.work){for(var H=0;H<F.work.length;H++){var L=F.work[H];if(L.finished){continue}var E=(A-L.start)/(L.end-L.start);if(E<0){I=true;continue}else{if(isNaN(E)){E=1}else{if(E>1){E=1}else{if(E<1){I=true}}}}var O=E;if(L.delegate&&L.delegate.ease){O=L.delegate.ease(O)}var N=null;if(!L.css){F.element[L.property]=Math.round(L.from+(L.to-L.from)*O)}else{if(L.property=="transform"&&!n2i.browser.msie){var P=L.transform;var K="";if(P.rotate){K+=" rotate("+(P.rotate.from+(P.rotate.to-P.rotate.from)*O)+P.rotate.unit+")"}if(P.scale){K+=" scale("+(P.scale.from+(P.scale.to-P.scale.from)*O)+")"}F.element.style[n2i.animation.TRANSFORM]=K}else{if(L.to.red!=null){var C=Math.round(L.from.red+(L.to.red-L.from.red)*O);var D=Math.round(L.from.green+(L.to.green-L.from.green)*O);var M=Math.round(L.from.blue+(L.to.blue-L.from.blue)*O);N="rgb("+C+","+D+","+M+")";F.element.style[L.property]=N}else{if(!n2i.browser.opacity&&L.property=="opacity"){var J=(L.from+(L.to-L.from)*O);if(J==1){F.element.style.removeAttribute("filter")}else{F.element.style["filter"]="alpha(opacity="+(J*100)+")"}}else{N=new String(L.from+(L.to-L.from)*O)+(L.unit!=null?L.unit:"");F.element.style[L.property]=N}}}}if(E==1){L.finished=true;if(L.delegate&&L.delegate.onComplete){window.setTimeout(L.delegate.onComplete)}else{if(L.delegate&&L.delegate.hideOnComplete){F.element.style.display="none"}}}}}}if(I){window.setTimeout(function(){n2i.animation.render()},0)}else{this.running=false}};n2i.animation.parseStyle=function(D){var B={type:null,value:null,unit:null};var C;if(!n2i.isDefined(D)){return B}else{if(!isNaN(D)){B.value=parseFloat(D)}else{if(C=D.match(/([\-]?[0-9\.]+)(px|pt|%)/)){B.type="length";B.value=parseFloat(C[1]);B.unit=C[2]}else{if(C=D.match(/rgb\(([0-9]+),[ ]?([0-9]+),[ ]?([0-9]+)\)/)){B.type="color";B.value={red:parseInt(C[1]),green:parseInt(C[2]),blue:parseInt(C[3])}}else{var A=new n2i.Color(D);if(A.ok){B.value={red:A.r,green:A.g,blue:A.b}}}}}}return B};n2i.animation.Item=function(A){this.element=A;this.work=[]};n2i.animation.Item.prototype.animate=function(H,I,J,B,F){var D=true;if(J=="scrollLeft"||J=="scrollTop"){D=false}var G=this.getWork(D?n2i.camelize(J):J);G.delegate=F;G.finished=false;G.css=D;if(H!=null){G.from=H}else{if(J=="transform"){G.transform=n2i.animation.Item.parseTransform(I,this.element)}else{if(G.css&&!n2i.browser.opacity&&J=="opacity"){G.from=this.getIEOpacity(this.element)}else{if(G.css){var A=n2i.getStyle(this.element,J);var C=n2i.animation.parseStyle(A);G.from=C.value}else{G.from=this.element[J]}}}}if(G.css){var E=n2i.animation.parseStyle(I);G.to=E.value;G.unit=E.unit}else{G.to=I;G.unit=null}G.start=new Date().getTime();if(F&&F.delay){G.start+=F.delay}G.end=G.start+B;n2i.animation.start()};n2i.animation.TRANSFORM=n2i.browser.gecko?"MozTransform":"WebkitTransform";n2i.animation.Item.parseTransform=function(G,D){var I={};var F,E;var H=/rotate\(([0-9\.]+)([a-z]+)\)/i;var C=G.match(H);if(C){F=0;if(D.style[n2i.animation.TRANSFORM]){E=D.style[n2i.animation.TRANSFORM].match(H);if(E){F=parseFloat(E[1])}}I.rotate={from:F,to:parseFloat(C[1]),unit:C[2]}}var A=/scale\(([0-9\.]+)\)/i;var B=G.match(A);if(B){F=1;if(D.style[n2i.animation.TRANSFORM]){E=D.style[n2i.animation.TRANSFORM].match(A);if(E){F=parseFloat(E[1])}}I.scale={from:F,to:parseFloat(B[1])}}return I};n2i.animation.Item.prototype.getIEOpacity=function(B){var C=n2i.getStyle(B,"filter").toLowerCase();var A;if(A=C.match(/opacity=([0-9]+)/)){return parseFloat(A[1])/100}else{return 1}};n2i.animation.Item.prototype.getWork=function(C){for(var B=0;B<this.work.length;B++){if(this.work[B].property==C){return this.work[B]}}var A={property:C};this.work[this.work.length]=A;return A};n2i.animation.Loop=function(A){this.recipe=A;this.position=-1;this.running=false};n2i.animation.Loop.prototype.next=function(){this.position++;if(this.position>=this.recipe.length){this.position=0}var B=this.recipe[this.position];if(typeof (B)=="function"){B()}else{if(B.element){n2i.ani(B.element,B.property,B.value,B.duration,{ease:B.ease})}}var A=this;var C=B.duration||0;window.setTimeout(function(){A.next()},C)};n2i.animation.Loop.prototype.start=function(){this.running=true;this.next()};n2i.Color=function(G){this.ok=false;if(G.charAt(0)=="#"){G=G.substr(1,6)}G=G.replace(/ /g,"");G=G.toLowerCase();var A={white:"ffffff",black:"000000",red:"ff0000",green:"00ff00",blue:"0000ff"};for(var C in A){if(G==C){G=A[C]}}var H=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(I){return[parseInt(I[1]),parseInt(I[2]),parseInt(I[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(I){return[parseInt(I[1],16),parseInt(I[2],16),parseInt(I[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(I){return[parseInt(I[1]+I[1],16),parseInt(I[2]+I[2],16),parseInt(I[3]+I[3],16)]}}];for(var B=0;B<H.length;B++){var E=H[B].re;var D=H[B].process;var F=E.exec(G);if(F){channels=D(F);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var K=this.r.toString(16);var J=this.g.toString(16);var I=this.b.toString(16);if(K.length==1){K="0"+K}if(J.length==1){J="0"+J}if(I.length==1){I="0"+I}return"#"+K+J+I}};n2i.Color.hsv2rgb=function(F,I,E){var N=F/360,K,P,C;if(I==0){K=E*255;P=E*255;C=E*255}else{var L=N*6,D,M,O;var J=Math.floor(L);var A=E*(1-I);var T=E*(1-I*(L-J));var Q=E*(1-I*(1-(L-J)));if(J==0){D=E;M=Q;O=A}else{if(J==1){D=T;M=E;O=A}else{if(J==2){D=A;M=E;O=Q}else{if(J==3){D=A;M=T;O=E}else{if(J==4){D=Q;M=A;O=E}else{D=E;M=A;O=T}}}}}K=Math.round(D*255);P=Math.round(M*255);C=Math.round(O*255)}return new Array(K,P,C)};n2i.Color.rgb2hsv=function(G,F,B){G=(G/255);F=(F/255);B=(B/255);var D=Math.min(Math.min(G,F),B),A=Math.max(Math.max(G,F),B),H=A,E,C;if(A==D){C=0}else{if(A==G){C=(60*((F-B)/(A-D)))%360}else{if(A==F){C=60*((B-G)/(A-D))+120}else{if(A==B){C=60*((G-F)/(A-D))+240}}}}if(C<0){C+=360}if(A==0){E=0}else{E=1-(D/A)}return[Math.round(C),Math.round(E*100),Math.round(H*100)]};n2i.Color.rgb2hex=function(B){var D="#";for(var A=0;A<3;A++){var C=parseInt(B[A]).toString(16);if(C.length<2){C="0"+C}D+=C}return D};n2i.ease={slowFastSlow:function(C){var B=1.6;var A=1.4;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},fastSlow:function(C){var B=0.5;var A=0.7;return -1*Math.pow(Math.cos((Math.PI/2)*Math.pow(C,B)),Math.pow(Math.PI,A))+1},elastic:function(A){return 1-n2i.ease.elastic2(1-A)},elastic2:function(B,A,D){if(B<=0||B>=1){return B}if(!D){D=0.45}var C;if(!A||A<1){A=1;C=D/4}else{C=D/(2*Math.PI)*Math.asin(1/A)}return -(A*Math.pow(2,10*(B-=1))*Math.sin((B-C)*(2*Math.PI)/D))},bounce:function(A){if(A<(1/2.75)){return 7.5625*A*A}else{if(A<(2/2.75)){return(7.5625*(A-=(1.5/2.75))*A+0.75)}else{if(A<(2.5/2.75)){return(7.5625*(A-=(2.25/2.75))*A+0.9375)}else{return(7.5625*(A-=(2.625/2.75))*A+0.984375)}}}},linear:function(A){return A},quadIn:function(A){return Math.pow(A,2)},quadOut:function(A){return A*(A-2)*-1},quadInOut:function(A){A=A*2;if(A<1){return Math.pow(A,2)/2}return -1*((--A)*(A-2)-1)/2},cubicIn:function(A){return Math.pow(A,3)},cubicOut:function(A){return Math.pow(A-1,3)+1},cubicInOut:function(A){A=A*2;if(A<1){return Math.pow(A,3)/2}A-=2;return(Math.pow(A,3)+2)/2},quartIn:function(A){return Math.pow(A,4)},quartOut:function(A){return -1*(Math.pow(A-1,4)-1)},quartInOut:function(A){A=A*2;if(A<1){return Math.pow(A,4)/2}A-=2;return -1/2*(Math.pow(A,4)-2)},quintIn:function(A){return Math.pow(A,5)},quintOut:function(A){return Math.pow(A-1,5)+1},quintInOut:function(A){A=A*2;if(A<1){return Math.pow(A,5)/2}A-=2;return(Math.pow(A,5)+2)/2},sineIn:function(A){return -1*Math.cos(A*(Math.PI/2))+1},sineOut:function(A){return Math.sin(A*(Math.PI/2))},sineInOut:function(A){return -1*(Math.cos(Math.PI*A)-1)/2},expoIn:function(A){return(A==0)?0:Math.pow(2,10*(A-1))},expoOut:function(A){return(A==1)?1:(-1*Math.pow(2,-10*A)+1)},expoInOut:function(A){if(A==0){return 0}if(A==1){return 1}A=A*2;if(A<1){return Math.pow(2,10*(A-1))/2}--A;return(-1*Math.pow(2,-10*A)+2)/2},circIn:function(A){return -1*(Math.sqrt(1-Math.pow(A,2))-1)},circOut:function(A){A=A-1;return Math.sqrt(1-Math.pow(A,2))},circInOut:function(A){A=A*2;if(A<1){return -1/2*(Math.sqrt(1-Math.pow(A,2))-1)}A-=2;return 1/2*(Math.sqrt(1-Math.pow(A,2))+1)},backIn:function(B){var A=1.70158;return Math.pow(B,2)*((A+1)*B-A)},backOut:function(B){B=B-1;var A=1.70158;return Math.pow(B,2)*((A+1)*B+A)+1},backInOut:function(B){var A=1.70158*1.525;B=B*2;if(B<1){return(Math.pow(B,2)*((A+1)*B-A))/2}B-=2;return(Math.pow(B,2)*((A+1)*B+A)+2)/2},elasticIn:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;C=C-1;return -1*Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B)},elasticOut:function(C){if(C==0){return 0}if(C==1){return 1}var B=0.3;var A=B/4;return Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B)+1},elasticInOut:function(C){if(C==0){return 0}C=C*2;if(C==2){return 1}var B=0.3*1.5;var A=B/4;if(C<1){C-=1;return -0.5*(Math.pow(2,10*C)*Math.sin((C-A)*(2*Math.PI)/B))}C-=1;return 0.5*(Math.pow(2,-10*C)*Math.sin((C-A)*(2*Math.PI)/B))+1},bounceIn:function(A){return(1-n2i.ease.bounceOut(1-A))},bounceOut:function(D){var B=7.5625;var C=2.75;var A;if(D<(1/C)){A=B*Math.pow(D,2)}else{if(D<(2/C)){D-=(1.5/C);A=B*Math.pow(D,2)+0.75}else{if(D<(2.5/C)){D-=(2.25/C);A=B*Math.pow(D,2)+0.9375}else{D-=(2.625/C);A=B*Math.pow(D,2)+0.984375}}}return A},bounceInOut:function(A){if(A<0.5){return n2i.ease.bounceIn(A*2)/2}return(n2i.ease.bounceOut(A*2-1)/2)+0.5}};if(!Function.prototype.bind){Function.prototype.bind=function(){if(arguments.length<2&&arguments[0]===undefined){return this}var C=this,A=Array.prototype.slice.call(arguments),B=A.shift();return function(){return C.apply(B,A.concat(Array.prototype.slice.call(arguments)))}};Function.bind=function(){var A=Array.prototype.slice.call(arguments);return Function.prototype.bind.apply(A.shift(),A)}}if(!Function.prototype.argumentNames){Function.prototype.argumentNames=function(){var A=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return A.length==1&&!A[0]?[]:A}}var SWFUpload=function(A){this.initSWFUpload(A)};SWFUpload.prototype.initSWFUpload=function(B){try{this.customSettings={};this.settings=B;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(A){delete SWFUpload.instances[this.movieName];throw A}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 Alpha";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(B,A){this.settings[B]=(this.settings[B]==undefined)?A:this.settings[B]};this.ensureDefault("upload_url","");this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id",null);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",function(A){n2i.log(A)});this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+"?swfuploadrnd="+Math.floor(Math.random()*999999999)}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){if(this.settings.button_placeholder_id!==""){this.replaceWithFlash()}else{this.appendFlash()}};SWFUpload.prototype.appendFlash=function(){var B,A;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}B=document.getElementsByTagName("body")[0];if(B==undefined){throw"Could not find the 'body' element."}A=document.createElement("div");A.style.width="1px";A.style.height="1px";A.style.overflow="hidden";B.appendChild(A);A.innerHTML=this.getFlashHTML()};SWFUpload.prototype.replaceWithFlash=function(){var A,B;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}A=this.settings.button_placeholder||document.getElementById(this.settings.button_placeholder_id);if(A==undefined){throw"Could not find the placeholder element."}B=document.createElement("div");B.innerHTML=this.getFlashHTML();A.parentNode.replaceChild(B.firstChild,A)};SWFUpload.prototype.getFlashHTML=function(){var A=this.settings.button_image_url===""?true:false;return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',A?"transparent":"window",'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var A=this.buildParamString();return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;params=",encodeURIComponent(A),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled)].join("")};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var C=this.settings.post_params;var B=[];if(typeof (C)==="object"){for(var A in C){if(C.hasOwnProperty(A)){B.push(encodeURIComponent(A.toString())+"="+encodeURIComponent(C[A].toString()))}}}return B.join("&amp;")};SWFUpload.prototype.destroy=function(){try{this.stopUpload();var B=null;try{B=this.getMovieElement()}catch(C){}if(B!=undefined&&B.parentNode!=undefined&&typeof B.parentNode.removeChild==="function"){var A=B.parentNode;if(A!=undefined){A.removeChild(B);if(A.parentNode!=undefined&&typeof A.parentNode.removeChild==="function"){A.parentNode.removeChild(A)}}}SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];delete this.movieElement;delete this.settings;delete this.customSettings;delete this.eventQueue;delete this.movieName;delete window[this.movieName];return true}catch(D){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))};SWFUpload.prototype.addSetting=function(B,C,A){if(C==undefined){return(this.settings[B]=A)}else{return(this.settings[B]=C)}};SWFUpload.prototype.getSetting=function(A){if(this.settings[A]!=undefined){return this.settings[A]}return""};SWFUpload.prototype.callFlash=function(C,D){D=D||[];var A=this.getMovieElement();var B;if(typeof A[C]==="function"){if(D.length===0){B=A[C]()}else{if(D.length===1){B=A[C](D[0])}else{if(D.length===2){B=A[C](D[0],D[1])}else{if(D.length===3){B=A[C](D[0],D[1],D[2])}else{throw"Too many arguments"}}}}if(B!=undefined&&typeof B.post==="object"){B=this.unescapeFilePostParams(B)}return B}else{throw"Invalid function name: "+C}};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(A){this.callFlash("StartUpload",[A])};SWFUpload.prototype.cancelUpload=function(A){this.callFlash("CancelUpload",[A])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(A){this.callFlash("SetStats",[A])};SWFUpload.prototype.getFile=function(A){if(typeof (A)==="number"){return this.callFlash("GetFileByIndex",[A])}else{return this.callFlash("GetFile",[A])}};SWFUpload.prototype.addFileParam=function(A,B,C){return this.callFlash("AddFileParam",[A,B,C])};SWFUpload.prototype.removeFileParam=function(A,B){this.callFlash("RemoveFileParam",[A,B])};SWFUpload.prototype.setUploadURL=function(A){this.settings.upload_url=A.toString();this.callFlash("SetUploadURL",[A])};SWFUpload.prototype.setPostParams=function(A){this.settings.post_params=A;this.callFlash("SetPostParams",[A])};SWFUpload.prototype.addPostParam=function(A,B){this.settings.post_params[A]=B;this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.removePostParam=function(A){delete this.settings.post_params[A];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(A,B){this.settings.file_types=A;this.settings.file_types_description=B;this.callFlash("SetFileTypes",[A,B])};SWFUpload.prototype.setFileSizeLimit=function(A){this.settings.file_size_limit=A;this.callFlash("SetFileSizeLimit",[A])};SWFUpload.prototype.setFileUploadLimit=function(A){this.settings.file_upload_limit=A;this.callFlash("SetFileUploadLimit",[A])};SWFUpload.prototype.setFileQueueLimit=function(A){this.settings.file_queue_limit=A;this.callFlash("SetFileQueueLimit",[A])};SWFUpload.prototype.setFilePostName=function(A){this.settings.file_post_name=A;this.callFlash("SetFilePostName",[A])};SWFUpload.prototype.setUseQueryString=function(A){this.settings.use_query_string=A;this.callFlash("SetUseQueryString",[A])};SWFUpload.prototype.setRequeueOnError=function(A){this.settings.requeue_on_error=A;this.callFlash("SetRequeueOnError",[A])};SWFUpload.prototype.setDebugEnabled=function(A){this.settings.debug_enabled=A;this.callFlash("SetDebugEnabled",[A])};SWFUpload.prototype.setButtonImageURL=function(A){if(A==undefined){A=""}this.settings.button_image_url=A;this.callFlash("SetButtonImageURL",[A])};SWFUpload.prototype.setButtonDimensions=function(C,A){this.settings.button_width=C;this.settings.button_height=A;var B=this.getMovieElement();if(B!=undefined){B.style.width=C+"px";B.style.height=A+"px"}this.callFlash("SetButtonDimensions",[C,A])};SWFUpload.prototype.setButtonText=function(A){this.settings.button_text=A;this.callFlash("SetButtonText",[A])};SWFUpload.prototype.setButtonTextPadding=function(B,A){this.settings.button_text_top_padding=A;this.settings.button_text_left_padding=B;this.callFlash("SetButtonTextPadding",[B,A])};SWFUpload.prototype.setButtonTextStyle=function(A){this.settings.button_text_style=A;this.callFlash("SetButtonTextStyle",[A])};SWFUpload.prototype.setButtonDisabled=function(A){this.settings.button_disabled=A;this.callFlash("SetButtonDisabled",[A])};SWFUpload.prototype.setButtonAction=function(A){this.settings.button_action=A;this.callFlash("SetButtonAction",[A])};SWFUpload.prototype.queueEvent=function(B,C){if(C==undefined){C=[]}else{if(!(C instanceof Array)){C=[C]}}var A=this;if(typeof this.settings[B]==="function"){this.eventQueue.push(function(){this.settings[B].apply(this,C)});setTimeout(function(){A.executeNextEvent()},0)}else{if(this.settings[B]!==null){throw"Event handler "+B+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var A=this.eventQueue?this.eventQueue.shift():null;if(typeof (A)==="function"){A.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(C){var E=/[$]([0-9a-f]{4})/i;var F={};var D;if(C!=undefined){for(var A in C.post){if(C.post.hasOwnProperty(A)){D=A;var B;while((B=E.exec(D))!==null){D=D.replace(B[0],String.fromCharCode(parseInt("0x"+B[1],16)))}F[D]=C.post[A]}}C.post=F}return C};SWFUpload.prototype.flashReady=function(){var A=this.getMovieElement();if(typeof A.StartUpload!=="function"){throw"ExternalInterface methods failed to initialize."}if(window[this.movieName]==undefined){window[this.movieName]=A}this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("file_queued_handler",A)};SWFUpload.prototype.fileQueueError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("file_queue_error_handler",[A,C,B])};SWFUpload.prototype.fileDialogComplete=function(A,B){this.queueEvent("file_dialog_complete_handler",[A,B])};SWFUpload.prototype.uploadStart=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("return_upload_start_handler",A)};SWFUpload.prototype.returnUploadStart=function(A){var B;if(typeof this.settings.upload_start_handler==="function"){A=this.unescapeFilePostParams(A);B=this.settings.upload_start_handler.call(this,A)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(B===undefined){B=true}B=!!B;this.callFlash("ReturnUploadStart",[B])};SWFUpload.prototype.uploadProgress=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_progress_handler",[A,C,B])};SWFUpload.prototype.uploadError=function(A,C,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_error_handler",[A,C,B])};SWFUpload.prototype.uploadSuccess=function(B,A){B=this.unescapeFilePostParams(B);this.queueEvent("upload_success_handler",[B,A])};SWFUpload.prototype.uploadComplete=function(A){A=this.unescapeFilePostParams(A);this.queueEvent("upload_complete_handler",A)};SWFUpload.prototype.debug=function(A){n2i.log(A)};if(!this.JSON){JSON=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}if(typeof value.toJSON==="function"){return stringify(value.toJSON())}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||"null")}return"["+a.join(",")+"]"}if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}else{for(k in value){if(typeof k==="string"){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==="object"){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n}}}}return filter(k,v)}if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof filter==="function"?walk("",j):j}throw new SyntaxError("parseJSON")}}}()}Date.parseFunctions={count:0};Date.parseRegexes=[];Date.formatFunctions={count:0};Date.prototype.dateFormat=function(B){if(Date.formatFunctions[B]==null){Date.createNewFormat(B)}var A=Date.formatFunctions[B];return this[A]()};Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code="Date.prototype."+funcName+" = function(){return ";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;code+="'"+String.escape(ch)+"' + "}else{code+=Date.getFormatCode(ch)}}}eval(code.substring(0,code.length-3)+";}")};Date.getFormatCode=function(A){switch(A){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(A)+"' + "}};Date.parseDate=function(A,C){if(Date.parseFunctions[C]==null){Date.createParser(C)}var B=Date.parseFunctions[C];return Date[B](A)};Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++;var regexNum=Date.parseRegexes.length;var currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input){\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {";var regex="";var special=false;var ch="";for(var i=0;i<format.length;++i){ch=format.charAt(i);if(!special&&ch=="\\"){special=true}else{if(special){special=false;regex+=String.escape(ch)}else{var obj=Date.formatCodeToRegex(ch,currentGroup);currentGroup+=obj.g;regex+=obj.s;if(obj.g&&obj.c){code+=obj.c}}}}code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}";Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$");eval(code)};Date.formatCodeToRegex=function(B,A){switch(B){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:0,c:null,s:"(?:\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+A+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+A+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+A+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+A+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+A+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+A+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+A+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+A+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(B)}}};Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")};Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(this.getTimezoneOffset()/60),2,"0")+String.leftPad(this.getTimezoneOffset()%60,2,"0")};Date.prototype.getDayOfYear=function(){var A=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var B=0;B<this.getMonth();++B){A+=Date.daysInMonth[B]}return A+this.getDate()-1};Date.prototype.getWeekOfYear=function(){var B=this.getDayOfYear()+(5-this.getDay());var A=new Date(this.getFullYear(),0,1);var C=(5-A.getDay());return parseInt(String.leftPad(((B-C)/7)+1,2,"0"))};Date.prototype.isLeapYear=function(){var A=this.getFullYear();return((A&3)==0&&(A%100||(A%400==0&&A)))};Date.prototype.getFirstDayOfMonth=function(){var A=(this.getDay()-(this.getDate()-1))%7;return(A<0)?(A+7):A};Date.prototype.getLastDayOfMonth=function(){var A=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return(A<0)?(A+7):A};Date.prototype.getDaysInMonth=function(){Date.daysInMonth[1]=this.isLeapYear()?29:28;return Date.daysInMonth[this.getMonth()]};Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};String.escape=function(A){return A.replace(/('|\\)/g,"\\$1")};String.leftPad=function(D,B,C){var A=new String(D);if(C==null){C=" "}while(A.length<B){A=C+A}return A};Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.y2kYear=50;Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"};function In2iGui(){this.domLoaded=false;this.overflows=null;this.delegates=[];this.objects={};this.layoutWidgets=[];this.addBehavior()}window.ui=In2iGui;In2iGui.latestObjectIndex=0;In2iGui.latestIndex=500;In2iGui.latestPanelIndex=1000;In2iGui.latestAlertIndex=1500;In2iGui.latestTopIndex=2000;In2iGui.toolTips={};In2iGui.context="";In2iGui.language="en";In2iGui.state="default";In2iGui.get=function(A){if(!In2iGui.instance){In2iGui.instance=new In2iGui()}if(A){if(A.element){return A}return In2iGui.instance.objects[A]}else{return In2iGui.instance}};n2i.onReady(function(){In2iGui.get().ignite()});In2iGui.prototype={ignite:function(){if(window.dwr&&window.dwr.engine&&window.dwr.engine.setErrorHandler){window.dwr.engine.setErrorHandler(function(B,A){n2i.log(B);n2i.log(A);In2iGui.get().alert({title:"An unexpected error occurred!",text:B,emotion:"gasp"})})}this.domLoaded=true;In2iGui.domReady=true;this.resize();In2iGui.callSuperDelegates(this,"ready");this.reLayout();n2i.listen(window,"resize",this.reLayout.bind(this))},addBehavior:function(){n2i.listen(window,"resize",this.resize.bind(this))},listen:function(A){this.delegates.push(A)},getTopPad:function(A){var B,C;B=parseInt(n2i.getStyle(A,"padding"),10);C=parseInt(n2i.getStyle(A,"padding-top"),10);if(B){return B}if(C){return C}return 0},getBottomPad:function(B){var C,A;C=parseInt(n2i.getStyle(B,"padding"),10);A=parseInt(n2i.getStyle(B,"padding-bottom"),10);if(C){return C}if(A){return A}return 0},resize:function(){if(!this.overflows){return }var A=n2i.getViewPortHeight();for(var B=0;B<this.overflows.length;B++){var C=this.overflows[B];if(n2i.browser.webkit||n2i.browser.gecko){C.element.style.display="none";C.element.style.width=C.element.parentNode.clientWidth+"px";C.element.style.display=""}C.element.style.height=A+C.diff+"px"}},registerOverflow:function(C,A){if(!this.overflows){this.overflows=[]}var B=n2i.get(C);this.overflows.push({element:B,diff:A})},alert:function(A){if(!this.alertBox){this.alertBox=In2iGui.Alert.create(A);this.alertBoxButton=In2iGui.Button.create({name:"in2iGuiAlertBoxButton",text:"OK"});this.alertBoxButton.listen(this);this.alertBox.addButton(this.alertBoxButton)}else{this.alertBox.update(A)}this.alertBoxCallBack=A.onOK;this.alertBoxButton.setText(A.button?A.button:"OK");this.alertBox.show()},$click$in2iGuiAlertBoxButton:function(){In2iGui.get().alertBox.hide();if(this.alertBoxCallBack){this.alertBoxCallBack();this.alertBoxCallBack=null}},confirm:function(A){if(!A.name){A.name="in2iguiConfirm"}var D=In2iGui.get(A.name);var B;if(!D){D=In2iGui.Alert.create(A);var C=In2iGui.Button.create({name:name+"_cancel",text:A.cancel||"Cancel",highlighted:A.highlighted==="cancel"});C.listen({$click:function(){D.hide();if(A.onCancel){A.onCancel()}In2iGui.callDelegates(D,"cancel")}});D.addButton(C);B=In2iGui.Button.create({name:name+"_ok",text:A.ok||"OK",highlighted:A.highlighted==="ok"});D.addButton(B)}else{D.update(A);B=In2iGui.get(name+"_ok");B.setText(A.ok||"OK");B.setHighlighted(A.highlighted=="ok");B.clearDelegates();In2iGui.get(name+"_cancel").setText(A.ok||"Cancel");In2iGui.get(name+"_cancel").setHighlighted(A.highlighted=="cancel");if(A.cancel){In2iGui.get(name+"_cancel").setText(A.cancel)}}B.listen({$click:function(){D.hide();if(A.onOK){A.onOK()}In2iGui.callDelegates(D,"ok")}});D.show()},reLayout:function(){for(var A=this.layoutWidgets.length-1;A>=0;A--){this.layoutWidgets[A]["$$layout"]()}},getDescendants:function(H){var G=[],D=H.getElement?H.getElement():H;if(D){var F=D.getElementsByTagName("*");var E=[];for(var C in this.objects){E.push(this.objects[C])}for(var B=0;B<F.length;B++){for(var A=0;A<E.length;A++){if(F[B]==E[A].element){G.push(E[A])}}}}return G},getAncestors:function(E){var H=[];var F=E.element;if(F){var A=n2i.getAncestors(F);var G=[];for(var D in this.objects){G.push(this.objects[D])}for(var C=0;C<A.length;C++){for(var B=0;B<G.length;B++){if(G[B].element==A[C]){H.push(G[B])}}}}return H},getAncestor:function(D,B){var A=this.getAncestors(D);for(var C=0;C<A.length;C++){if(n2i.hasClass(A[C].getElement(),B)){return A[C]}}return null}};In2iGui.confirmOverlays={};In2iGui.confirmOverlay=function(B){var E=B.element||B.widget.getElement(),A;if(In2iGui.confirmOverlays[E]){A=In2iGui.confirmOverlays[E];A.clear()}else{A=In2iGui.Overlay.create({modal:true});In2iGui.confirmOverlays[E]=A}if(B.text){A.addText(B.text)}var C=In2iGui.Button.create({text:B.okText||"OK",highlighted:"true"});C.click(function(){if(B.onOk){B.onOk()}A.hide()});A.add(C);var D=In2iGui.Button.create({text:B.cancelText||"Cancel"});D.onClick(function(){A.hide()});A.add(D);A.show({element:E})};In2iGui.destroy=function(B){var A=In2iGui.get().objects;delete (A[B.name])};In2iGui.destroyDescendants=function(B){var E=In2iGui.get().getDescendants(B);var C=In2iGui.get().objects;for(var A=0;A<E.length;A++){var D=delete (C[E[A].name]);if(!D){n2i.log("not found: "+E[A].name)}}};In2iGui.changeState=function(C){if(In2iGui.state===C){return }var B=In2iGui.get().objects,A,D;for(A in B){D=B[A];if(D.options&&D.options.state){if(D.options.state==C){D.show()}else{D.hide()}}}In2iGui.state=C};In2iGui.nextIndex=function(){In2iGui.latestIndex++;return In2iGui.latestIndex};In2iGui.nextPanelIndex=function(){In2iGui.latestPanelIndex++;return In2iGui.latestPanelIndex};In2iGui.nextAlertIndex=function(){In2iGui.latestAlertIndex++;return In2iGui.latestAlertIndex};In2iGui.nextTopIndex=function(){In2iGui.latestTopIndex++;return In2iGui.latestTopIndex};In2iGui.showCurtain=function(B,D){var C=B.widget;if(!C.curtain){C.curtain=n2i.build("div",{"class":"in2igui_curtain",style:"z-index:none"});C.curtain.onclick=function(){if(C["$curtainWasClicked"]){C["$curtainWasClicked"]()}};var A=n2i.firstByClass(document.body,"in2igui_body");if(!A){A=document.body}A.appendChild(C.curtain)}if(B.color){C.curtain.style.backgroundColor=B.color}if(n2i.browser.msie){C.curtain.style.height=n2i.getDocumentHeight()+"px"}else{C.curtain.style.position="fixed";C.curtain.style.top="0";C.curtain.style.left="0";C.curtain.style.bottom="0";C.curtain.style.right="0"}C.curtain.style.zIndex=B.zIndex;n2i.setOpacity(C.curtain,0);C.curtain.style.display="block";n2i.ani(C.curtain,"opacity",0.7,1000,{ease:n2i.ease.slowFastSlow})};In2iGui.hideCurtain=function(A){if(A.curtain){n2i.ani(A.curtain,"opacity",0,200,{hideOnComplete:true})}};In2iGui.alert=function(A){In2iGui.get().alert(A)};In2iGui.showMessage=function(B){if(typeof (B)=="string"){B={text:B}}if(B.delay){In2iGui.messageDelayTimer=window.setTimeout(function(){B.delay=null;In2iGui.showMessage(B)},B.delay);return }window.clearTimeout(In2iGui.messageDelayTimer);if(!In2iGui.message){In2iGui.message=n2i.build("div",{"class":"in2igui_message",html:"<div><div></div></div>"});if(!n2i.browser.msie){n2i.setOpacity(In2iGui.message,0)}document.body.appendChild(In2iGui.message)}var A=In2iGui.message.getElementsByTagName("div")[1];if(B.icon){n2i.dom.clear(A);A.appendChild(In2iGui.createIcon(B.icon,24));n2i.dom.addText(A,B.text)}else{if(B.busy){A.innerHTML='<span class="in2igui_message_busy"></span>';n2i.dom.addText(A,B.text)}else{n2i.dom.setText(A,B.text)}}In2iGui.message.style.display="block";In2iGui.message.style.zIndex=In2iGui.nextTopIndex();In2iGui.message.style.marginLeft=(In2iGui.message.clientWidth/-2)+"px";In2iGui.message.style.marginTop=n2i.getScrollTop()+"px";if(n2i.browser.opacity){n2i.ani(In2iGui.message,"opacity",1,300)}window.clearTimeout(In2iGui.messageTimer);if(B.duration){In2iGui.messageTimer=window.setTimeout(In2iGui.hideMessage,B.duration)}};In2iGui.hideMessage=function(){window.clearTimeout(In2iGui.messageDelayTimer);if(In2iGui.message){if(n2i.browser.opacity){n2i.ani(In2iGui.message,"opacity",0,300,{hideOnComplete:true})}else{In2iGui.message.style.display="none"}}};In2iGui.showToolTip=function(A){var C=A.key||"common";var B=In2iGui.toolTips[C];if(!B){B=n2i.build("div",{"class":"in2igui_tooltip",style:"display:none;",html:"<div><div></div></div>",parent:document.body});In2iGui.toolTips[C]=B}B.onclick=function(){In2iGui.hideToolTip(A)};var E=n2i.get(A.element);var D=n2i.getPosition(E);n2i.dom.setText(B.getElementsByTagName("div")[1],A.text);if(B.style.display=="none"&&n2i.browser.opacity){n2i.setOpacity(B,0)}n2i.setStyle(B,{"display":"block",zIndex:In2iGui.nextTopIndex()});n2i.setStyle(B,{left:(D.left-B.clientWidth+4)+"px",top:(D.top+2-(B.clientHeight/2)+(E.clientHeight/2))+"px"});if(n2i.browser.opacity){n2i.ani(B,"opacity",1,300)}};In2iGui.hideToolTip=function(A){var C=A?A.key||"common":"common";var B=In2iGui.toolTips[C];if(B){if(!n2i.browser.msie){n2i.ani(B,"opacity",0,300,{hideOnComplete:true})}else{n2i.style.display="none"}}};In2iGui.getElement=function(A){if(n2i.dom.isElement(A)){return A}else{if(A.getElement){return A.getElement()}}return null};In2iGui.isWithin=function(B,A){B=new n2i.Event(B);var D={left:n2i.getLeft(A),top:n2i.getTop(A)};var C={width:A.clientWidth,height:A.clientHeight};return B.left()>D.left&&B.left()<D.left+C.width&&B.top()>D.top&&B.top()<D.top+C.height};In2iGui.getIconUrl=function(B,A){return In2iGui.context+"/In2iGui/icons/"+B+A+".png"};In2iGui.createIcon=function(B,A){return n2i.build("span",{"class":"in2igui_icon in2igui_icon_"+A,style:"background-image: url("+In2iGui.getIconUrl(B,A)+")"})};In2iGui.onDomReady=In2iGui.onReady=function(A){if(In2iGui.domReady){return A()}if(n2i.browser.gecko&&n2i.string.endsWith(document.baseURI,"xml")){window.setTimeout(A,1000);return }n2i.onReady(A)};In2iGui.wrapInField=function(B){var A=n2i.build("div",{"class":"in2igui_field",html:'<span class="in2igui_field_top"><span><span></span></span></span><span class="in2igui_field_middle"><span class="in2igui_field_middle"><span class="in2igui_field_content"></span></span></span><span class="in2igui_field_bottom"><span><span></span></span></span>'});n2i.firstByClass(A,"in2igui_field_content").appendChild(B);return A};In2iGui.addFocusClass=function(B){var A=B.classElement||B.element,C=B["class"];n2i.listen(B.element,"focus",function(){n2i.addClass(A,C)});n2i.listen(B.element,"blur",function(){n2i.removeClass(A,C)})};In2iGui.NumberValidator=function(A){n2i.override({allowNull:false,min:0,max:10},A);this.min=A.min;this.max=A.max;this.allowNull=A.allowNull;this.middle=Math.max(Math.min(this.max,0),this.min)};In2iGui.NumberValidator.prototype={validate:function(B){if(n2i.isBlank(B)&&this.allowNull){return{valid:true,value:null}}var A=parseFloat(B);if(isNaN(A)){return{valid:false,value:this.middle}}else{if(A<this.min){return{valid:false,value:this.min}}else{if(A>this.max){return{valid:false,value:this.max}}}}return{valid:true,value:A}}};In2iGui.fadeIn=function(A,B){if(n2i.getStyle(A,"display")=="none"){n2i.setStyle(A,{opacity:0,display:""})}n2i.animate(A,"opacity",1,B)};In2iGui.fadeOut=function(A,B){hui.animate(A,"opacity",0,B,{hideOnComplete:true})};In2iGui.bounceIn=function(A,B){if(n2i.browser.msie){n2i.setStyle(A,{"display":"block",visibility:"visible"})}else{n2i.setStyle(A,{"display":"block","opacity":0,visibility:"visible"});n2i.animate(A,"transform","scale(0.1)",0);window.setTimeout(function(){n2i.animate(A,"opacity",1,300);n2i.animate(A,"transform","scale(1)",400,{ease:n2i.ease.backOut})})}};In2iGui.positionAtElement=function(C,G,B){B=B||{};C=n2i.get(C);G=n2i.get(G);var D=n2i.getStyle(C,"display");if(D=="none"){n2i.setStyle(C,{"visibility":"hidden","display":"block"})}var F=n2i.getLeft(G),E=n2i.getTop(G);var A=B.vertical||null;if(B.horizontal&&B.horizontal=="right"){F=F+G.clientWidth-C.clientWidth}if(A=="topOutside"){E=E-C.clientHeight}else{if(A=="bottomOutside"){E=E+G.clientHeight}}F+=(B.left||0);E+=(B.top||0);n2i.setStyle(C,{"left":F+"px","top":E+"px"});if(D=="none"){n2i.setStyle(C,{"visibility":"visible","display":"none"})}};In2iGui.getTextAreaHeight=function(A){var C=this.textAreaDummy;if(!C){C=this.textAreaDummy=document.createElement("div");C.className="in2igui_textarea_dummy";document.body.appendChild(C)}var B=A.value;if(B[B.length-1]==="\n"){B+="x"}B=n2i.escape(B).replace(/\n/g,"<br/>");C.innerHTML=B;C.style.width=(A.clientWidth)+"px";return C.clientHeight};In2iGui.extend=function(C,A){if(!C.name){In2iGui.latestObjectIndex++;C.name="unnamed"+In2iGui.latestObjectIndex}if(A!==undefined){if(C.options){C.options=n2i.override(C.options,A)}C.element=n2i.get(A.element);C.name=A.name}var B=In2iGui.get();B.objects[C.name]=C;C.delegates=[];C.listen=function(D){n2i.addToArray(this.delegates,D);return this};C.removeDelegate=function(D){n2i.removeFromArray(this.delegates,D)};C.clearDelegates=function(){this.delegates=[]};C.fire=function(F,E,D){In2iGui.callDelegates(this,F,E,D)};C.fireProperty=function(D,E){In2iGui.firePropertyChange(this,D,E)};if(!C.getElement){C.getElement=function(){return this.element}}if(!C.valueForProperty){C.valueForProperty=function(D){return this[D]}}if(C["$$layout"]){B.layoutWidgets.push(C)}};In2iGui.callDelegatesDrop=function(A,D){var B=In2iGui.get();for(var C=0;C<B.delegates.length;C++){if(B.delegates[C]["$drop$"+A.kind+"$"+D.kind]){B.delegates[C]["$drop$"+A.kind+"$"+D.kind](A,D)}}};In2iGui.callAncestors=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}var E=In2iGui.get().getAncestors(D);for(var A=0;A<E.length;A++){if(E[A][F]){E[A][F](C,B)}}};In2iGui.callDescendants=function(D,F,C,B){if(typeof (C)=="undefined"){C=D}if(!F[0]=="$"){F="$"+F}var E=In2iGui.get().getDescendants(D);for(var A=0;A<E.length;A++){if(E[A][F]){thisResult=E[A][F](C,B)}}};In2iGui.callVisible=function(A){In2iGui.callDescendants(A,"$visibilityChanged")};In2iGui.listen=function(A){In2iGui.get().listen(A)};In2iGui.callDelegates=function(E,A,H,B){if(typeof (H)=="undefined"){H=E}var I=null;if(E.delegates){for(var F=0;F<E.delegates.length;F++){var G=E.delegates[F];var C=null;if(E.name&&G["$"+A+"$"+E.name]){C=G["$"+A+"$"+E.name](H,B)}else{if(G["$"+A]){C=G["$"+A](H,B)}}if(I==null&&C!=null&&typeof (C)!="undefined"){I=C}}}var D=In2iGui.callSuperDelegates(E,A,H,B);if(I==null&&D!=null){I=D}return I};In2iGui.callSuperDelegates=function(E,A,H,B){if(typeof (H)=="undefined"){H=E}var C=In2iGui.get();var I=null;for(var F=0;F<C.delegates.length;F++){var G=C.delegates[F];var D=null;if(E.name&&G["$"+A+"$"+E.name]){D=G["$"+A+"$"+E.name](H,B)}else{if(G["$"+A]){D=G["$"+A](H,B)}}if(I==null&&D!=null&&typeof (D)!="undefined"){I=D}}return I};In2iGui.resolveImageUrl=function(H,C,G,A){for(var E=0;E<H.delegates.length;E++){if(H.delegates[E].$resolveImageUrl){return H.delegates[E].$resolveImageUrl(C,G,A)}}var B=In2iGui.get();for(var D=0;D<B.delegates.length;D++){var F=B.delegates[D];if(F.$resolveImageUrl){return F.$resolveImageUrl(C,G,A)}}return null};In2iGui.firePropertyChange=function(C,A,B){In2iGui.callDelegates(C,"propertyChanged",{property:A,value:B})};In2iGui.bind=function(E,A){if(E.charAt(0)=="@"){var D=E.substring(1).split(".");var C=In2iGui.get(D[0]);if(!C){n2i.log("Unable to bind to "+E);return }var B=D.slice(1).join(".");C.listen({$propertyChanged:function(F){if(F.property==B){A(F.value)}}});return C.valueForProperty(B)}return E};In2iGui.request=function(A){A=n2i.override({method:"post",parameters:{}},A);if(A.json){for(var B in A.json){A.parameters[B]=n2i.toJSON(A.json[B])}}var E=A.onSuccess;var D=A.message;A.onSuccess=function(G){if(D){if(D.success){In2iGui.showMessage({text:D.success,icon:"common/success",duration:D.duration||2000})}else{if(D.start){In2iGui.hideMessage()}}}var H,F;if(typeof (E)=="string"){if(!n2i.request.isXMLResponse(G)){H=G.responseText.replace(/^\s+|\s+$/g,"");if(H.length>0){F=n2i.fromJSON(G.responseText)}else{F=""}In2iGui.callDelegates(F,"success$"+E)}else{In2iGui.callDelegates(G,"success$"+E)}}else{if(n2i.request.isXMLResponse(G)&&A.onXML){A.onXML(G.responseXML)}else{if(A.onJSON){H=G.responseText.replace(/^\s+|\s+$/g,"");if(H.length>0){F=n2i.fromJSON(G.responseText)}else{F=null}A.onJSON(F)}else{if(typeof (E)=="function"){E(G)}else{if(A.onText){A.onText(G.responseText)}}}}}};var C=A.onFailure;A.onFailure=function(F){if(typeof (C)=="string"){In2iGui.callDelegates(F,"failure$"+C)}else{if(typeof (C)=="function"){C(F)}}};A.onException=function(F,G){n2i.log(F);n2i.log(G)};if(A.message&&A.message.start){In2iGui.showMessage({text:A.message.start,busy:true,delay:A.message.delay})}n2i.request(A)};In2iGui.parseItems=function(C){var A=C.documentElement;var B=[];In2iGui.parseSubItems(A,B);return B};In2iGui.parseSubItems=function(D,F){var B=D.childNodes;for(var A=0;A<B.length;A++){var E=B[A];if(E.nodeType==1&&E.nodeName=="title"){F.push({title:E.getAttribute("title"),type:"title"})}else{if(E.nodeType==1&&E.nodeName=="item"){var C=[];In2iGui.parseSubItems(E,C);F.push({title:E.getAttribute("title"),value:E.getAttribute("value"),icon:E.getAttribute("icon"),kind:E.getAttribute("kind"),badge:E.getAttribute("badge"),children:C})}}}};In2iGui.Bundle=function(A){this.strings=A};In2iGui.Bundle.prototype={get:function(B){var A=this.strings[B];if(A){return A[In2iGui.language]}n2i.log(B+" not found for language:"+In2iGui.language);return B}};In2iGui.Source=function(A){this.options=n2i.override({url:null,dwr:null,parameters:[],lazy:false},A);this.name=A.name;this.data=null;this.parameters=this.options.parameters;In2iGui.extend(this);if(A.delegate){this.listen(A.delegate)}this.busy=false;In2iGui.onDomReady(this.init.bind(this))};In2iGui.Source.prototype={init:function(){var A=this;n2i.each(this.parameters,function(C){var B=In2iGui.bind(C.value,function(D){A.changeParameter(C.key,D)});C.value=A.convertValue(B)});if(!this.options.lazy){this.refresh()}},convertValue:function(A){if(A&&A.getTime){return A.getTime()}return A},refresh:function(){if(this.delegates.length==0){return }for(var i=0;i<this.delegates.length;i++){var d=this.delegates[i];if(d["$sourceShouldRefresh"]&&d["$sourceShouldRefresh"]()==false){return }}if(this.busy){this.pendingRefresh=true;return }this.pendingRefresh=false;var self=this;if(this.options.url){var prms={};for(var j=0;j<this.parameters.length;j++){var p=this.parameters[j];prms[p.key]=p.value}this.busy=true;In2iGui.callDelegates(this,"sourceIsBusy");n2i.request({method:"post",url:this.options.url,parameters:prms,onSuccess:function(t){self.parse(t)},onException:function(e,t){n2i.log("Exception while loading source...");n2i.log(e)},onFailure:function(t){In2iGui.callDelegates(self,"sourceFailed")}})}else{if(this.options.dwr){var pair=this.options.dwr.split(".");var facade=eval(pair[0]);var method=pair[1];var args=facade[method].argumentNames();for(var k=0;k<args.length;k++){if(this.parameters[k]){args[k]=this.parameters[k].value===undefined?null:this.parameters[k].value}}args[args.length-1]=function(r){self.parseDWR(r)};this.busy=true;In2iGui.callDelegates(this,"sourceIsBusy");facade[method].apply(facade,args)}}},end:function(){this.busy=false;if(this.pendingRefresh){this.refresh()}else{In2iGui.callDelegates(this,"sourceIsNotBusy")}},parse:function(B){if(B.responseXML&&B.responseXML.documentElement&&B.responseXML.documentElement.nodeName!="parsererror"){this.parseXML(B.responseXML)}else{var C=B.responseText.replace(/^\s+|\s+$/g,""),A=null;if(C.length>0){A=n2i.fromJSON(B.responseText)}this.fire("objectsLoaded",A)}this.end()},parseXML:function(A){if(A.documentElement.tagName=="items"){this.data=In2iGui.parseItems(A);this.fire("itemsLoaded",this.data)}else{if(A.documentElement.tagName=="list"){this.fire("listLoaded",A)}else{if(A.documentElement.tagName=="articles"){this.fire("articlesLoaded",A)}}}},parseDWR:function(A){this.data=A;this.fire("objectsLoaded",A);this.end()},addParameter:function(A){this.parameters.push(A)},changeParameter:function(B,C){C=this.convertValue(C);for(var A=0;A<this.parameters.length;A++){var D=this.parameters[A];if(D.key==B){D.value=C}}window.clearTimeout(this.paramDelay);this.paramDelay=window.setTimeout(function(){this.refresh()}.bind(this),100)}};In2iGui.getDragProxy=function(){if(!In2iGui.dragProxy){In2iGui.dragProxy=n2i.build("div",{"class":"in2igui_dragproxy",style:"display:none"});document.body.appendChild(In2iGui.dragProxy)}return In2iGui.dragProxy};In2iGui.startDrag=function(E,C,A){E=new n2i.Event(E);var D=C.dragDropInfo;In2iGui.dropTypes=In2iGui.findDropTypes(D);if(!In2iGui.dropTypes){return }var B=In2iGui.getDragProxy();n2i.listen(document.body,"mousemove",In2iGui.dragListener);n2i.listen(document.body,"mouseup",In2iGui.dragEndListener);In2iGui.dragInfo=D;if(D.icon){B.style.backgroundImage="url("+In2iGui.getIconUrl(D.icon,1)+")"}In2iGui.startDragPos={top:E.top(),left:E.left()};B.innerHTML=D.title?"<span>"+n2i.escape(D.title)+"</span>":"###";In2iGui.dragging=true;document.body.onselectstart=function(){return false}};In2iGui.findDropTypes=function(D){var A=In2iGui.get();var F=null;for(var C=0;C<A.delegates.length;C++){if(A.delegates[C].dragDrop){for(var B=0;B<A.delegates[C].dragDrop.length;B++){var E=A.delegates[C].dragDrop[B];if(E.drag==D.kind){if(F==null){F={}}F[E.drop]={}}}}}return F};In2iGui.dragListener=function(B){B=new n2i.Event(B);In2iGui.dragProxy.style.left=(B.left()+10)+"px";In2iGui.dragProxy.style.top=B.top()+"px";In2iGui.dragProxy.style.display="block";var A=In2iGui.findDropTarget(B.getElement());if(A&&In2iGui.dropTypes[A.dragDropInfo["kind"]]){if(In2iGui.latestDropTarget){n2i.removeClass(In2iGui.latestDropTarget,"in2igui_drop")}n2i.addClass(A,"in2igui_drop");In2iGui.latestDropTarget=A}else{if(In2iGui.latestDropTarget){n2i.removeClass(In2iGui.latestDropTarget,"in2igui_drop");In2iGui.latestDropTarget=null}}return false};In2iGui.findDropTarget=function(A){while(A){if(A.dragDropInfo){return A}A=A.parentNode}return null};In2iGui.dragEndListener=function(A){n2i.unListen(document.body,"mousemove",In2iGui.dragListener);n2i.unListen(document.body,"mouseup",In2iGui.dragEndListener);In2iGui.dragging=false;if(In2iGui.latestDropTarget){n2i.removeClass(In2iGui.latestDropTarget,"in2igui_drop");In2iGui.callDelegatesDrop(In2iGui.dragInfo,In2iGui.latestDropTarget.dragDropInfo);In2iGui.dragProxy.style.display="none"}else{n2i.ani(In2iGui.dragProxy,"left",(In2iGui.startDragPos.left+10)+"px",200,{ease:n2i.ease.fastSlow});n2i.ani(In2iGui.dragProxy,"top",(In2iGui.startDragPos.top-5)+"px",200,{ease:n2i.ease.fastSlow,hideOnComplete:true})}In2iGui.latestDropTarget=null;document.body.onselectstart=null};In2iGui.dropOverListener=function(A){if(In2iGui.dragging){}};In2iGui.dropOutListener=function(A){if(In2iGui.dragging){}};In2iGui.Window=function(A){this.element=n2i.get(A.element);this.name=A.name;this.close=n2i.firstByClass(this.element,"in2igui_window_close");this.titlebar=n2i.firstByClass(this.element,"in2igui_window_titlebar");this.title=n2i.firstByClass(this.titlebar,"in2igui_window_title");this.content=n2i.firstByClass(this.element,"in2igui_window_body");this.front=n2i.firstByClass(this.element,"in2igui_window_front");this.back=n2i.firstByClass(this.element,"in2igui_window_back");if(this.back){n2i.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.visible=false;In2iGui.extend(this);this.addBehavior()};In2iGui.Window.create=function(A){A=n2i.override({title:"Window",close:true},A);var B='<div class="in2igui_window_front">'+(A.close?'<div class="in2igui_window_close"></div>':"")+'<div class="in2igui_window_titlebar"><div><div>';if(A.icon){B+='<span class="in2igui_window_icon" style="background-image: url('+In2iGui.getIconUrl(A.icon,1)+')"></span>'}B+='<span class="in2igui_window_title">'+A.title+'</span></div></div></div><div class="in2igui_window_content"><div class="in2igui_window_content"><div class="in2igui_window_body" style="'+(A.width?"width:"+A.width+"px;":"")+(A.padding?"padding:"+A.padding+"px;":"")+'"></div></div></div><div class="in2igui_window_bottom"><div class="in2igui_window_bottom"><div class="in2igui_window_bottom"></div></div></div></div>';A.element=n2i.build("div",{"class":"in2igui_window"+(A.variant?" in2igui_window_"+A.variant:""),html:B,parent:document.body});return new In2iGui.Window(A)};In2iGui.Window.prototype={addBehavior:function(){var A=this;if(this.close){n2i.listen(this.close,"click",function(B){this.hide();this.fire("userClosedWindow")}.bind(this));n2i.listen(this.close,"mousedown",function(B){n2i.stop(B)})}this.titlebar.onmousedown=function(B){A.startDrag(B);return false};n2i.listen(this.element,"mousedown",function(){A.element.style.zIndex=In2iGui.nextPanelIndex()})},setTitle:function(A){n2i.dom.setText(this.title,A)},show:function(A){if(this.visible){return }A=A||{};n2i.setStyle(this.element,{zIndex:In2iGui.nextPanelIndex(),visibility:"hidden",display:"block"});var B=this.element.clientWidth;n2i.setStyle(this.element,{width:B+"px",visibility:"visible"});if(A.avoid){n2i.place({insideViewPort:true,target:{element:A.avoid,vertical:0.5,horizontal:1},source:{element:this.element,vertical:0.5,horizontal:0}})}else{if(!this.element.style.top){this.element.style.top=(n2i.getScrollTop()+40)+"px"}if(!this.element.style.left){this.element.style.left=Math.round((n2i.getViewPortWidth()-B)/2)+"px"}}if(n2i.browser.opacity){n2i.ani(this.element,"opacity",1,0)}this.visible=true;In2iGui.callVisible(this)},toggle:function(){(this.visible?this.hide():this.show())},hide:function(){if(!this.visible){return }if(n2i.browser.opacity){n2i.ani(this.element,"opacity",0,200,{hideOnComplete:true})}else{this.element.style.display="none"}this.visible=false},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},addToBack:function(A){if(!this.back){this.back=n2i.build("div",{className:"in2igui_window_back"});this.element.insertBefore(this.back,this.front);n2i.effect.makeFlippable({container:this.element,front:this.front,back:this.back})}this.back.appendChild(In2iGui.getElement(A))},setVariant:function(A){n2i.removeClass(this.element,"in2igui_window_dark");n2i.removeClass(this.element,"in2igui_window_light");if(A=="dark"||A=="light"){n2i.addClass(this.element,"in2igui_window_"+A)}},flip:function(){if(this.back){this.back.style.minHeight=this.element.clientHeight+"px";n2i.effect.flip({element:this.element})}},startDrag:function(C){var B=new n2i.Event(C);this.element.style.zIndex=In2iGui.nextPanelIndex();var D={top:n2i.getTop(this.element),left:n2i.getLeft(this.element)};this.dragState={left:B.left()-D.left,top:B.top()-D.top};this.latestPosition={left:this.dragState.left,top:this.dragState.top};this.latestTime=new Date().getMilliseconds();var A=this;this.moveListener=function(E){A.drag(E)};this.upListener=function(E){A.endDrag(E)};n2i.listen(document,"mousemove",this.moveListener);n2i.listen(document,"mouseup",this.upListener);n2i.listen(document,"mousedown",this.upListener);B.stop();document.body.onselectstart=function(){return false};return false},calc:function(B,A){this.a=this.latestPosition.left-A;this.b=this.latestPosition.top-B;this.dist=Math.sqrt(Math.pow((this.a),2),Math.pow((this.b),2));this.latestTime=new Date().getMilliseconds();this.latestPosition={"top":B,"left":A}},drag:function(D){var A=new n2i.Event(D);this.element.style.right="auto";var C=(A.top()-this.dragState.top);var B=(A.left()-this.dragState.left);this.element.style.top=Math.max(C,0)+"px";this.element.style.left=Math.max(B,0)+"px";return false},endDrag:function(A){n2i.unListen(document,"mousemove",this.moveListener);n2i.unListen(document,"mouseup",this.upListener);n2i.unListen(document,"mousedown",this.upListener);document.body.onselectstart=null}};In2iGui.Formula=function(A){this.options=A;In2iGui.extend(this,A);this.addBehavior()};In2iGui.Formula.create=function(A){A=A||{};var B={"class":"in2igui_formula"};if(A.action){B.action=A.action}if(A.method){B.method=A.method}A.element=n2i.build("form",B);return new In2iGui.Formula(A)};In2iGui.Formula.prototype={addBehavior:function(){this.element.onsubmit=function(){return false}},submit:function(){this.fire("submit")},getValues:function(){var B={};var C=In2iGui.get().getDescendants(this);for(var A=0;A<C.length;A++){if(C[A].options&&C[A].options.key&&C[A].getValue){B[C[A].options.key]=C[A].getValue()}else{if(C[A].name&&C[A].getValue){B[C[A].name]=C[A].getValue()}}}return B},setValues:function(A){var D=In2iGui.get().getDescendants(this);for(var C=0;C<D.length;C++){if(D[C].options&&D[C].options.key){var B=D[C].options.key;if(B&&A[B]!=undefined){D[C].setValue(A[B])}}}},focus:function(){var B=In2iGui.get().getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].focus){B[A].focus();return }}},reset:function(){var B=In2iGui.get().getDescendants(this);for(var A=0;A<B.length;A++){if(B[A].reset){B[A].reset()}}},add:function(A){this.element.appendChild(A.getElement())},createGroup:function(A){var B=In2iGui.Formula.Group.create(A);this.add(B);return B},buildGroup:function(A,C){var B=this.createGroup(A);n2i.each(C,function(E){if(In2iGui.Formula[E.type]){var D=In2iGui.Formula[E.type].create(E.options);B.add(D)}});return B},childValueChanged:function(A){this.fire("valuesChanged",this.getValues())},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};In2iGui.Formula.Group=function(A){this.name=A.name;this.element=n2i.get(A.element);this.body=n2i.firstByTag(this.element,"tbody");this.options=n2i.override({above:true},A);In2iGui.extend(this)};In2iGui.Formula.Group.create=function(A){A=n2i.override({above:true},A);var B=A.element=n2i.build("table",{"class":"in2igui_formula_group"});if(A.above){n2i.addClass(B,"in2igui_formula_group_above")}B.appendChild(n2i.build("tbody"));return new In2iGui.Formula.Group(A)};In2iGui.Formula.Group.prototype={add:function(E){var D=n2i.build("tr");this.body.appendChild(D);var F=n2i.build("td",{"class":"in2igui_formula_group"});if(E.getLabel){var A=E.getLabel();if(A){if(this.options.above){n2i.build("label",{text:A,parent:F})}else{var C=n2i.build("th",{parent:D});n2i.build("label",{text:A,parent:C})}}}var B=n2i.build("div",{"class":"in2igui_formula_item"});B.appendChild(E.getElement());F.appendChild(B);D.appendChild(F)},createButtons:function(B){var C=n2i.build("tr",{parent:this.body});var D=n2i.build("td",{colspan:this.options.above?1:2,parent:C});var A=In2iGui.Buttons.create(B);D.appendChild(A.getElement());return A}};In2iGui.Formula.Text=function(B){this.options=n2i.override({label:null,key:null,lines:1,live:false,maxHeight:100},B);this.element=n2i.get(B.element);this.name=B.name;In2iGui.extend(this);this.input=n2i.firstByClass(this.element,"in2igui_formula_text");this.multiline=this.input.tagName.toLowerCase()=="textarea";this.placeholder=n2i.firstByClass(this.element,"in2igui_field_placeholder");this.value=this.input.value;if(this.placeholder){var A=this;In2iGui.onDomReady(function(){window.setTimeout(function(){A.value=A.input.value;A.updateClass()},500)})}this.addBehavior()};In2iGui.Formula.Text.create=function(B){B=n2i.override({lines:1},B);var C,A;if(B.lines>1||B.multiline){A=n2i.build("textarea",{"class":"in2igui_formula_text","rows":B.lines,style:"height: 32px;"});C=n2i.build("span",{"class":"in2igui_formula_text_multiline"});C.appendChild(A)}else{A=n2i.build("input",{"class":"in2igui_formula_text"});C=n2i.build("span",{"class":"in2igui_field_singleline"});C.appendChild(A)}if(B.value!==undefined){A.value=B.value}B.element=In2iGui.wrapInField(C);return new In2iGui.Formula.Text(B)};In2iGui.Formula.Text.prototype={addBehavior:function(){In2iGui.addFocusClass({element:this.input,classElement:this.element,"class":"in2igui_field_focused"});n2i.listen(this.input,"keyup",this.onKeyUp.bind(this));var A=this.element.getElementsByTagName("em")[0];if(A){this.updateClass();n2i.listen(A,"mousedown",function(){window.setTimeout(function(){this.input.focus();this.input.select()}.bind(this))}.bind(this));n2i.listen(A,"mouseup",function(){this.input.focus();this.input.select()}.bind(this))}},updateClass:function(){n2i.setClass(this.element,"in2igui_field_dirty",this.value.length>0)},onKeyUp:function(B){if(!this.multiline&&B.keyCode===n2i.KEY_RETURN){this.fire("submit");var A=In2iGui.get().getAncestor(this,"in2igui_formula");if(A){A.submit()}return }if(this.input.value==this.value){return }this.value=this.input.value;this.updateClass();this.expand(true);In2iGui.callAncestors(this,"childValueChanged",this.input.value);this.fire("valueChanged",this.input.value)},updateFromNode:function(A){if(A.firstChild){this.setValue(A.firstChild.nodeValue)}else{this.setValue(null)}},updateFromObject:function(A){this.setValue(A.value)},focus:function(){try{this.input.focus()}catch(A){}},select:function(){try{this.input.focus();this.input.select()}catch(A){}},reset:function(){this.setValue("")},setValue:function(A){if(A===undefined||A===null){A=""}this.value=A;this.input.value=A;this.expand(true)},getValue:function(){return this.input.value},getLabel:function(){return this.options.label},isEmpty:function(){return this.input.value==""},isBlank:function(){return n2i.isBlank(this.input.value)},setError:function(A){var B=A?true:false;n2i.setClass(this.element,"in2igui_field_error",B);if(typeof (A)=="string"){In2iGui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){In2iGui.hideToolTip({key:this.name})}},$visibilityChanged:function(){window.setTimeout(this.expand.bind(this))},expand:function(A){if(!this.multiline){return }if(!n2i.dom.isVisible(this.element)){return }var B=In2iGui.getTextAreaHeight(this.input);B=Math.max(32,B);B=Math.min(B,this.options.maxHeight);if(A){this.updateOverflow();n2i.animate(this.input,"height",B+"px",300,{ease:n2i.ease.slowFastSlow,onComplete:function(){this.updateOverflow()}.bind(this)})}else{this.input.style.height=B+"px";this.updateOverflow()}},updateOverflow:function(){if(!this.multiline){return }this.input.style.overflowY=this.input.clientHeight>=this.options.maxHeight?"auto":"hidden"}};In2iGui.Formula.DateTime=function(A){this.inputFormats=["d-m-Y","d/m-Y","d/m/Y","d-m-Y H:i:s","d/m-Y H:i:s","d/m/Y H:i:s","d-m-Y H:i","d/m-Y H:i","d/m/Y H:i","d-m-Y H","d/m-Y H","d/m/Y H","d-m","d/m","d","Y","m-d-Y","m-d","m/d"];this.outputFormat="d-m-Y H:i:s";this.name=A.name;this.element=n2i.get(A.element);this.input=n2i.firstByTag(this.element,"input");this.options=n2i.override({returnType:null,label:null,allowNull:true,value:null},A);this.value=this.options.value;In2iGui.extend(this);this.addBehavior();this.updateUI()};In2iGui.Formula.DateTime.create=function(A){var B=n2i.build("span",{"class":"in2igui_formula_text_singleline"});n2i.build("input",{"class":"in2igui_formula_text",parent:B});A.element=In2iGui.wrapInField(B);return new In2iGui.Formula.DateTime(A)};In2iGui.Formula.DateTime.prototype={addBehavior:function(){In2iGui.addFocusClass({element:this.input,classElement:this.element,"class":"in2igui_field_focused"});n2i.listen(this.input,"blur",this.check.bind(this))},updateFromNode:function(A){if(A.firstChild){this.setValue(A.firstChild.nodeValue)}else{this.setValue(null)}},updateFromObject:function(A){this.setValue(A.value)},focus:function(){try{this.input.focus()}catch(A){}},reset:function(){this.setValue("")},setValue:function(A){if(!A){this.value=null}else{if(A.constructor==Date){this.value=A}else{this.value=new Date();this.value.setTime(parseInt(A)*1000)}}this.updateUI()},check:function(){var C=this.input.value;var A=null;for(var B=0;B<this.inputFormats.length&&A==null;B++){A=Date.parseDate(C,this.inputFormats[B])}if(this.options.allowNull||A!=null){this.value=A}this.updateUI()},getValue:function(){if(this.value!=null&&this.options.returnType=="seconds"){return Math.round(this.value.getTime()/1000)}return this.value},getElement:function(){return this.element},getLabel:function(){return this.options.label},updateUI:function(){if(this.value){this.input.value=this.value.dateFormat(this.outputFormat)}else{this.input.value=""}}};In2iGui.Formula.Number=function(B){this.options=n2i.override({min:0,max:10000,value:null,decimals:0,allowNull:false},B);this.name=B.name;var A=this.element=n2i.get(B.element);this.input=n2i.firstByTag(A,"input");this.up=n2i.firstByClass(A,"in2igui_number_up");this.down=n2i.firstByClass(A,"in2igui_number_down");this.value=this.options.value;In2iGui.extend(this);this.addBehavior()};In2iGui.Formula.Number.create=function(A){A.element=n2i.build("span",{"class":"in2igui_number",html:'<span><span><input type="text" value="'+(A.value!==undefined?A.value:"0")+'"/><a class="in2igui_number_up"></a><a class="in2igui_number_down"></a></span></span>'});return new In2iGui.Formula.Number(A)};In2iGui.Formula.Number.prototype={addBehavior:function(){var A=this.element;n2i.listen(this.input,"focus",function(){n2i.addClass(A,"in2igui_number_focused")});n2i.listen(this.input,"blur",this.blurEvent.bind(this));n2i.listen(this.input,"keyup",this.keyEvent.bind(this));n2i.listen(this.up,"mousedown",this.upEvent.bind(this));n2i.listen(this.down,"mousedown",this.downEvent.bind(this))},blurEvent:function(){n2i.removeClass(this.element,"in2igui_number_focused");this.updateField()},keyEvent:function(B){B=B||window.event;if(B.keyCode==n2i.KEY_UP){n2i.stop(B);this.upEvent()}else{if(B.keyCode==n2i.KEY_DOWN){this.downEvent()}else{var A=parseInt(this.input.value,10);if(!isNaN(A)){this.setLocalValue(A,true)}else{this.setLocalValue(null,true)}}}},downEvent:function(){if(this.value===null){this.setLocalValue(this.options.min,true)}else{this.setLocalValue(this.value-1,true)}this.updateField()},upEvent:function(){this.setLocalValue(this.value+1,true);this.updateField()},focus:function(){try{this.input.focus()}catch(A){}},getValue:function(){return this.value},getLabel:function(){return this.options.label},setValue:function(A){A=parseInt(A,10);if(!isNaN(A)){this.setLocalValue(A,false)}this.updateField()},updateField:function(){this.input.value=this.value===null||this.value===undefined?"":this.value},setLocalValue:function(B,A){var C=this.value;if(B===null||B===undefined&&this.options.allowNull){this.value=null}else{this.value=Math.min(Math.max(B,this.options.min),this.options.max)}if(A&&C!==this.value){In2iGui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)}},reset:function(){if(this.options.allowNull){this.value=null}else{this.value=Math.min(Math.max(0,this.options.min),this.options.max)}this.updateField()}};In2iGui.Formula.DropDown=function(B){this.options=n2i.override({label:null,placeholder:null,url:null,source:null},B);this.name=B.name;var A=this.element=n2i.get(B.element);this.inner=A.getElementsByTagName("strong")[0];this.items=B.items||[];this.index=-1;this.value=this.options.value||null;this.dirty=true;In2iGui.extend(this);this._addBehavior();this._updateIndex();this._updateUI();if(this.options.url){this.options.source=new In2iGui.Source({url:this.options.url,delegate:this})}else{if(this.options.source){this.options.source.listen(this)}}};In2iGui.Formula.DropDown.create=function(A){A=A||{};A.element=n2i.build("a",{"class":"in2igui_dropdown",href:"#",html:"<span><span><strong></strong></span></span>"});return new In2iGui.Formula.DropDown(A)};In2iGui.Formula.DropDown.prototype={_addBehavior:function(){In2iGui.addFocusClass({element:this.element,"class":"in2igui_dropdown_focused"});n2i.listen(this.element,"click",this._click.bind(this));n2i.listen(this.element,"blur",this._hideSelector.bind(this));n2i.listen(this.element,"keydown",this._keyDown.bind(this))},_updateIndex:function(){this.index=-1;for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.value){this.index=A}}},_updateUI:function(){var C=this.items[this.index];if(C){var D=C.label||C.title||"";this.inner.innerHTML="";n2i.dom.addText(this.inner,n2i.wrap(D))}else{if(this.options.placeholder){this.inner.innerHTML="";this.inner.appendChild(n2i.build("em",{text:n2i.escape(this.options.placeholder)}))}else{this.inner.innerHTML=""}}if(!this.selector){return }var A=this.selector.getElementsByTagName("a");for(var B=0;B<A.length;B++){if(this.index==B){n2i.addClass(A[B],"in2igui_selected")}else{A[B].className=""}}},_click:function(H){n2i.stop(H);this._buildSelector();var E=this.element,D=this.selector;E.focus();if(!this.items){return }var B=n2i.getDocumentHeight();if(B<200){var G=n2i.getLeft(this.element);n2i.setStyle(this.selector,{"left":G+"px",top:"5px"})}else{n2i.place({target:{element:this.element,vertical:1,horizontal:0},source:{element:this.selector,vertical:0,horizontal:0}})}n2i.setStyle(D,{visibility:"hidden",display:"block",width:""});var A=Math.min(B-n2i.getTop(D)-5,200);var C=Math.max(E.clientWidth-5,100,D.clientWidth+20);var F=n2i.getViewPortWidth()-n2i.getLeft(E)-20;C=Math.min(C,F);n2i.setStyle(D,{visibility:"visible",width:C+"px",zIndex:In2iGui.nextTopIndex(),maxHeight:A+"px"})},_keyDown:function(A){if(this.items.length==0){return }if(A.keyCode==40){n2i.stop(A);if(this.index>=this.items.length-1){this.value=this.items[0].value}else{this.value=this.items[this.index+1].value}this._updateIndex();this._updateUI();this._fireChange()}else{if(A.keyCode==38){n2i.stop(A);if(this.index>0){this.index--}else{this.index=this.items.length-1}this.value=this.items[this.index].value;this._updateUI();this._fireChange()}}},selectFirst:function(){if(this.items.length>0){this.setValue(this.items[0].value)}},getValue:function(){return this.value},setValue:function(A){this.value=A;this._updateIndex();this._updateUI()},reset:function(){this.setValue(null)},getLabel:function(){return this.options.label},refresh:function(){if(this.options.source){this.options.source.refresh()}},getItem:function(){if(this.index>=0){return this.items[this.index]}return 0},addItem:function(A){this.items.push(A);this.dirty=true;this._updateIndex();this._updateUI()},setItems:function(A){this.items=A;this.dirty=true;this.index=-1;this._updateIndex();this._updateUI()},$itemsLoaded:function(A){this.setItems(A)},_hideSelector:function(){if(!this.selector){return }this.selector.style.display="none"},_buildSelector:function(){if(!this.dirty||!this.items){return }if(!this.selector){this.selector=n2i.build("div",{"class":"in2igui_dropdown_selector"});document.body.appendChild(this.selector);n2i.listen(this.selector,"mousedown",function(B){n2i.stop(B)})}else{this.selector.innerHTML=""}var A=this;n2i.each(this.items,function(C,B){var D=n2i.build("a",{href:"#",text:C.label||C.title});n2i.listen(D,"mousedown",function(E){n2i.stop(E);A._itemClicked(C,B)});if(B==A.index){n2i.addClass(D,"in2igui_selected")}A.selector.appendChild(D)});this.dirty=false},_itemClicked:function(B,A){this.index=A;var C=this.value!=this.items[A].value;this.value=this.items[A].value;this._updateUI();this._hideSelector();if(C){this._fireChange()}},_fireChange:function(){In2iGui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)}};In2iGui.Formula.Radiobuttons=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;this.radios=[];this.value=A.value;this.defaultValue=this.value;In2iGui.extend(this)};In2iGui.Formula.Radiobuttons.prototype={click:function(){this.value=!this.value;this.updateUI()},updateUI:function(){for(var B=0;B<this.radios.length;B++){var A=this.radios[B];n2i.setClass(n2i.get(A.id),"in2igui_selected",A.value==this.value)}},setValue:function(A){this.value=A;this.updateUI()},getValue:function(){return this.value},reset:function(){this.setValue(this.defaultValue)},registerRadiobutton:function(B){this.radios.push(B);var C=n2i.get(B.id);var A=this;C.onclick=function(){A.setValue(B.value);A.fire("valueChanged",B.value)}}};In2iGui.Formula.Checkbox=function(A){this.element=n2i.get(A.element);this.control=n2i.firstByTag(this.element,"span");this.options=A;this.name=A.name;this.value=A.value==="true"||A.value===true;In2iGui.extend(this);this.addBehavior()};In2iGui.Formula.Checkbox.create=function(B){var A=B.element=n2i.build("a",{"class":"in2igui_checkbox",href:"#",html:"<span><span></span></span>"});if(B.value){n2i.addClass(A,"in2igui_checkbox_selected")}return new In2iGui.Formula.Checkbox(B)};In2iGui.Formula.Checkbox.prototype={addBehavior:function(){In2iGui.addFocusClass({element:this.element,"class":"in2igui_checkbox_focused"});n2i.listen(this.element,"click",this.click.bind(this))},click:function(A){n2i.stop(A);this.element.focus();this.value=!this.value;this.updateUI();In2iGui.callAncestors(this,"childValueChanged",this.value);this.fire("valueChanged",this.value)},updateUI:function(){n2i.setClass(this.element,"in2igui_checkbox_selected",this.value)},setValue:function(A){this.value=A===true||A==="true";this.updateUI()},getValue:function(){return this.value},reset:function(){this.setValue(false)},getLabel:function(){return this.options.label}};In2iGui.Formula.Checkboxes=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;this.items=A.items||[];this.sources=[];this.subItems=[];this.values=A.values||A.value||[];In2iGui.extend(this);this.addBehavior();this.updateUI();if(A.url){new In2iGui.Source({url:A.url,delegate:this})}};In2iGui.Formula.Checkboxes.create=function(A){A.element=n2i.build("div",{"class":A.vertical?"in2igui_checkboxes in2igui_checkboxes_vertical":"in2igui_checkboxes"});if(A.items){n2i.each(A.items,function(C){var B=n2i.build("a",{"class":"in2igui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+C.title});In2iGui.addFocusClass({element:B,"class":"in2igui_checkbox_focused"});A.element.appendChild(B)})}return new In2iGui.Formula.Checkboxes(A)};In2iGui.Formula.Checkboxes.prototype={addBehavior:function(){var A=n2i.byClass(this.element,"in2igui_checkbox");n2i.each(A,function(B,C){n2i.listen(B,"click",function(D){n2i.stop(D);this.flipValue(this.items[C].value)}.bind(this))}.bind(this))},getValue:function(){return this.values},getValues:function(){return this.values},checkValues:function(){var B=[];for(var C=0;C<this.values.length;C++){var E=this.values[C],D=false,A;for(A=0;A<this.items.length;A++){D=D||this.items[A].value===E}for(A=0;A<this.subItems.length;A++){D=D||this.subItems[A].hasValue(E)}if(D){B.push(E)}}this.values=B},setValue:function(A){this.values=A;this.checkValues();this.updateUI()},setValues:function(A){this.setValue(A)},flipValue:function(A){n2i.flipInArray(this.values,A);this.checkValues();this.updateUI();this.fire("valueChanged",this.values);In2iGui.callAncestors(this,"childValueChanged",this.values)},updateUI:function(){var B,C,D;for(B=0;B<this.subItems.length;B++){this.subItems[B].updateUI()}var A=n2i.byClass(this.element,"in2igui_checkbox");for(B=0;B<this.items.length;B++){C=this.items[B];D=n2i.inArray(this.values,C.value);n2i.setClass(A[B],"in2igui_checkbox_selected",D)}},refresh:function(){for(var A=0;A<this.subItems.length;A++){this.subItems[A].refresh()}},reset:function(){this.setValues([])},registerSource:function(A){A.parent=this;this.sources.push(A)},registerItem:function(A){if(parseInt(A.value)==A.value){A.value=parseInt(A.value)}this.items.push(A)},registerItems:function(A){A.parent=this;this.subItems.push(A)},getLabel:function(){return this.options.label},$itemsLoaded:function(A){n2i.each(A,function(C){var B=n2i.build("a",{"class":"in2igui_checkbox",href:"javascript:void(0);",html:"<span><span></span></span>"+n2i.escape(C.title)});n2i.listen(B,"click",function(D){n2i.stop(D);this.flipValue(C.value)}.bind(this));In2iGui.addFocusClass({element:B,"class":"in2igui_checkbox_focused"});this.element.appendChild(B);this.items.push(C)}.bind(this));this.checkValues();this.updateUI()}};In2iGui.Formula.Checkboxes.Items=function(A){this.element=n2i.get(A.element);this.name=A.name;this.parent=null;this.options=A;this.checkboxes=[];In2iGui.extend(this);if(this.options.source){this.options.source.listen(this)}};In2iGui.Formula.Checkboxes.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$itemsLoaded:function(B){this.checkboxes=[];this.element.innerHTML="";var A=this;n2i.each(B,function(D){var C=n2i.build("a",{"class":"in2igui_checkbox",href:"#",html:"<span><span></span></span>"+D.title});n2i.listen(C,"click",function(E){n2i.stop(E);C.focus();A.itemWasClicked(D)});In2iGui.addFocusClass({element:C,"class":"in2igui_checkbox_focused"});A.element.appendChild(C);A.checkboxes.push({title:D.title,element:C,value:D.value})});this.parent.checkValues();this.updateUI()},itemWasClicked:function(A){this.parent.flipValue(A.value)},updateUI:function(){try{for(var B=0;B<this.checkboxes.length;B++){var C=this.checkboxes[B];var A=n2i.indexInArray(this.parent.values,C.value);n2i.setClass(C.element,"in2igui_checkbox_selected",A!=-1)}}catch(D){alert(typeof (this.parent.values));alert(D)}},hasValue:function(B){for(var A=0;A<this.checkboxes.length;A++){if(this.checkboxes[A].value==B){return true}}return false}};In2iGui.Formula.Tokens=function(A){this.options=n2i.override({label:null,key:null},A);this.element=n2i.get(A.element);this.name=A.name;this.value=[""];In2iGui.extend(this);this.updateUI()};In2iGui.Formula.Tokens.create=function(A){A=A||{};A.element=n2i.build("div",{"class":"in2igui_tokens"});return new In2iGui.Formula.Tokens(A)};In2iGui.Formula.Tokens.prototype={setValue:function(A){this.value=A;this.value.push("");this.updateUI()},reset:function(){this.value=[""];this.updateUI()},getValue:function(){var A=[];n2i.each(this.value,function(B){B=n2i.trim(B);if(B.length>0){A.push(B)}});return A},getLabel:function(){return this.options.label},updateUI:function(){this.element.innerHTML="";n2i.each(this.value,function(C,B){var A=n2i.build("input",{"class":"in2igui_tokens_token",parent:this.element});if(this.options.width){A.style.width=this.options.width+"px"}A.value=C;A.in2iguiIndex=B;n2i.listen(A,"keyup",function(){this.inputChanged(A,B)}.bind(this))}.bind(this))},inputChanged:function(A,B){if(B==this.value.length-1&&A.value!=this.value[B]){this.addField()}this.value[B]=A.value},addField:function(){var B=n2i.build("input",{"class":"in2igui_tokens_token"});if(this.options.width){B.style.width=this.options.width+"px"}var C=this.value.length;this.value.push("");this.element.appendChild(B);var A=this;n2i.listen(B,"keyup",function(){A.inputChanged(B,C)})}};In2iGui.Formula.StyleLength=function(C){this.options=n2i.override({value:null,min:0,max:1000,units:["px","pt","em","%"],defaultUnit:"px",allowNull:false},C);this.name=C.name;var B=this.element=n2i.get(C.element);this.input=n2i.firstByTag(B,"input");var A=B.getElementsByTagName("a");this.up=A[0];this.down=A[1];this.value=this.parseValue(this.options.value);In2iGui.extend(this);this.addBehavior()};In2iGui.Formula.StyleLength.prototype={addBehavior:function(){var A=this.element;n2i.listen(this.input,"focus",function(){n2i.addClass(A,"in2igui_number_focused")});n2i.listen(this.input,"blur",this.blurEvent.bind(this));n2i.listen(this.input,"keyup",this.keyEvent.bind(this));n2i.listen(this.up,"mousedown",this.upEvent.bind(this));n2i.listen(this.down,"mousedown",this.downEvent.bind(this))},parseValue:function(E){var B=parseFloat(E,10);if(isNaN(B)){return null}var A={number:B,unit:this.options.defaultUnit};for(var C=0;C<this.options.units.length;C++){var D=this.options.units[C];if(E.indexOf(D)!=-1){A.unit=D;break}}A.number=Math.max(this.options.min,Math.min(this.options.max,A.number));return A},blurEvent:function(){n2i.removeClass(this.element,"in2igui_number_focused");this.updateInput()},keyEvent:function(A){A=A||window.event;if(A.keyCode==n2i.KEY_UP){n2i.stop(A);this.upEvent()}else{if(A.keyCode==n2i.KEY_DOWN){this.downEvent()}else{this.checkAndSetValue(this.parseValue(this.input.value))}}},updateInput:function(){this.input.value=this.getValue()},checkAndSetValue:function(B){var A=this.value;var C=false;if(A===null&&B===null){}else{if(A!=null&&B!=null&&A.number===B.number&&A.unit===B.unit){}else{C=true}}this.value=B;if(C){this.fire("valueChanged",this.getValue())}},downEvent:function(){if(this.value){this.checkAndSetValue({number:Math.max(this.options.min,this.value.number-1),unit:this.value.unit})}else{this.checkAndSetValue({number:this.options.min,unit:this.options.defaultUnit})}this.updateInput()},upEvent:function(){if(this.value){this.checkAndSetValue({number:Math.min(this.options.max,this.value.number+1),unit:this.value.unit})}else{this.checkAndSetValue({number:this.options.min+1,unit:this.options.defaultUnit})}this.updateInput()},getValue:function(){return this.value?this.value.number+this.value.unit:""},setValue:function(A){this.value=this.parseValue(A);this.updateInput()}};In2iGui.Formula.Location=function(A){this.options=n2i.override({value:null},A);this.name=A.name;this.element=n2i.get(A.element);this.chooser=n2i.firstByTag(this.element,"a");this.latField=new In2iGui.TextField({element:n2i.firstByTag(this.element,"input"),validator:new In2iGui.NumberValidator({min:-90,max:90,allowNull:true})});this.latField.listen(this);this.lngField=new In2iGui.TextField({element:this.element.getElementsByTagName("input")[1],validator:new In2iGui.NumberValidator({min:-180,max:180,allowNull:true})});this.lngField.listen(this);this.value=this.options.value;In2iGui.extend(this);this.setValue(this.value);this.addBehavior()};In2iGui.Formula.Location.create=function(B){B=B||{};var C=B.element=n2i.build("div",{"class":"in2igui_location"});var A=n2i.build("span",{html:'<span class="in2igui_location_latitude"><span><input/></span></span><span class="in2igui_location_longitude"><span><input/></span></span>'});C.appendChild(In2iGui.wrapInField(A));C.appendChild(n2i.build("a",{"class":"in2igui_location_picker",href:"javascript:void(0);"}));return new In2iGui.Formula.Location(B)};In2iGui.Formula.Location.prototype={addBehavior:function(){n2i.listen(this.chooser,"click",this.showPicker.bind(this));In2iGui.addFocusClass({element:this.latField.element,classElement:this.element,"class":"in2igui_field_focused"});In2iGui.addFocusClass({element:this.lngField.element,classElement:this.element,"class":"in2igui_field_focused"})},getLabel:function(){return this.options.label},reset:function(){this.setValue()},getValue:function(){return this.value},setValue:function(A){if(A){this.latField.setValue(A.latitude);this.lngField.setValue(A.longitude);this.value=A}else{this.latField.setValue();this.lngField.setValue();this.value=null}this.updatePicker()},updatePicker:function(){if(this.picker){this.picker.setLocation(this.value)}},showPicker:function(){if(!this.picker){this.picker=new In2iGui.LocationPicker();this.picker.listen(this)}this.picker.show({node:this.chooser,location:this.value})},$locationChanged:function(A){this.setValue(A)},$valueChanged:function(){var B=this.latField.getValue();var A=this.lngField.getValue();if(B===null||A===null){this.value=null}else{this.value={latitude:B,longitude:A}}this.updatePicker()}};In2iGui.List=function(A){this.options=n2i.override({url:null,source:null},A);this.element=n2i.get(A.element);this.name=A.name;if(this.options.source){this.options.source.listen(this)}this.url=A.url;this.table=n2i.firstByTag(this.element,"table");this.head=n2i.firstByTag(this.element,"thead");this.body=n2i.firstByTag(this.element,"tbody");this.columns=[];this.rows=[];this.selected=[];this.navigation=n2i.firstByClass(this.element,"in2igui_list_navigation");this.count=n2i.firstByClass(this.navigation,"in2igui_list_count");this.windowPage=n2i.firstByClass(this.navigation,"window_page");this.windowPageBody=n2i.firstByClass(this.navigation,"window_page_body");this.parameters={};this.sortKey=null;this.sortDirection=null;this.window={size:null,page:0,total:0};if(A.windowSize!=""){this.window.size=parseInt(A.windowSize)}In2iGui.extend(this);if(this.url){this.refresh()}};In2iGui.List.create=function(A){A=n2i.override({},A);A.element=n2i.build("div",{"class":"in2igui_list",html:'<div class="in2igui_list_progress"></div><div class="in2igui_list_navigation"><div class="in2igui_list_selection window_page"><div><div class="window_page_body"></div></div></div><span class="in2igui_list_count"></span></div><div class="in2igui_list_body"'+(A.maxHeight>0?' style="max-height: '+A.maxHeight+'px; overflow: auto;"':"")+'><table cellspacing="0" cellpadding="0"><thead><tr></tr></thead><tbody></tbody></table></div>'});return new In2iGui.List(A)};In2iGui.List.prototype={hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block";this.refresh()},registerColumn:function(A){this.columns.push(A)},getSelection:function(){var A=[];for(var B=0;B<this.selected.length;B++){A.push(this.rows[this.selected[B]])}return A},getFirstSelection:function(){var A=this.getSelection();if(A.length>0){return A[0]}else{return null}},setParameter:function(A,B){this.parameters[A]=B},loadData:function(A){this.setUrl(A)},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.removeDelegate(this)}A.listen(this);this.options.source=A;A.refresh()}},setUrl:function(A){if(this.options.source){this.options.source.removeDelegate(this);this.options.source=null}this.url=A;this.selected=[];this.sortKey=null;this.sortDirection=null;this.resetState();this.refresh()},clear:function(){this.selected=[];this.columns=[];this.rows=[];this.navigation.style.display="none";n2i.dom.clear(this.body);n2i.dom.clear(this.head);if(this.options.source){this.options.source.removeDelegate(this)}this.options.source=null;this.url=null},resetState:function(){this.window={size:null,page:0,total:0};In2iGui.firePropertyChange(this,"window",this.window);In2iGui.firePropertyChange(this,"window.page",this.window.page)},valueForProperty:function(A){if(A=="window.page"){return this.window.page}if(A=="window.page"){return this.window.page}else{if(A=="sort.key"){return this.sortKey}else{if(A=="sort.direction"){return(this.sortDirection||"ascending")}else{return this[A]}}}},$sourceShouldRefresh:function(){return this.element.style.display!="none"},refresh:function(){if(this.options.source){this.options.source.refresh();return }if(!this.url){return }var A=this.url;if(typeof (this.window.page)=="number"){A+=A.indexOf("?")==-1?"?":"&";A+="windowPage="+this.window.page}if(this.window.size){A+=A.indexOf("?")==-1?"?":"&";A+="windowSize="+this.window.size}if(this.sortKey){A+=A.indexOf("?")==-1?"?":"&";A+="sort="+this.sortKey}if(this.sortDirection){A+=A.indexOf("?")==-1?"?":"&";A+="direction="+this.sortDirection}for(var B in this.parameters){A+=A.indexOf("?")==-1?"?":"&";A+=B+"="+this.parameters[B]}this._setBusy(true);In2iGui.request({url:A,onJSON:function(C){this._setBusy(false);this.$objectsLoaded(C)}.bind(this),onXML:function(C){this._setBusy(false);this.$listLoaded(C)}.bind(this)})},sort:function(A){var B=this.columns[A].key;if(B==this.sortKey){this.sortDirection=this.sortDirection=="ascending"?"descending":"ascending";In2iGui.firePropertyChange(this,"sort.direction",this.sortDirection)}else{In2iGui.firePropertyChange(this,"sort.key",B)}this.sortKey=B},$listLoaded:function(U){this.selected=[];this.parseWindow(U);this.buildNavigation();n2i.dom.clear(this.head);n2i.dom.clear(this.body);this.rows=[];this.columns=[];var R=document.createElement("tr");var Q=U.getElementsByTagName("sort");this.sortKey=null;this.sortDirection=null;if(Q.length>0){this.sortKey=Q[0].getAttribute("key");this.sortDirection=Q[0].getAttribute("direction")}var B=U.getElementsByTagName("header");var N;for(N=0;N<B.length;N++){var C="";var F=document.createElement("th");var K=B[N].getAttribute("width");var T=B[N].getAttribute("key");var D=B[N].getAttribute("sortable")=="true";if(K&&K!=""){F.style.width=K+"%"}if(D){var J=this;F.in2iguiIndex=N;F.onclick=function(){J.sort(this.in2iguiIndex)};C+="sortable"}if(this.sortKey&&T==this.sortKey){C+=" sort_"+this.sortDirection}F.className=C;var M=document.createElement("span");F.appendChild(M);M.appendChild(document.createTextNode(B[N].getAttribute("title")||""));R.appendChild(F);this.columns.push({"key":T,"sortable":D,"width":K})}this.head.appendChild(R);var A=document.createDocumentFragment();var I=U.getElementsByTagName("row");for(N=0;N<I.length;N++){var E=I[N].getElementsByTagName("cell");var G=document.createElement("tr");G.setAttribute("data-index",N);var P=I[N].getAttribute("icon");var S=I[N].getAttribute("title");for(var L=0;L<E.length;L++){var H=document.createElement("td");if(E[L].getAttribute("wrap")=="false"){H.style.whiteSpace="nowrap"}this.parseCell(E[L],H);G.appendChild(H);if(!S){S=n2i.dom.getText(E[L])}if(!P){P=E[L].getAttribute("icon")}}var O={id:I[N].getAttribute("id"),kind:I[N].getAttribute("kind"),icon:P,title:S,index:N};G.dragDropInfo=O;this.addRowBehavior(G,N);A.appendChild(G);this.rows.push(O)}this.body.appendChild(A);this.fire("selectionReset")},$objectsLoaded:function(A){if(A==null){}else{if(A.constructor==Array){this.setObjects(A)}else{this.setData(A)}}this.fire("selectionReset")},$sourceIsBusy:function(){this._setBusy(true)},$sourceIsNotBusy:function(){this._setBusy(false)},_setBusy:function(A){this.busy=A;window.clearTimeout(this.busytimer);if(A){var B=this.element;this.busytimer=window.setTimeout(function(){n2i.addClass(B,"in2igui_list_busy")},300)}else{n2i.removeClass(this.element,"in2igui_list_busy")}},parseCell:function(B,G){var F=B.getAttribute("icon");if(F!=null&&F!=""){G.appendChild(In2iGui.createIcon(F,1))}for(var D=0;D<B.childNodes.length;D++){var A=B.childNodes[D];if(n2i.dom.isDefinedText(A)){n2i.dom.addText(G,A.nodeValue)}else{if(n2i.dom.isElement(A,"break")){G.appendChild(document.createElement("br"))}else{if(n2i.dom.isElement(A,"icon")){G.appendChild(In2iGui.createIcon(A.getAttribute("icon"),1))}else{if(n2i.dom.isElement(A,"line")){var I=n2i.build("p",{"class":"in2igui_list_line"});if(A.getAttribute("dimmed")=="true"){n2i.addClass(I,"in2igui_list_dimmed")}G.appendChild(I);this.parseCell(A,I)}else{if(n2i.dom.isElement(A,"object")){var C=n2i.build("div",{"class":"object"});if(A.getAttribute("icon")){C.appendChild(In2iGui.createIcon(A.getAttribute("icon"),1))}if(A.firstChild&&A.firstChild.nodeType==n2i.TEXT_NODE&&A.firstChild.nodeValue.length>0){n2i.dom.addText(C,A.firstChild.nodeValue)}G.appendChild(C)}else{if(n2i.dom.isElement(A,"icons")){var H=n2i.build("span",{"class":"in2igui_list_icons"});this.parseCell(A,H);G.appendChild(H)}else{if(n2i.dom.isElement(A,"button")){var E=In2iGui.Button.create({text:A.getAttribute("text"),small:true,rounded:true});E.click(function(){this._buttonClick(E)}.bind(this));G.appendChild(E.getElement())}}}}}}}}},_buttonClick:function(A){var C=n2i.firstParentByTag(A.getElement(),"tr");var B=this.rows[parseInt(C.getAttribute("data-index"),10)];this.fire("buttonClick",B,A)},parseWindow:function(B){var C=B.getElementsByTagName("window");if(C.length>0){var A=C[0];this.window.total=parseInt(A.getAttribute("total"));this.window.size=parseInt(A.getAttribute("size"));this.window.page=parseInt(A.getAttribute("page"))}else{this.window.total=0;this.window.size=0;this.window.page=0}},buildNavigation:function(){var C=this;var A=this.window.size>0?Math.ceil(this.window.total/this.window.size):0;if(A<2){this.navigation.style.display="none";return }this.navigation.style.display="block";var H=((this.window.page)*this.window.size+1);n2i.dom.setText(this.count,(H+"-"+Math.min((this.window.page+1)*this.window.size,this.window.total)+" / "+this.window.total));var F=this.windowPageBody;F.innerHTML="";if(A<2){this.windowPage.style.display="none"}else{var G=this.buildPages(A,this.window.page);for(var E=0;E<G.length;E++){var D=G[E];if(D===""){F.appendChild(n2i.build("span",{text:""}))}else{var B=document.createElement("a");B.appendChild(document.createTextNode(D+1));B.setAttribute("data-index",D);B.onmousedown=function(){C.windowPageWasClicked(this);return false};if(D==C.window.page){B.className="selected"}F.appendChild(B)}}this.windowPage.style.display="block"}},buildPages:function(E,D){var B=[];var A=false;for(var C=0;C<E;C++){if(C<1||C>E-2||Math.abs(D-C)<5){B.push(C);A=false}else{if(!A){B.push("")}A=true}}return B},setData:function(A){this.selected=[];var B=A.window||{};this.window.total=B.total||0;this.window.size=B.size||0;this.window.page=B.page||0;this.buildNavigation();this.buildHeaders(A.headers);this.buildRows(A.rows)},buildHeaders:function(B){n2i.dom.clear(this.head);this.columns=[];var A=n2i.build("tr",{parent:this.head});n2i.each(B,function(D,C){var E=n2i.build("th");if(D.width){E.style.width=D.width+"%"}if(D.sortable){n2i.listen(E,"click",function(){this.sort(C)}.bind(this));n2i.addClass(E,"sortable")}E.appendChild(n2i.build("span",{text:D.title}));A.appendChild(E);this.columns.push(D)}.bind(this))},buildRows:function(B){var A=this;n2i.dom.clear(this.body);this.rows=[];if(!B){return }n2i.each(B,function(E,C){var F=n2i.build("tr");var D=E.icon;var H=E.title;n2i.each(E.cells,function(J){var I=n2i.build("td");if(J.icon){I.appendChild(In2iGui.createIcon(J.icon,1));D=D||J.icon}if(J.text){I.appendChild(document.createTextNode(J.text));H=H||J.text}F.appendChild(I)});A.body.appendChild(F);var G={id:E.id,kind:E.kind,icon:D,title:H,index:C};F.dragDropInfo=G;A.rows.push({id:E.id,kind:E.kind,icon:D,title:H,index:C,data:E.data});this.addRowBehavior(F,C)}.bind(this))},setObjects:function(I){this.selected=[];n2i.dom.clear(this.body);this.rows=[];for(var E=0;E<I.length;E++){var J=n2i.build("tr");var D=I[E];var F=null;for(var C=0;C<this.columns.length;C++){var H=n2i.build("td");if(this.builder){H.appendChild(this.builder.buildColumn(this.columns[C],D))}else{var G=D[this.columns[C].key]||"";if(n2i.isArray(G)){for(var B=0;B<G.length;B++){if(G[B].constructor==Object){H.appendChild(this.createObject(G[B]))}else{H.appendChild(n2i.build("div",{text:G}))}}}else{if(G.constructor==Object){H.appendChild(this.createObject(G[C]))}else{n2i.dom.addText(H,G);F=F==null?G:F}}}J.appendChild(H)}var A={id:D.id,kind:D.kind,title:F};J.dragDropInfo=A;this.body.appendChild(J);this.addRowBehavior(J,E);this.rows.push(D)}},createObject:function(A){var B=n2i.build("div",{"class":"object"});if(A.icon){B.appendChild(In2iGui.createIcon(A.icon,1))}n2i.dom.addText(B,A.text||A.name||"");return B},addRowBehavior:function(C,B){var A=this;C.onmousedown=function(D){if(A.busy){return }A.rowDown(B);In2iGui.startDrag(D,C);return false};C.ondblclick=function(){if(A.busy){return }A.rowDoubleClick(B);return false}},changeSelection:function(A){var C=this.body.getElementsByTagName("tr"),B;for(B=0;B<this.selected.length;B++){n2i.removeClass(C[this.selected[B]],"selected")}for(B=0;B<A.length;B++){n2i.addClass(C[A[B]],"selected")}this.selected=A;this.fire("selectionChanged",this.rows[A[0]])},rowDown:function(A){this.changeSelection([A])},rowDoubleClick:function(A){this.fire("listRowWasOpened",this.getFirstSelection())},windowPageWasClicked:function(A){var B=parseInt(A.getAttribute("data-index"));this.window.page=B;In2iGui.firePropertyChange(this,"window",this.window);In2iGui.firePropertyChange(this,"window.page",this.window.page)}};In2iGui.Tabs=function(D){D=D||{};this.name=D.name;this.element=n2i.get(D.element);this.activeTab=-1;var A=n2i.firstByClass(this.element,"in2igui_tabs_bar");this.bar=n2i.firstByTag(A,"ul");this.tabs=[];var B=this.bar.getElementsByTagName("li");for(var C=0;C<B.length;C++){this.tabs.push(B[C])}this.contents=n2i.byClass(this.element,"in2igui_tabs_tab");this.addBehavior();In2iGui.extend(this)};In2iGui.Tabs.create=function(B){B=B||{};var D=B.element=n2i.build("div",{"class":"in2igui_tabs"});var A="in2igui_tabs_bar";if(B.small){A+=" in2igui_tabs_bar_small"}if(B.centered){A+=" in2igui_tabs_bar_centered"}var C=n2i.build("div",{"class":A,parent:D});n2i.build("ul",{parent:C});return new In2iGui.Tabs(B)};In2iGui.Tabs.prototype={addBehavior:function(){for(var A=0;A<this.tabs.length;A++){this.addTabBehavior(this.tabs[A],A)}},addTabBehavior:function(B,A){n2i.listen(B,"click",function(){this.tabWasClicked(A)}.bind(this))},registerTab:function(A){A.parent=this;this.tabs.push(A)},tabWasClicked:function(A){this.activeTab=A;this.updateGUI()},updateGUI:function(){for(var A=0;A<this.tabs.length;A++){n2i.setClass(this.tabs[A],"in2igui_tabs_selected",A==this.activeTab);this.contents[A].style.display=A==this.activeTab?"block":"none"}},createTab:function(A){A=A||{};var B=n2i.build("li",{html:"<a><span><span>"+n2i.escape(A.title)+"</span></span></a>",parent:this.bar});this.addTabBehavior(B,this.tabs.length);this.tabs.push(B);var C=A.element=n2i.build("div",{"class":"in2igui_tabs_tab"});if(A.padding>0){C.style.padding=A.padding+"px"}this.contents.push(C);this.element.appendChild(C);if(this.activeTab==-1){this.activeTab=0;n2i.addClass(B,"in2igui_tabs_selected")}else{C.style.display="none"}return new In2iGui.Tab(A)}};In2iGui.Tab=function(A){this.name=A.name;this.element=n2i.get(A.element)};In2iGui.Tab.prototype={add:function(A){this.element.appendChild(A.element)}};In2iGui.ObjectList=function(A){this.options=n2i.override({key:null},A);this.name=A.name;this.element=n2i.get(A.element);this.body=n2i.firstByTag(this.element,"tbody");this.template=[];this.objects=[];In2iGui.extend(this)};In2iGui.ObjectList.create=function(E){E=E||{};var D=E.element=n2i.build("table",{"class":"in2igui_objectlist",cellpadding:"0",cellspacing:"0"});if(E.template){var B="<thead><tr>";for(var A=0;A<E.template.length;A++){B+="<th>"+(E.template[A].label||"")+"</th>"}B+="</tr></thead>";D.innerHTML=B}n2i.build("tbody",{parent:D});var C=new In2iGui.ObjectList(E);if(E.template){n2i.each(E.template,function(F){C.registerTemplateItem(new In2iGui.ObjectList.Text(F.key))})}return C};In2iGui.ObjectList.prototype={ignite:function(){this.addObject({})},addObject:function(B,D){var C;if(this.objects.length==0||D){C=new In2iGui.ObjectList.Object(this.objects.length,B,this);this.objects.push(C);this.body.appendChild(C.getElement())}else{var A=this.objects[this.objects.length-1];n2i.removeFromArray(this.objects,A);C=new In2iGui.ObjectList.Object(A.index,B,this);A.index++;this.objects.push(C);this.objects.push(A);this.body.insertBefore(C.getElement(),A.getElement())}},reset:function(){for(var B=0;B<this.objects.length;B++){var A=this.objects[B].getElement();if(!A.parentNode){n2i.log("no parent for...");n2i.log(A)}else{A.parentNode.removeChild(A)}}this.objects=[];this.addObject({})},addObjects:function(B){for(var A=0;A<B.length;A++){this.addObject(B[A])}},setObjects:function(A){this.reset();this.addObjects(A)},getObjects:function(C){var B=[];for(var A=0;A<this.objects.length-1;A++){B.push(this.objects[A].getData())}return B},getValue:function(){return this.getObjects()},setValue:function(A){this.setObjects(A)},registerTemplateItem:function(A){this.template.push(A)},objectDidChange:function(A){if(A.index>=this.objects.length-1){this.addObject({},true)}},getLabel:function(){return this.options.label}};In2iGui.ObjectList.Object=function(A,C,B){this.data=C;this.index=A;this.list=B;this.fields=[]};In2iGui.ObjectList.Object.prototype={getElement:function(){if(!this.element){this.element=document.createElement("tr");for(var B=0;B<this.list.template.length;B++){var C=this.list.template[B];var D=C.clone();D.object=this;this.fields.push(D);var A=document.createElement("td");if(B==0){A.className="first"}A.appendChild(D.getElement());D.setValue(this.data[C.key]);this.element.appendChild(A)}}return this.element},valueDidChange:function(){this.list.objectDidChange(this)},getData:function(){var B=this.data;for(var A=0;A<this.fields.length;A++){B[this.fields[A].key]=this.fields[A].getValue()}return B}};In2iGui.ObjectList.Text=function(A){this.key=A;this.value=null};In2iGui.ObjectList.Text.prototype={clone:function(){return new In2iGui.ObjectList.Text(this.key)},getElement:function(){var A=n2i.build("input",{"class":"in2igui_formula_text"});var B=In2iGui.wrapInField(A);this.wrapper=new In2iGui.TextField({element:A});this.wrapper.listen(this);return B},$valueChanged:function(A){this.value=A;this.object.valueDidChange()},getValue:function(){return this.value},setValue:function(A){this.value=A;this.wrapper.setValue(A)}};In2iGui.ObjectList.Select=function(A){this.key=A;this.value=null;this.options=[]};In2iGui.ObjectList.Select.prototype={clone:function(){var A=new In2iGui.ObjectList.Select(this.key);A.options=this.options;return A},getElement:function(){this.select=n2i.build("select");for(var B=0;B<this.options.length;B++){this.select.options[this.select.options.length]=new Option(this.options[B].label,this.options[B].value)}var A=this;this.select.onchange=function(){A.object.valueDidChange()};return this.select},getValue:function(){return this.select.value},setValue:function(A){this.select.value=A},addOption:function(B,A){this.options.push({value:B,label:A})}};In2iGui.Alert=function(A){this.options=n2i.override({modal:false},A);this.element=n2i.get(A.element);this.name=A.name;this.body=n2i.firstByClass(this.element,"in2igui_alert_body");this.content=n2i.firstByClass(this.element,"in2igui_alert_content");this.emotion=this.options.emotion;this.title=n2i.firstByTag(this.element,"h1");In2iGui.extend(this)};In2iGui.Alert.create=function(B){B=n2i.override({title:"",text:"",emotion:null,title:null},B);var C=B.element=n2i.build("div",{"class":"in2igui_alert"});var A=n2i.build("div",{"class":"in2igui_alert_body",parent:C});n2i.build("div",{"class":"in2igui_alert_content",parent:A});document.body.appendChild(C);var D=new In2iGui.Alert(B);if(B.emotion){D.setEmotion(B.emotion)}if(B.title){D.setTitle(B.title)}if(B.text){D.setText(B.text)}return D};In2iGui.Alert.prototype={show:function(){var A=In2iGui.nextAlertIndex();if(this.options.modal){In2iGui.showCurtain({widget:this,zIndex:A});A++}this.element.style.zIndex=A;this.element.style.display="block";this.element.style.top=(n2i.getScrollTop()+100)+"px";n2i.animate(this.element,"opacity",1,200);n2i.animate(this.element,"margin-top","40px",600,{ease:n2i.ease.elastic})},hide:function(){n2i.animate(this.element,"opacity",0,200,{hideOnComplete:true});n2i.animate(this.element,"margin-top","0px",200);In2iGui.hideCurtain(this)},setTitle:function(A){if(!this.title){this.title=n2i.build("h1",{parent:this.content})}n2i.dom.setText(this.title,A)},setText:function(A){if(!this.text){this.text=n2i.build("p",{parent:this.content})}n2i.dom.setText(this.text,A||"")},setEmotion:function(A){if(this.emotion){n2i.removeClass(this.body,this.emotion)}this.emotion=A;n2i.addClass(this.body,A)},update:function(A){A=A||{};this.setTitle(A.title||null);this.setText(A.text||null);this.setEmotion(A.emotion||null)},addButton:function(A){if(!this.buttons){this.buttons=In2iGui.Buttons.create({align:"right"});this.body.appendChild(this.buttons.element)}this.buttons.add(A)}};In2iGui.Button=function(A){this.options=A;this.name=A.name;this.element=n2i.get(A.element);this.enabled=!n2i.hasClass(this.element,"in2igui_button_disabled");In2iGui.extend(this);this.addBehavior()};In2iGui.Button.create=function(F){F=n2i.override({text:"",highlighted:false,enabled:true},F);var D="in2igui_button"+(F.highlighted?" in2igui_button_highlighted":"");if(F.small&&F.rounded){D+=" in2igui_button_small_rounded"}if(!F.enabled){D+=" in2igui_button_disabled"}var A=F.element=n2i.build("a",{"class":D,href:"#"});var E=document.createElement("span");A.appendChild(E);var C=document.createElement("span");E.appendChild(C);if(F.icon){var B=n2i.build("em",{"class":"in2igui_button_icon",style:"background-image:url("+In2iGui.getIconUrl(F.icon,1)+")"});if(!F.text||F.text.length==0){n2i.addClass(B,"in2igui_button_icon_notext")}C.appendChild(B)}if(F.text&&F.text.length>0){n2i.dom.addText(C,F.text)}if(F.title&&F.title.length>0){n2i.dom.addText(C,F.title)}return new In2iGui.Button(F)};In2iGui.Button.prototype={addBehavior:function(){var A=this;n2i.listen(this.element,"mousedown",function(B){n2i.stop(B)});n2i.listen(this.element,"click",function(B){n2i.stop(B);A.clicked()})},clicked:function(){if(this.enabled){if(this.options.confirm){In2iGui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this.fireClick.bind(this)})}else{this.fireClick()}}else{this.element.blur()}},fireClick:function(){this.fire("click");if(this.options.submit){var A=In2iGui.get().getAncestor(this,"in2igui_formula");if(A){A.submit()}}},click:function(A){if(A){this.listen({$click:A});return this}else{this.clicked()}},onClick:function(A){this.listen({$click:A})},setEnabled:function(A){this.enabled=A;this.updateUI()},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)},setHighlighted:function(A){n2i.setClass(this.element,"in2igui_button_highlighted",A)},updateUI:function(){n2i.setClass(this.element,"in2igui_button_disabled",!this.enabled)},setText:function(A){n2i.dom.setText(this.element.getElementsByTagName("span")[1],A)}};In2iGui.Buttons=function(A){this.name=A.name;this.element=n2i.get(A.element);this.body=n2i.firstByClass(this.element,"in2igui_buttons_body");In2iGui.extend(this)};In2iGui.Buttons.create=function(B){B=n2i.override({top:0},B);var A=B.element=n2i.build("div",{"class":"in2igui_buttons"});if(B.align=="right"){n2i.addClass(A,"in2igui_buttons_right")}if(B.align=="center"){n2i.addClass(A,"in2igui_buttons_center")}if(B.top>0){A.style.paddingTop=B.top+"px"}n2i.build("div",{"class":"in2igui_buttons_body",parent:A});return new In2iGui.Buttons(B)};In2iGui.Buttons.prototype={add:function(A){this.body.appendChild(A.element);return this}};In2iGui.Selection=function(A){this.options=n2i.override({value:null},A);this.element=n2i.get(A.element);this.name=A.name;this.items=[];this.subItems=[];this.selection=null;if(this.options.value!=null){this.selection={value:this.options.value}}In2iGui.extend(this)};In2iGui.Selection.create=function(A){A=n2i.override({width:0},A);var B=A.element=n2i.build("div",{"class":"in2igui_selection"});if(A.width>0){B.style.width=A.width+"px"}return new In2iGui.Selection(A)};In2iGui.Selection.prototype={getValue:function(){return this.selection},valueForProperty:function(A){if(A==="value"){return this.selection?this.selection.value:null}else{if(A==="kind"){return this.selection?this.selection.kind:null}}return undefined},setValue:function(B){var A=this.getSelectionWithValue(B);if(A===null){this.selection=null}else{this.selection=A;this.kind=A.kind}this.updateUI();this.fireChange()},getSelectionWithValue:function(D){var C;for(C=0;C<this.items.length;C++){if(this.items[C].value==D){return this.items[C]}}for(C=0;C<this.subItems.length;C++){var A=this.subItems[C].items;for(var B=0;B<A.length;B++){if(A[B].value==D){return A[B]}}}return null},reset:function(){this.setValue(null)},updateUI:function(){var A;for(A=0;A<this.items.length;A++){n2i.setClass(this.items[A].element,"in2igui_selected",this.isSelection(this.items[A]))}for(A=0;A<this.subItems.length;A++){this.subItems[A].updateUI()}},changeSelection:function(B){for(var A=0;A<this.subItems.length;A++){this.subItems[A].selectionChanged(this.selection,B)}this.selection=B;this.updateUI();this.fireChange()},fireChange:function(){this.fire("selectionChanged",this.selection);this.fireProperty("value",this.selection?this.selection.value:null);this.fireProperty("kind",this.selection?this.selection.kind:null);for(var A=0;A<this.subItems.length;A++){this.subItems[A].parentValueChanged()}},registerItems:function(A){A.parent=this;this.subItems.push(A)},registerItem:function(H,G,D,A,F,C){var B=n2i.get(H);var E={id:H,title:G,icon:D,badge:A,element:B,value:F,kind:C};this.items.push(E);this.addItemBehavior(B,E);this.selection=this.getSelectionWithValue(this.options.value)},addItemBehavior:function(B,A){n2i.listen(B,"click",function(){this.itemWasClicked(A)}.bind(this));n2i.listen(B,"dblclick",function(){this.itemWasDoubleClicked(A)}.bind(this));B.dragDropInfo=A},setObjects:function(A){this.items=[];n2i.each(A,function(D){this.items.push(D);var C=n2i.build("div",{"class":"in2igui_selection_item"});D.element=C;this.element.appendChild(C);var B=n2i.build("span",{"class":"in2igui_selection_label",text:D.title});if(D.icon){C.appendChild(In2iGui.createIcon(D.icon,1))}C.appendChild(B);n2i.listen(C,"click",function(){this.itemWasClicked(D)}.bind(this));n2i.listen(C,"dblclick",function(E){n2i.stop(E);this.itemWasDoubleClicked(D)}.bind(this))}.bind(this))},isSelection:function(B){if(this.selection===null){return false}var A=B.value==this.selection.value;if(this.selection.kind){A=A&&B.kind==this.selection.kind}return A},itemWasClicked:function(A){this.changeSelection(A)},itemWasDoubleClicked:function(A){this.fire("selectionWasOpened",A)}};In2iGui.Selection.Items=function(A){this.options=n2i.override({source:null},A);this.element=n2i.get(A.element);this.title=n2i.get(this.element.id+"_title");this.name=A.name;this.parent=null;this.items=[];In2iGui.extend(this);if(this.options.source){this.options.source.listen(this)}};In2iGui.Selection.Items.prototype={refresh:function(){if(this.options.source){this.options.source.refresh()}},$objectsLoaded:function(A){this.$itemsLoaded(A)},$itemsLoaded:function(A){this.items=[];this.element.innerHTML="";this.buildLevel(this.element,A,0);if(this.title){this.title.style.display=this.items.length>0?"block":"none"}this.parent.updateUI()},buildLevel:function(D,B,E){if(!B){return }var A=this.isHierarchy(B);var C=E==0;var F=n2i.build("div",{"class":"in2igui_selection_level",style:(C?"display:block":"display:none"),parent:D});n2i.each(B,function(L){if(L.type=="title"){n2i.build("div",{"class":"in2igui_selection_title",html:"<span>"+L.title+"</span>",parent:F});return }var H=L.children&&L.children.length>0;var N=E*16+6;if(!A&&E>0||A&&!H){N+=13}var K=n2i.build("div",{"class":"in2igui_selection_item"});K.style.paddingLeft=N+"px";if(L.badge){K.appendChild(n2i.build("strong",{"class":"in2igui_selection_badge",text:L.badge}))}if(A&&H){var J=this;var G=n2i.build("span",{"class":"in2igui_disclosure",parent:K});n2i.listen(G,"click",function(O){n2i.stop(O);J.toggle(G)})}var I=n2i.build("span",{"class":"in2igui_selection_label",text:L.title});if(L.icon){K.appendChild(n2i.build("span",{"class":"in2igui_icon_1",style:"background-image: url("+In2iGui.getIconUrl(L.icon,1)+")"}))}K.appendChild(I);n2i.listen(K,"click",function(O){this.parent.itemWasClicked(L)}.bind(this));n2i.listen(K,"dblclick",function(O){this.parent.itemWasDoubleClicked(L)}.bind(this));F.appendChild(K);var M={title:L.title,icon:L.icon,badge:L.badge,kind:L.kind,element:K,value:L.value};K.dragDropInfo=M;this.items.push(M);this.buildLevel(F,L.children,E+1)}.bind(this))},toggle:function(A){if(n2i.hasClass(A,"in2igui_disclosure_open")){n2i.getNext(A.parentNode).style.display="none";n2i.removeClass(A,"in2igui_disclosure_open")}else{n2i.getNext(A.parentNode).style.display="block";n2i.addClass(A,"in2igui_disclosure_open")}},isHierarchy:function(A){if(!A){return false}for(var B=0;B<A.length;B++){if(A[B]!==null&&A[B].children&&A[B].children.length>0){return true}}return false},getValue:function(){if(this.parent.selection==null){return null}for(var A=0;A<this.items.length;A++){if(this.items[A].value==this.parent.selection.value){return this.items[A]}}return null},updateUI:function(){for(var A=0;A<this.items.length;A++){n2i.setClass(this.items[A].element,"in2igui_selected",this.parent.isSelection(this.items[A]))}},selectionChanged:function(B,A){for(var C=0;C<this.items.length;C++){var D=this.items[C].value;if(D==A.value){this.fireProperty("value",A.value);return }}this.fireProperty("value",null)},parentValueChanged:function(){for(var A=0;A<this.items.length;A++){if(this.parent.isSelection(this.items[A])){this.fireProperty("value",this.items[A].value);return }}this.fireProperty("value",null)}};In2iGui.Toolbar=function(A){this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this)};In2iGui.Toolbar.create=function(A){A=A||{};A.element=n2i.build("div",{"class":A.labels?"in2igui_toolbar in2igui_toolbar_nolabels":"in2igui_toolbar"});return new In2iGui.Toolbar(A)};In2iGui.Toolbar.prototype={add:function(A){this.element.appendChild(A.getElement())},addDivider:function(){this.element.appendChild(n2i.build("span",{"class":"in2igui_divider"}))}};In2iGui.RevealingToolbar=function(A){this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this)};In2iGui.RevealingToolbar.create=function(A){A=A||{};A.element=n2i.build("div",{className:"in2igui_revealing_toolbar",style:"display:none",parent:document.body});var B=new In2iGui.RevealingToolbar(A);B.setToolbar(In2iGui.Toolbar.create());return B};In2iGui.RevealingToolbar.prototype={setToolbar:function(A){this.toolbar=A;this.element.appendChild(A.getElement())},getToolbar:function(){return this.toolbar},show:function(A){this.element.style.display="";n2i.ani(this.element,"height","58px",A?0:600,{ease:n2i.ease.slowFastSlow})},hide:function(){n2i.ani(this.element,"height","0px",500,{ease:n2i.ease.slowFastSlow,hideOnComplete:true})}};In2iGui.Toolbar.Icon=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;this.enabled=!n2i.hasClass(this.element,"in2igui_toolbar_icon_disabled");this.element.tabIndex=this.enabled?0:-1;this.icon=n2i.firstByClass(this.element,"in2igui_icon");In2iGui.extend(this);this.addBehavior()};In2iGui.Toolbar.Icon.create=function(B){var C=B.element=n2i.build("a",{"class":"in2igui_toolbar_icon"});var E=n2i.build("span",{"class":"in2igui_icon",style:"background-image: url("+In2iGui.getIconUrl(B.icon,2)+")"});var A=n2i.build("span",{"class":"in2igui_toolbar_inner_icon",parent:C});var D=n2i.build("span",{"class":"in2igui_toolbar_inner_icon",parent:A});var F=n2i.build("strong",{text:B.title});if(B.overlay){n2i.build("span",{"class":"in2igui_icon_overlay",parent:E,style:"background-image: url("+In2iGui.getIconUrl("overlay/"+B.overlay,2)+")"})}D.appendChild(E);D.appendChild(F);return new In2iGui.Toolbar.Icon(B)};In2iGui.Toolbar.Icon.prototype={addBehavior:function(){var A=this;this.element.onclick=function(){A.wasClicked()}},setEnabled:function(A){this.enabled=A;this.element.tabIndex=A?0:-1;n2i.setClass(this.element,"in2igui_toolbar_icon_disabled",!this.enabled)},disable:function(){this.setEnabled(false)},enable:function(){this.setEnabled(true)},setSelected:function(A){n2i.setClass(this.element,"in2igui_toolbar_icon_selected",A)},wasClicked:function(){if(this.enabled){if(this.options.confirm){In2iGui.confirmOverlay({widget:this,text:this.options.confirm.text,okText:this.options.confirm.okText,cancelText:this.options.confirm.cancelText,onOk:this.fireClick.bind(this)})}else{this.fireClick()}}},fireClick:function(){In2iGui.callDelegates(this,"toolbarIconWasClicked");In2iGui.callDelegates(this,"click")}};In2iGui.Toolbar.SearchField=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;this.field=n2i.firstByTag(this.element,"input");this.value=this.field.value;In2iGui.extend(this);this.addBehavior()};In2iGui.Toolbar.SearchField.create=function(A){A=A||{};A.element=n2i.build("div",{"class":A.adaptive?"in2igui_toolbar_search in2igui_toolbar_search_adaptive":"in2igui_toolbar_search",html:'<div class="in2igui_searchfield"><strong class="in2igui_searchfield_button"></strong><div><div><input type="text"/></div></div></div><span>'+n2i.escape(A.title)+"</span>"});return new In2iGui.Toolbar.SearchField(A)};In2iGui.Toolbar.SearchField.prototype={getValue:function(){return this.field.value},addBehavior:function(){var A=this;this.field.onkeyup=function(){A.fieldChanged()};if(!this.options.adaptive){this.field.onfocus=function(){n2i.ani(this,"width","120px",500,{ease:n2i.ease.slowFastSlow})};this.field.onblur=function(){n2i.ani(this,"width","80px",500,{ease:n2i.ease.slowFastSlow})}}},fieldChanged:function(){if(this.field.value!=this.value){this.value=this.field.value;In2iGui.callDelegates(this,"valueChanged");In2iGui.firePropertyChange(this,"value",this.value)}}};In2iGui.Toolbar.Badge=function(A){this.element=n2i.get(A.element);this.name=A.name;this.label=n2i.firstByTag(this.element,"strong");this.text=n2i.firstByTag(this.element,"span");In2iGui.extend(this)};In2iGui.Toolbar.Badge.prototype={setLabel:function(A){n2i.dom.setText(this.label,A)},setText:function(A){n2i.dom.setText(this.text,A)}};In2iGui.ImagePicker=function(A){this.name=A.name;this.options=A||{};this.element=n2i.get(A.element);this.images=[];this.object=null;this.thumbnailsLoaded=false;In2iGui.extend(this);this.addBehavior()};In2iGui.ImagePicker.prototype={addBehavior:function(){this.element.onclick=this.showPicker.bind(this)},setObject:function(A){this.object=A;this.updateUI()},getObject:function(){return this.object},reset:function(){this.object=null;this.updateUI()},updateUI:function(){if(this.object==null){this.element.style.backgroundImage=""}else{var A=In2iGui.resolveImageUrl(this,this.object,48,48);this.element.style.backgroundImage="url("+A+")"}},showPicker:function(){if(!this.picker){var B=this;this.picker=In2iGui.BoundPanel.create();this.content=n2i.build("div",{"class":"in2igui_imagepicker_thumbs"});var C=In2iGui.Buttons.create({align:"right"});var D=In2iGui.Button.create({text:"Luk",highlighted:true});D.listen({$click:function(){B.hidePicker()}});var A=In2iGui.Button.create({text:"Fjern"});A.listen({$click:function(){B.setObject(null);B.hidePicker()}});C.add(A).add(D);this.picker.add(this.content);this.picker.add(C)}this.picker.position(this.element);this.picker.show();if(!this.thumbnailsLoaded){this.updateImages();this.thumbnailsLoaded=true}},hidePicker:function(){this.picker.hide()},updateImages:function(){var A=this;n2i.request({onSuccess:function(B){A.parse(B.responseXML)},url:this.options.source})},parse:function(G){this.content.innerHTML="";var A=G.getElementsByTagName("image");var D=this;for(var F=0;F<A.length;F++){var H=A[F].getAttribute("id");var C={id:A[F].getAttribute("id")};var E=In2iGui.resolveImageUrl(this,C,48,48);var B=n2i.build("div",{"class":"in2igui_imagepicker_thumbnail",style:"background-image:url("+E+")"});B.in2iguiObject={"id":H};B.onclick=function(){D.setObject(this.in2iguiObject);D.hidePicker()};this.content.appendChild(B)}}};In2iGui.BoundPanel=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;this.visible=false;this.content=n2i.firstByClass(this.element,"in2igui_boundpanel_content");this.arrow=n2i.firstByClass(this.element,"in2igui_boundpanel_arrow");In2iGui.extend(this)};In2iGui.BoundPanel.create=function(A){A=n2i.override({name:null,top:0,left:0,width:null,padding:null},A);var B='<div class="in2igui_boundpanel_arrow"></div><div class="in2igui_boundpanel_top"><div><div></div></div></div><div class="in2igui_boundpanel_body"><div class="in2igui_boundpanel_body"><div class="in2igui_boundpanel_body"><div class="in2igui_boundpanel_content" style="';if(A.width){B+="width:"+A.width+"px;"}if(A.padding){B+="padding:"+A.padding+"px;"}B+='"></div></div></div></div><div class="in2igui_boundpanel_bottom"><div><div></div></div></div>';A.element=n2i.build("div",{"class":"in2igui_boundpanel",style:"display:none;zIndex:"+In2iGui.nextPanelIndex()+";top:"+A.top+"px;left:"+A.left+"px",html:B,parent:document.body});return new In2iGui.BoundPanel(A)};In2iGui.BoundPanel.prototype={toggle:function(){if(!this.visible){this.show()}else{this.hide()}},show:function(){if(!this.visible){if(this.options.target){this.position(In2iGui.get(this.options.target))}if(n2i.browser.opacity){n2i.setOpacity(this.element,0)}var A;if(this.relativePosition=="left"){A=false;this.element.style.marginLeft="30px"}else{if(this.relativePosition=="right"){A=false;this.element.style.marginLeft="-30px"}else{if(this.relativePosition=="top"){A=true;this.element.style.marginTop="30px"}else{if(this.relativePosition=="bottom"){A=true;this.element.style.marginTop="-30px"}}}}n2i.setStyle(this.element,{visibility:"hidden",display:"block"});var B=this.element.clientWidth;n2i.setStyle(this.element,{width:B+"px",visibility:"visible"});this.element.style.display="block";if(n2i.browser.opacity){n2i.animate(this.element,"opacity",1,400,{ease:n2i.ease.fastSlow})}n2i.animate(this.element,A?"margin-top":"margin-left","0px",800,{ease:n2i.ease.bounce})}this.element.style.zIndex=In2iGui.nextPanelIndex();this.visible=true},hide:function(){if(n2i.browser.msie){this.element.style.display="none"}else{n2i.animate(this.element,"opacity",0,300,{ease:n2i.ease.slowFast,hideOnComplete:true})}this.visible=false},add:function(A){if(A.getElement){this.content.appendChild(A.getElement())}else{this.content.appendChild(A)}},addSpace:function(A){this.add(n2i.build("div",{style:"font-size:0px;height:"+A+"px"}))},getDimensions:function(){var B,A;if(this.element.style.display=="none"){this.element.style.visibility="hidden";this.element.style.display="block";B=this.element.clientWidth;A=this.element.clientHeight;this.element.style.display="none";this.element.style.visibility=""}else{B=this.element.clientWidth;A=this.element.clientHeight}return{width:B,height:A}},position:function(C){if(C.getElement){C=C.getElement()}C=n2i.get(C);var F={left:n2i.getLeft(C),top:n2i.getTop(C)};var G={left:n2i.getScrollLeft(),top:n2i.getScrollTop()};var M=this.getDimensions();var J=n2i.getViewPortWidth();var H=n2i.getViewPortHeight();var O=F.left-G.left+n2i.getScrollLeft();var N=C.clientWidth;var A=C.clientHeight;var E=F.top-G.top+n2i.getScrollTop();var K,I,B,L;var D=(E-G.top)/H;if(D<0.1){this.relativePosition="top";this.arrow.className="in2igui_boundpanel_arrow in2igui_boundpanel_arrow_top";I=-16;B=Math.min(J-M.width,Math.max(0,O+(N/2)-((M.width)/2)));K=(O+N/2)-B-18;L=E+A+8}else{if(D>0.9){this.relativePosition="bottom";this.arrow.className="in2igui_boundpanel_arrow in2igui_boundpanel_arrow_bottom";I=M.height-6;B=Math.min(J-M.width,Math.max(0,O+(N/2)-((M.width)/2)));K=(O+N/2)-B-18;L=E-M.height-10}else{if((O+N/2)/J<0.5){this.relativePosition="left";B=O+N+10;this.arrow.className="in2igui_boundpanel_arrow in2igui_boundpanel_arrow_left";K=-14;L=Math.max(0,E+(A-M.height)/2);I=(M.height-32)/2+Math.min(0,E+(A-M.height)/2)}else{this.relativePosition="right";B=O-M.width-10;this.arrow.className="in2igui_boundpanel_arrow in2igui_boundpanel_arrow_right";K=M.width-4;L=Math.max(0,E+(A-M.height)/2);I=(M.height-32)/2+Math.min(0,E+(A-M.height)/2)}}}this.arrow.style.marginTop=I+"px";this.arrow.style.marginLeft=K+"px";if(this.visible){n2i.animate(this.element,"top",L+"px",500,{ease:n2i.ease.fastSlow});n2i.animate(this.element,"left",B+"px",500,{ease:n2i.ease.fastSlow})}else{this.element.style.top=L+"px";this.element.style.left=B+"px"}}};In2iGui.RichText=function(A){this.name=A.name;var B=this.element=n2i.get(A.element);this.options=n2i.override({debug:false,value:"",autoHideToolbar:true,style:"font-family: sans-serif;"},A);this.textarea=n2i.build("textarea");B.appendChild(this.textarea);this.editor=WysiHat.Editor.attach(this.textarea);this.editor.setAttribute("frameborder","0");this.toolbar=n2i.firstByClass(B,"in2igui_richtext_toolbar");this.toolbarContent=n2i.firstByClass(B,"in2igui_richtext_toolbar_content");this.value=this.options.value;this.document=null;this.ignited=false;this.buildToolbar();this.ignite();In2iGui.extend(this)};In2iGui.RichText.actions=[{key:"bold",cmd:"bold",value:null,icon:"edit/text_bold"},{key:"italic",cmd:"italic",value:null,icon:"edit/text_italic"},{key:"underline",cmd:"underline",value:null,icon:"edit/text_underline"},null,{key:"justifyleft",cmd:"justifyleft",value:null,icon:"edit/text_align_left"},{key:"justifycenter",cmd:"justifycenter",value:null,icon:"edit/text_align_center"},{key:"justifyright",cmd:"justifyright",value:null,icon:"edit/text_align_right"},null,{key:"increasefontsize",cmd:"increasefontsize",value:null,icon:"edit/increase_font_size"},{key:"decreasefontsize",cmd:"decreasefontsize",value:null,icon:"edit/decrease_font_size"},{key:"color",cmd:null,value:null,icon:"common/color"}];In2iGui.RichText.replaceInput=function(B){B=B||{};var A=n2i.get(B.input);A.style.display="none";B.value=A.value;var C=In2iGui.RichText.create(B);A.parentNode.insertBefore(C.element,A);C.ignite()};In2iGui.RichText.create=function(A){A=A||{};A.element=n2i.build("div",{"class":"in2igui_richtext",html:'<div class="in2igui_richtext_toolbar"><div class="in2igui_richtext_inner_toolbar"><div class="in2igui_richtext_toolbar_content"></div></div></div>'});return new In2iGui.RichText(A)};In2iGui.RichText.prototype={isCompatible:function(){var A=navigator.userAgent.toLowerCase();return true;return(A.indexOf("msie 6")>-1||A.indexOf("msie 7")>-1||(A.indexOf("gecko")>-1&&A.indexOf("safari")<0))},ignite:function(){var A=this;this.editor.observe("wysihat:loaded",function(B){if(this.ignited){return }this.editor.setStyle(this.options.style);this.editor.setRawContent(this.value);this.document=this.editor.getDocument();if(this.document.body){this.document.body.style.minHeight="100%";this.document.body.style.margin="0";this.document.documentElement.style.cursor="text";this.document.documentElement.style.minHeight="100%";Element.setStyle(this.document.body,this.options.style)}this.window=this.editor.getWindow();Event.observe(this.window,"focus",function(){A.documentFocused()});Event.observe(this.window,"blur",function(){A.documentBlurred()});this.document.body.focus();this.ignited=true}.bind(this));this.editor.observe("wysihat:change",function(B){this.documentChanged()}.bind(this))},setHeight:function(A){this.editor.style.height=A+"px"},focus:function(){try{var A=this.document.createRange();A.selectNodeContents(this.document.body);this.window.getSelection().addRange(A)}catch(B){}if(this.window){this.window.focus()}},setValue:function(A){this.value=A;this.editor.setRawContent(this.value)},getValue:function(){return this.value},deactivate:function(){if(this.colorPicker){this.colorPicker.hide()}if(this.toolbar){this.toolbar.style.display="none"}},buildToolbar:function(){this.toolbar.onmousedown=function(){this.toolbarMouseDown=true}.bind(this);this.toolbar.onmouseup=function(){this.toolbarMouseDown=false}.bind(this);var B=this;var D=In2iGui.RichText.actions;for(var C=0;C<D.length;C++){if(D[C]==null){this.toolbarContent.appendChild(n2i.build("div",{"class":"in2igui_richtext_divider"}))}else{var E=n2i.build("div",{"class":"action action_"+D[C].key});E.title=D[C].key;E.in2iguiRichTextAction=D[C];E.onclick=E.ondblclick=function(F){return B.actionWasClicked(this.in2iguiRichTextAction,F)};var A=n2i.build("img");A.src=In2iGui.context+"/In2iGui/gfx/trans.png";if(D[C].icon){E.style.backgroundImage="url("+In2iGui.getIconUrl(D[C].icon,1)+")"}E.appendChild(A);this.toolbarContent.appendChild(E);E.onmousedown=In2iGui.RichText.stopEvent}}},documentFocused:function(){if(n2i.browser.msie){this.toolbar.style.display="block";return }if(this.toolbar.style.display!="block"){this.toolbar.style.marginTop="-40px";n2i.setOpacity(this.toolbar,0);this.toolbar.style.display="block";n2i.ani(this.toolbar,"opacity",1,300);n2i.ani(this.toolbar,"margin-top","-32px",300)}},documentBlurred:function(){if(this.toolbarMouseDown){return }if(this.options.autoHideToolbar){if(n2i.browser.msie){var A=this;window.setTimeout(function(){A.toolbar.style.display="none"},100);return }n2i.ani(this.toolbar,"opacity",0,300,{hideOnComplete:true});n2i.ani(this.toolbar,"margin-top","-40px",300)}this.documentChanged();In2iGui.callDelegates(this,"richTextDidChange")},documentChanged:function(){this.value=this.editor.content();if(this.options.input){n2i.get(this.options.input).value=this.value}},disabler:function(B){var A=B?B:window.event;if(A.returnValue){A.returnValue=false}else{if(A.preventDefault){A.preventDefault()}}return false},actionWasClicked:function(A,B){In2iGui.RichText.stopEvent(B);if(A.key=="color"){this.showColorPicker()}else{this.execCommand(A)}this.document.body.focus();return false},execCommand:function(A){this.editor.execCommand(A.cmd,false,A.value);this.documentChanged()},showColorPicker:function(){if(!this.colorPicker){var A=In2iGui.Window.create({variant:"dark"});var B=In2iGui.ColorPicker.create();B.listen(this);A.add(B);A.show();this.colorPicker=A}this.colorPicker.show()},$colorWasHovered:function(A){},$colorWasSelected:function(A){this.document.execCommand("forecolor",false,A);this.documentChanged()}};In2iGui.RichText.stopEvent=function(B){var A=B?B:window.event;if(A.returnValue){A.returnValue=false}else{if(A.preventDefault){A.preventDefault()}else{return false}}};In2iGui.ImageViewer=function(A){this.options=n2i.override({maxWidth:800,maxHeight:600,perimeter:100,sizeSnap:100,margin:0,ease:n2i.ease.slowFastSlow,easeEnd:n2i.ease.bounce,easeAuto:n2i.ease.slowFastSlow,easeReturn:n2i.ease.cubicInOut,transition:400,transitionEnd:1000,transitionReturn:300},A);this.element=n2i.get(A.element);this.box=this.options.box;this.viewer=n2i.firstByClass(this.element,"in2igui_imageviewer_viewer");this.innerViewer=n2i.firstByClass(this.element,"in2igui_imageviewer_inner_viewer");this.status=n2i.firstByClass(this.element,"in2igui_imageviewer_status");this.previousControl=n2i.firstByClass(this.element,"in2igui_imageviewer_previous");this.controller=n2i.firstByClass(this.element,"in2igui_imageviewer_controller");this.nextControl=n2i.firstByClass(this.element,"in2igui_imageviewer_next");this.playControl=n2i.firstByClass(this.element,"in2igui_imageviewer_play");this.closeControl=n2i.firstByClass(this.element,"in2igui_imageviewer_close");this.text=n2i.firstByClass(this.element,"in2igui_imageviewer_text");this.dirty=false;this.width=600;this.height=460;this.index=0;this.playing=false;this.name=A.name;this.images=[];this.box.listen(this);this.addBehavior();In2iGui.extend(this)};In2iGui.ImageViewer.create=function(A){A=A||{};var B=A.element=n2i.build("div",{"class":"in2igui_imageviewer",html:'<div class="in2igui_imageviewer_viewer"><div class="in2igui_imageviewer_inner_viewer"></div></div><div class="in2igui_imageviewer_text"></div><div class="in2igui_imageviewer_status"></div><div class="in2igui_imageviewer_controller"><div><div><a class="in2igui_imageviewer_previous"></a><a class="in2igui_imageviewer_play"></a><a class="in2igui_imageviewer_next"></a><a class="in2igui_imageviewer_close"></a></div></div></div>'});var C=In2iGui.Box.create({absolute:true,modal:true,closable:true});C.add(B);C.addToDocument();A.box=C;return new In2iGui.ImageViewer(A)};In2iGui.ImageViewer.prototype={addBehavior:function(){var A=this;this.nextControl.onclick=function(){A.next(true)};this.previousControl.onclick=function(){A.previous(true)};this.playControl.onclick=function(){A.playOrPause()};this.closeControl.onclick=this.hide.bind(this);n2i.listen(this.viewer,"click",this.zoom.bind(this));this.timer=function(){A.next(false)};this.keyListener=function(B){B=n2i.event(B);if(B.rightKey){A.next(true)}else{if(B.leftKey){A.previous(true)}else{if(B.escapeKey){A.hide()}else{if(B.returnKey){A.playOrPause()}}}}},n2i.listen(this.viewer,"mousemove",this.mouseMoveEvent.bind(this));n2i.listen(this.controller,"mouseenter",function(){A.overController=true});n2i.listen(this.controller,"mouseleave",function(){A.overController=false});n2i.listen(this.viewer,"mouseout",function(B){if(!In2iGui.isWithin(B,this.viewer)){A.hideController()}}.bind(this))},mouseMoveEvent:function(){window.clearTimeout(this.ctrlHider);if(this.shouldShowController()){this.ctrlHider=window.setTimeout(this.hideController.bind(this),2000);if(n2i.browser.msie){this.controller.show()}else{In2iGui.fadeIn(this.controller,200)}}},hideController:function(){if(!this.overController){if(n2i.browser.msie){this.controller.hide()}else{In2iGui.fadeOut(this.controller,500)}}},zoom:function(D){var A=this.images[this.index];if(A.width<=this.width&&A.height<=this.height){return }if(!this.zoomer){this.zoomer=n2i.build("div",{"class":"in2igui_imageviewer_zoomer",style:"width:"+this.viewer.clientWidth+"px;height:"+this.viewer.clientHeight+"px"});this.element.insertBefore(this.zoomer,n2i.firstByTag(this.element,"*"));n2i.listen(this.zoomer,"mousemove",this.zoomMove.bind(this));n2i.listen(this.zoomer,"click",function(){this.style.display="none"})}this.pause();var C=this.getLargestSize({width:2000,height:2000},A);var B=In2iGui.resolveImageUrl(this,A,C.width,C.height);this.zoomer.innerHTML='<div style="width:'+C.width+"px;height:"+C.height+'px;"><img src="'+B+'"/></div>';this.zoomer.style.display="block";this.zoomInfo={width:C.width,height:C.height};this.zoomMove(D)},zoomMove:function(B){B=new n2i.Event(B);if(!this.zoomInfo){return }var C={left:n2i.getLeft(this.zoomer),top:n2i.getTop(this.zoomer)};var A=(B.left()-C.left)/this.zoomer.clientWidth*(this.zoomInfo.width-this.zoomer.clientWidth);var D=(B.top()-C.top)/this.zoomer.clientHeight*(this.zoomInfo.height-this.zoomer.clientHeight);this.zoomer.scrollLeft=A;this.zoomer.scrollTop=D},getLargestSize:function(A,B){if(B.width<=A.width&&B.height<=A.height){return{width:B.width,height:B.height}}else{if(A.width/A.height>B.width/B.height){return{width:Math.round(A.height/B.height*B.width),height:A.height}}else{if(A.width/A.height<B.width/B.height){return{width:A.width,height:Math.round(A.width/B.width*B.height)}}else{return{width:A.width,height:A.height}}}}},calculateSize:function(){var A=this.options.sizeSnap;var F=n2i.getViewPortWidth()-this.options.perimeter;F=Math.floor(F/A)*A;F=Math.min(F,this.options.maxWidth);var B=n2i.getViewPortHeight()-this.options.perimeter;B=Math.floor(B/A)*A;B=Math.min(B,this.options.maxHeight);var E=0;var D=0;for(var C=0;C<this.images.length;C++){var G=this.getLargestSize({width:F,height:B},this.images[C]);E=Math.max(E,G.width);D=Math.max(D,G.height)}B=Math.floor(Math.min(B,D));F=Math.floor(Math.min(F,E));if(F!=this.width||B!=this.height){this.width=F;this.height=B;this.dirty=true}},adjustSize:function(){},showById:function(B){for(var A=0;A<this.images.length;A++){if(this.images[A].id==B){this.show(A);break}}},show:function(A){this.index=A||0;this.calculateSize();this.updateUI();var B=this.options.margin;n2i.setStyle(this.element,{width:(this.width+B)+"px",height:(this.height+B*2-1)+"px"});n2i.setStyle(this.viewer,{width:(this.width+B)+"px",height:(this.height-1)+"px"});n2i.setStyle(this.innerViewer,{width:((this.width+B)*this.images.length)+"px",height:(this.height-1)+"px"});n2i.setStyle(this.controller,{marginLeft:((this.width-180)/2+B*0.5)+"px",display:"none"});this.box.show();this.goToImage(false,0,false);n2i.listen(document,"keydown",this.keyListener)},hide:function(A){this.pause();this.box.hide();n2i.unListen(document,"keydown",this.keyListener)},$boxCurtainWasClicked:function(){this.hide()},$boxWasClosed:function(){this.hide()},updateUI:function(){if(this.dirty){this.innerViewer.innerHTML="";for(var B=0;B<this.images.length;B++){var A=n2i.build("div",{"class":"in2igui_imageviewer_image"});n2i.setStyle(A,{"width":(this.width+this.options.margin)+"px","height":(this.height-1)+"px"});this.innerViewer.appendChild(A)}if(this.shouldShowController()){this.controller.style.display="block"}else{this.controller.style.display="none"}this.dirty=false;this.preload()}},shouldShowController:function(){return this.images.length>1},goToImage:function(C,D,B){if(C){if(D>1){n2i.ani(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),Math.min(D*this.options.transitionReturn,2000),{ease:this.options.easeReturn})}else{var A=this.index==0||this.index==this.images.length-1;var F=(A?this.options.easeEnd:this.options.ease);if(!B){F=this.options.easeAuto}n2i.ani(this.viewer,"scrollLeft",this.index*(this.width+this.options.margin),(A?this.options.transitionEnd:this.options.transition),{ease:F})}}else{this.viewer.scrollLeft=this.index*(this.width+this.options.margin)}var E=this.images[this.index].text;if(E){this.text.innerHTML=E;this.text.style.display="block"}else{this.text.innerHTML="";this.text.style.display="none"}},clearImages:function(){this.images=[];this.dirty=true},addImages:function(A){for(var B=0;B<A.length;B++){this.addImage(A[B])}},addImage:function(A){this.images.push(A);this.dirty=true},play:function(){if(!this.interval){this.interval=window.setInterval(this.timer,6000)}this.next(false);this.playing=true;this.playControl.className="in2igui_imageviewer_pause"},pause:function(){window.clearInterval(this.interval);this.interval=null;this.playControl.className="in2igui_imageviewer_play";this.playing=false},playOrPause:function(){if(this.playing){this.pause()}else{this.play()}},resetPlay:function(){if(this.playing){window.clearInterval(this.interval);this.interval=window.setInterval(this.timer,6000)}},previous:function(A){var B=1;this.index--;if(this.index<0){this.index=this.images.length-1;B=this.images.length-1}this.goToImage(true,B,A);this.resetPlay()},next:function(A){var B=1;this.index++;if(this.index==this.images.length){this.index=0;B=this.images.length-1}this.goToImage(true,B,A);this.resetPlay()},preload:function(){var B=new n2i.Preloader();B.addImages(In2iGui.context+"In2iGui/gfx/imageviewer_controls.png");var A=this;B.setDelegate({allImagesDidLoad:function(){A.preloadImages()}});B.load()},preloadImages:function(){var A=new n2i.Preloader();A.setDelegate(this);for(var C=0;C<this.images.length;C++){var B=In2iGui.resolveImageUrl(this,this.images[C],this.width,this.height);if(B!==null){A.addImages(B)}}this.status.innerHTML="0%";this.status.style.display="";A.load(this.index)},allImagesDidLoad:function(){this.status.style.display="none"},imageDidLoad:function(C,D,B){this.status.innerHTML=Math.round(C/D*100)+"%";var A=In2iGui.resolveImageUrl(this,this.images[B],this.width,this.height);A=A.replace(/&amp;/g,"&");this.innerViewer.childNodes[B].style.backgroundImage="url('"+A+"')";n2i.setClass(this.innerViewer.childNodes[B],"in2igui_imageviewer_image_abort",false);n2i.setClass(this.innerViewer.childNodes[B],"in2igui_imageviewer_image_error",false)},imageDidGiveError:function(B,C,A){n2i.setClass(this.innerViewer.childNodes[A],"in2igui_imageviewer_image_error",true)},imageDidAbort:function(B,C,A){n2i.setClass(this.innerViewer.childNodes[A],"in2igui_imageviewer_image_abort",true)}};In2iGui.Picker=function(A){A=this.options=n2i.override({itemWidth:100,itemHeight:150,itemsVisible:null,shadow:true,valueProperty:"value"},A);this.element=n2i.get(A.element);this.name=A.name;this.container=n2i.firstByClass(this.element,"in2igui_picker_container");this.content=n2i.firstByClass(this.element,"in2igui_picker_content");this.title=n2i.firstByClass(this.element,"in2igui_picker_title");this.objects=[];this.selected=null;this.value=null;this.addBehavior();In2iGui.extend(this)};In2iGui.Picker.create=function(A){A=n2i.override({shadow:true},A);A.element=n2i.build("div",{"class":"in2igui_picker",html:'<div class="in2igui_picker_top"><div><div></div></div></div><div class="in2igui_picker_middle"><div class="in2igui_picker_middle">'+(A.title?'<div class="in2igui_picker_title">'+A.title+"</div>":"")+'<div class="in2igui_picker_container"><div class="in2igui_picker_content"></div></div></div></div><div class="in2igui_picker_bottom"><div><div></div></div></div>'});if(A.shadow==true){n2i.addClass(A.element,"in2igui_picker_shadow")}return new In2iGui.Picker(A)};In2iGui.Picker.prototype={addBehavior:function(){var A=this;n2i.listen(this.content,"mousedown",function(B){A.startDrag(B);return false})},setObjects:function(A){this.selected=null;this.objects=A||[];this.updateUI()},setValue:function(A){this.value=A;this.updateSelection()},getValue:function(){return this.value},reset:function(){this.value=null;this.updateSelection()},updateUI:function(){var A=this,B;this.content.innerHTML="";this.container.scrollLeft=0;if(this.options.itemsVisible){B=this.options.itemsVisible*(this.options.itemWidth+14)}else{B=this.container.clientWidth}n2i.setStyle(this.container,{width:B+"px",height:(this.options.itemHeight+10)+"px"});this.content.style.width=(this.objects.length*(this.options.itemWidth+14))+"px";this.content.style.height=(this.options.itemHeight+10)+"px";n2i.each(this.objects,function(C,D){var E=n2i.build("div",{"class":"in2igui_picker_item",title:C.title});if(A.value!=null&&C[A.options.valueProperty]==A.value){n2i.addClass(E,"in2igui_picker_item_selected")}E.innerHTML='<div class="in2igui_picker_item_middle"><div class="in2igui_picker_item_middle"><div style="width:'+A.options.itemWidth+"px;height:"+A.options.itemHeight+"px; overflow: hidden; background-image:url('"+C.image+"')\"><strong>"+n2i.escape(C.title)+'</strong></div></div></div><div class="in2igui_picker_item_bottom"><div><div></div></div></div>';n2i.listen(E,"mouseup",function(){A.selectionChanged(C[A.options.valueProperty])});A.content.appendChild(E)})},updateSelection:function(){var B=this.content.childNodes;for(var A=0;A<B.length;A++){n2i.setClass(B[A],"in2igui_picker_item_selected",this.value!=null&&this.objects[A][this.options.valueProperty]==this.value)}},selectionChanged:function(A){if(this.dragging){return }if(this.value==A){return }this.value=A;this.updateSelection();this.fire("selectionChanged",A)},startDrag:function(B){B=new n2i.Event(B);B.stop();var A=this;this.dragX=B.left();this.dragScroll=this.container.scrollLeft;In2iGui.Picker.mousemove=function(C){A.drag(C);return false};In2iGui.Picker.mouseup=In2iGui.Picker.mousedown=function(C){A.endDrag(C);return false};n2i.listen(window.document,"mousemove",In2iGui.Picker.mousemove);n2i.listen(window.document,"mouseup",In2iGui.Picker.mouseup);n2i.listen(window.document,"mousedown",In2iGui.Picker.mouseup)},drag:function(A){A=new n2i.Event();this.dragging=true;A.stop();this.container.scrollLeft=this.dragX-A.left()+this.dragScroll},endDrag:function(B){this.dragging=false;n2i.stop(B);n2i.unListen(window.document,"mousemove",In2iGui.Picker.mousemove);n2i.unListen(window.document,"mouseup",In2iGui.Picker.mouseup);n2i.unListen(window.document,"mousedown",In2iGui.Picker.mouseup);var A=this.options.itemWidth+14;n2i.ani(this.container,"scrollLeft",Math.round(this.container.scrollLeft/A)*A,500,{ease:n2i.ease.bounceOut})},$visibilityChanged:function(){this.container.style.display="none";var A;if(this.options.itemsVisible){A=this.options.itemsVisible*(this.options.itemWidth+14)}else{A=this.container.parentNode.clientWidth-12}A=Math.max(A,0);n2i.setStyle(this.container,{width:A+"px",display:"block"})}};In2iGui.Editor=function(){this.name="In2iGuiEditor";this.options={rowClass:"row",columnClass:"column",partClass:"part"};this.parts=[];this.rows=[];this.partControllers=[];this.activePart=null;this.active=false;this.dragProxy=null;In2iGui.extend(this)};In2iGui.Editor.get=function(){if(!In2iGui.Editor.instance){In2iGui.Editor.instance=new In2iGui.Editor()}return In2iGui.Editor.instance};In2iGui.Editor.prototype={ignite:function(){this.reload()},addPartController:function(B,C,A){this.partControllers.push({key:B,"title":C,"controller":A})},setOptions:function(A){n2i.override(this.options,A)},getPartController:function(A){var B=null;n2i.each(this.partControllers,function(C){if(C.key==A){B=C}});return B},reload:function(){if(this.partControls){this.partControls.hide()}var A=this;this.parts=[];var B=n2i.byClass(document.body,this.options.partClass);n2i.each(B,function(F,E){var D=n2i.byClass(F,A.options.columnClass);A.reloadColumns(D,E);n2i.each(D,function(H,G){var I=H.select("."+A.options.partClass);A.reloadParts(I,E,G)})});var C=n2i.byClass(document.body,this.options.partClass);n2i.each(this.parts,function(D){var E=C.indexOf(D.element);if(E!=-1){delete (C[E])}});this.reloadParts(C,-1,-1)},partExists:function(A){},reloadColumns:function(B,C){var A=this;n2i.each(B,function(E,D){n2i.lsiten(E,"mouseover",function(){A.hoverColumn(E)});n2i.listen(E,"mouseout",function(){A.blurColumn()});n2i.listen(E,"contextmenu",function(F){A.contextColumn(E,C,D,F)})})},reloadParts:function(D,E,C){var A=this;var B=new RegExp(this.options.partClass+"_([\\w]+)","i");n2i.each(D,function(H,J){if(!H){return }var G=H.className.match(B);if(G&&G[1]){var I=A.getPartController(G[1]);if(I){var F=new I.controller(H,E,C,J);F.type=G[1];n2i.listen(H,"click",function(){A.editPart(F)});n2i.listen(H,"mouseover",function(K){A.hoverPart(F)});n2i.listen(H,"mouseout",function(K){A.blurPart(K)});n2i.listen(H,"mousedown",function(K){A.startPartDrag(K)});A.parts.push(F)}}})},activate:function(){this.active=true},deactivate:function(){this.active=false;if(this.activePart){this.activePart.deactivate()}if(this.partControls){this.partControls.hide()}},hoverColumn:function(A){this.hoveredColumn=A;if(!this.active||this.activePart){return }n2i.addClass(A,"in2igui_editor_column_hover")},blurColumn:function(){if(!this.active||!this.hoveredColumn){return }n2i.removeClass(this.hoveredColumn,"in2igui_editor_column_hover")},contextColumn:function(C,G,B,E){if(!this.active||this.activePart){return }if(!this.columnMenu){var F=In2iGui.Menu.create({name:"In2iGuiEditorColumnMenu"});F.addItem({title:"Rediger kolonne",value:"editColumn"});F.addItem({title:"Slet kolonne",value:"removeColumn"});F.addItem({title:"Tilfj kolonne",value:"addColumn"});F.addDivider();for(var A=0;A<this.partControllers.length;A++){var D=this.partControllers[A];F.addItem({title:D.title,value:D.key})}this.columnMenu=F;F.listen(this)}this.hoveredRow=G;this.hoveredColumnIndex=B;this.columnMenu.showAtPointer(E)},$itemWasClicked$In2iGuiEditorColumnMenu:function(A){if(A=="removeColumn"){this.fire("removeColumn",{"row":this.hoveredRow,"column":this.hoveredColumnIndex})}else{if(A=="editColumn"){this.editColumn(this.hoveredRow,this.hoveredColumnIndex)}else{if(A=="addColumn"){this.fire("addColumn",{"row":this.hoveredRow,"position":this.hoveredColumnIndex+1})}else{this.fire("addPart",{"row":this.hoveredRow,"column":this.hoveredColumnIndex,"position":0,type:A})}}}},editColumn:function(D,A){this.closeColumn();var B=n2i.byClass(document.body,"row")[D];var C=this.activeColumn=n2i.byClass(B,"column")[A];n2i.addClass(C,"in2igui_editor_column_edit");this.showColumnWindow();this.columnEditorForm.setValues({width:C.getStyle("width"),paddingLeft:C.getStyle("padding-left")})},closeColumn:function(){if(this.activeColumn){n2i.removeClass(this.activeColumn,"in2igui_editor_column_edit")}},showColumnWindow:function(){if(!this.columnEditor){var A=this.columnEditor=In2iGui.Window.create({name:"columnEditor",title:"Rediger kolonne",width:200});var F=this.columnEditorForm=In2iGui.Formula.create();var C=F.createGroup();var B=In2iGui.Formula.Text.create({label:"Bredde",key:"width"});B.listen({$valueChanged:function(G){this.changeColumnWidth(G)}.bind(this)});C.add(B);var E=In2iGui.Formula.Text.create({label:"Venstremargen",key:"left"});E.listen({$valueChanged:function(G){this.changeColumnLeftMargin(G)}.bind(this)});C.add(E);var D=In2iGui.Formula.Text.create({label:"Hjremargen",key:"right"});D.listen({$valueChanged:this.changeColumnRightMargin.bind(this)});C.add(D);A.add(F);A.listen(this)}this.columnEditor.show()},$userClosedWindow$columnEditor:function(){this.closeColumn();var A=this.columnEditorForm.getValues();A.row=this.hoveredRow;A.column=this.hoveredColumnIndex;this.fire("updateColumn",A)},changeColumnWidth:function(A){this.activeColumn.style.width=A},changeColumnLeftMargin:function(A){this.activeColumn.setStyle({"paddingLeft":A})},changeColumnRightMargin:function(A){this.activeColumn.setStyle({"paddingRight":A})},hoverPart:function(B,C){if(!this.active||this.activePart){return }this.hoveredPart=B;n2i.addClass(B.element,"in2igui_editor_part_hover");var A=this;this.partControlTimer=window.setTimeout(function(){A.showPartControls()},200)},blurPart:function(A){window.clearTimeout(this.partControlTimer);if(!this.active){return }if(this.partControls&&!In2iGui.isWithin(A,this.partControls.element)){this.hidePartControls();n2i.removeClass(this.hoveredPart.element,"in2igui_editor_part_hover")}if(!this.partControls&&this.hoveredPart){n2i.removeClass(this.hoveredPart.element,"in2igui_editor_part_hover")}},showPartEditControls:function(){if(!this.partEditControls){this.partEditControls=In2iGui.Overlay.create({name:"In2iGuiEditorPartEditActions"});this.partEditControls.addIcon("save","common/save");this.partEditControls.addIcon("cancel","common/close");this.partEditControls.listen(this)}this.partEditControls.showAtElement(this.activePart.element,{"horizontal":"right","vertical":"topOutside"})},showPartControls:function(){if(!this.partControls){this.partControls=In2iGui.Overlay.create({name:"In2iGuiEditorPartActions"});this.partControls.addIcon("edit","common/edit");this.partControls.addIcon("new","common/new");this.partControls.addIcon("delete","common/delete");var A=this;n2i.listen(this.partControls.getElement(),"mouseout",function(B){A.blurControls(B)});n2i.listen(this.partControls.getElement(),"mouseover",function(B){A.hoverControls(B)});this.partControls.listen(this)}if(this.hoveredPart.column==-1){this.partControls.hideIcons(["new","delete"])}else{this.partControls.showIcons(["new","delete"])}this.partControls.showAtElement(this.hoveredPart.element,{"horizontal":"right"})},hoverControls:function(A){n2i.addClass(this.hoveredPart.element,"in2igui_editor_part_hover")},blurControls:function(A){n2i.removeClass(this.hoveredPart.element,"in2igui_editor_part_hover");if(!In2iGui.isWithin(A,this.hoveredPart.element)){this.hidePartControls()}},$iconWasClicked$In2iGuiEditorPartActions:function(A,B){if(A=="delete"){this.deletePart(this.hoveredPart)}else{if(A=="new"){this.newPart(B)}else{if(A=="edit"){this.editPart(this.hoveredPart)}}}},$iconWasClicked$In2iGuiEditorPartEditActions:function(A,B){if(A=="cancel"){this.cancelPart(this.activePart)}else{if(A=="save"){this.savePart(this.activePart)}}},hidePartControls:function(){if(this.partControls){this.partControls.hide()}},hidePartEditControls:function(){if(this.partEditControls){this.partEditControls.hide()}},editPart:function(A){if(!this.active||this.activePart){return }if(this.activePart){this.activePart.deactivate()}if(this.hoveredPart){n2i.removeClass(this.hoveredPart.element,"in2igui_editor_part_hover")}this.activePart=A;this.showPartEditControls();n2i.addClass(A.element,"in2igui_editor_part_active");A.activate();window.clearTimeout(this.partControlTimer);this.hidePartControls();this.blurColumn();this.showPartEditor()},showPartEditor:function(){},updatePartProperties:function(A){n2i.setStyle(this.activePart.element,{marginTop:A.top,marginBottom:A.bottom,marginLeft:A.left,marginRight:A.right});this.activePart.properties=A;n2i.log(A)},hidePartEditor:function(){if(this.partEditor){this.partEditor.hide()}},cancelPart:function(A){A.cancel();this.hidePartEditor()},savePart:function(A){A.save();this.hidePartEditor()},getEditorForElement:function(B){for(var A=0;A<this.parts.length;A++){if(this.parts[A].element==B){return this.parts[A]}}return null},partDidDeacivate:function(A){n2i.removeClass(A.element,"in2igui_editor_part_active");this.activePart=null;this.hidePartEditControls()},partChanged:function(A){In2iGui.callDelegates(A,"partChanged")},deletePart:function(A){In2iGui.callDelegates(A,"deletePart");this.partControls.hide()},newPart:function(A){if(!this.newPartMenu){var B=In2iGui.Menu.create({name:"In2iGuiEditorNewPartMenu"});n2i.each(this.partControllers,function(C){B.addItem({title:C.title,value:C.key})});B.listen(this);this.newPartMenu=B}this.newPartMenu.showAtPointer(A)},itemWasClicked$In2iGuiEditorNewPartMenu:function(A){var B={row:this.hoveredPart.row,column:this.hoveredPart.column,position:this.hoveredPart.position+1,type:A};In2iGui.callDelegates(this,"addPart",B)},startPartDrag:function(B){return true;if(!this.active||this.activePart){return true}if(!this.dragProxy){this.dragProxy=n2i.build("div",{"class":"in2igui_editor_dragproxy part part_header",parent:document.body})}var A=this.hoveredPart.element;this.dragProxy.style.width=A.clientWidth+"px";this.dragProxy.innerHTML=A.innerHTML;In2iGui.Editor.startDrag(B,this.dragProxy);return ;n2i.listen(document.body,"mouseup",function(){self.endPartDrag()})},dragPart:function(){},endPartDrag:function(){In2iGui.get()}};In2iGui.Editor.startDrag=function(B,A){In2iGui.Editor.dragElement=A;n2i.listen(document.body,"mousemove",In2iGui.Editor.dragListener);n2i.listen(document.body,"mouseup",In2iGui.Editor.dragEndListener);In2iGui.Editor.startDragPos={top:B.pointerY(),left:B.pointerX()};B.stop();return false};In2iGui.Editor.dragListener=function(B){B=n2i.event(B);var A=In2iGui.Editor.dragElement;A.style.left=B.getLeft()+"px";A.style.top=B.getTop()+"px";A.style.display="block";return false};In2iGui.Editor.dragEndListener=function(A){n2i.unListen(document.body,"mousemove",In2iGui.Editor.dragListener);n2i.unListen(document.body,"mouseup",In2iGui.Editor.dragEndListener);In2iGui.Editor.dragElement.style.display="none";In2iGui.Editor.dragElement=null};In2iGui.Editor.getPartId=function(B){var A=B.id.match(/part\-([\d]+)/i);if(A&&A.length>0){return A[1]}};In2iGui.Editor.Header=function(B,D,C,A){this.element=n2i.get(B);this.row=D;this.column=C;this.position=A;this.id=In2iGui.Editor.getPartId(this.element);this.header=n2i.firstByTag(this.element,"*");this.field=null};In2iGui.Editor.Header.prototype={activate:function(){this.value=this.header.innerHTML;this.field=n2i.build("textarea",{className:"in2igui_editor_header"});this.field.value=this.value;this.header.style.visibility="hidden";this.updateFieldStyle();this.element.insertBefore(this.field,this.header);this.field.focus();this.field.select();n2i.listen(this.field,"keydown",function(A){if(A.keyCode==Event.KEY_RETURN){this.save()}}.bind(this))},save:function(){var A=this.field.value;this.header.innerHTML=A;this.deactivate();if(A!=this.value){this.value=A;In2iGui.Editor.get().partChanged(this)}},cancel:function(){this.deactivate()},deactivate:function(){this.header.style.visibility="";this.element.removeChild(this.field);In2iGui.Editor.get().partDidDeacivate(this)},updateFieldStyle:function(){n2i.setStyle(this.field,{width:this.header.clientWidth+"px",height:this.header.clientHeight+"px"});n2i.copyStyle(this.header,this.field,["fontSize","lineHeight","marginTop","fontWeight","fontFamily","textAlign","color","fontStyle"])},getValue:function(){return this.value}};In2iGui.Editor.Html=function(B,D,C,A){this.element=n2i.get(B);this.row=D;this.column=C;this.position=A;this.id=In2iGui.Editor.getPartId(this.element);this.field=null};In2iGui.Editor.Html.prototype={activate:function(){this.value=this.element.innerHTML;this.element.innerHTML="";var A=this.buildStyle();this.editor=In2iGui.MarkupEditor.create({autoHideToolbar:false,style:A});this.element.appendChild(this.editor.getElement());this.editor.listen(this);this.editor.setValue(this.value);this.editor.focus()},buildStyle:function(){return{"textAlign":n2i.getStyle(this.element,"text-align"),"fontFamily":n2i.getStyle(this.element,"font-family"),"fontSize":n2i.getStyle(this.element,"font-size"),"fontWeight":n2i.getStyle(this.element,"font-weight"),"color":n2i.getStyle(this.element,"color")}},cancel:function(){this.deactivate();this.element.innerHTML=this.value},save:function(){this.deactivate();var A=this.editor.getValue();if(A!=this.value){this.value=A;In2iGui.Editor.get().partChanged(this)}this.element.innerHTML=this.value},deactivate:function(){if(this.editor){this.editor.destroy();this.element.innerHTML=this.value}In2iGui.Editor.get().partDidDeacivate(this)},richTextDidChange:function(){},getValue:function(){return this.value}};In2iGui.Menu=function(A){this.options=n2i.override({autoHide:false,parentElement:null},A);this.element=n2i.get(A.element);this.name=A.name;this.value=null;this.subMenus=[];this.visible=false;In2iGui.extend(this);this.addBehavior()};In2iGui.Menu.create=function(A){A=A||{};A.element=n2i.build("div",{"class":"in2igui_menu"});var B=new In2iGui.Menu(A);document.body.appendChild(A.element);return B};In2iGui.Menu.prototype={addBehavior:function(){var B=this;this.hider=function(){B.hide()};if(this.options.autoHide){var A=function(C){if(!In2iGui.isWithin(C,B.element)&&(!B.options.parentElement||!In2iGui.isWithin(C,B.options.parentElement))){if(!B.isSubMenuVisible()){B.hide()}}};n2i.listen(this.element,"mouseout",A);if(this.options.parentElement){n2i.listen(this.options.parentElement,"mouseout",A)}}},addDivider:function(){n2i.build("div",{"class":"in2igui_menu_divider",parent:this.element})},addItem:function(D){var A=this;var B=n2i.build("div",{"class":"in2igui_menu_item",text:D.title});n2i.listen(B,"click",function(E){n2i.stop(E);A.itemWasClicked(D.value)});if(D.children){var C=In2iGui.Menu.create({autoHide:true,parentElement:B});C.addItems(D.children);n2i.listen(B,"mouseover",function(E){C.showAtElement(B,E,"horizontal")});A.subMenus.push(C);n2i.addClass(B,"in2igui_menu_item_children")}this.element.appendChild(B)},addItems:function(A){for(var B=0;B<A.length;B++){if(A[B]==null){this.addDivider()}else{this.addItem(A[B])}}},getValue:function(){return this.value},itemWasClicked:function(A){this.value=A;this.fire("itemWasClicked",A);this.fire("select",A);this.hide()},showAtPointer:function(A){A=n2i.event(A);A.stop();this.showAtPoint({"top":A.getTop(),"left":A.getLeft()})},showAtElement:function(C,D,B){D=n2i.event(D);D.stop();C=n2i.get(C);var A=n2i.getPosition(C);if(B=="horizontal"){A.left+=C.clientWidth}else{if(B=="vertical"){A.top+=C.clientHeight}}this.showAtPoint(A)},showAtPoint:function(H){var F=n2i.getViewPortWidth();var A=n2i.getViewPortHeight();var C=n2i.getScrollTop();var E=n2i.getScrollLeft();if(!this.visible){n2i.setStyle(this.element,{"display":"block","visibility":"hidden",opacity:0})}var B=this.element.clientWidth;var I=this.element.clientHeight;var D=Math.min(H.left,F-B-26+E);var G=Math.max(0,Math.min(H.top,A-I-20+C));n2i.setStyle(this.element,{"top":G+"px","left":D+"px","visibility":"visible",zIndex:In2iGui.nextTopIndex()});if(!this.element.style.width){this.element.style.width=(B+6)+"px"}if(!this.visible){n2i.setStyle(this.element,{opacity:1});this.addHider();this.visible=true}},hide:function(){if(!this.visible){return }var A=this;n2i.animate(this.element,"opacity",0,200,{onComplete:function(){A.element.style.display="none"}});this.removeHider();for(var B=0;B<this.subMenus.length;B++){this.subMenus[B].hide()}this.visible=false},isSubMenuVisible:function(){for(var A=0;A<this.subMenus.length;A++){if(this.subMenus[A].visible){return true}}return false},addHider:function(){n2i.listen(document.body,"click",this.hider)},removeHider:function(){n2i.unListen(document.body,"click",this.hider)}};In2iGui.Overlay=function(A){this.options=A;this.element=n2i.get(A.element);this.content=n2i.byClass(this.element,"in2igui_inner_overlay")[1];this.name=A.name;this.icons={};this.visible=false;In2iGui.extend(this);this.addBehavior()};In2iGui.Overlay.create=function(A){A=A||{};var B=A.element=n2i.build("div",{className:"in2igui_overlay",style:"display:none",html:'<div class="in2igui_inner_overlay"><div class="in2igui_inner_overlay"></div></div>'});document.body.appendChild(B);return new In2iGui.Overlay(A)};In2iGui.Overlay.prototype={addBehavior:function(){var A=this;this.hider=function(B){if(A.boundElement){if(In2iGui.isWithin(B,A.boundElement)||In2iGui.isWithin(B,A.element)){return }n2i.removeClass(A.boundElement,"in2igui_overlay_bound");A.boundElement=null;A.hide()}};n2i.listen(this.element,"mouseout",this.hider)},addIcon:function(C,D){var A=this;var B=n2i.build("div",{className:"in2igui_overlay_icon"});B.style.backgroundImage="url("+In2iGui.getIconUrl(D,2)+")";n2i.listen(B,"click",function(E){A.iconWasClicked(C,E)});this.icons[C]=B;this.content.appendChild(B)},addText:function(A){this.content.appendChild(n2i.build("span",{"class":"in2igui_overlay_text",text:A}))},add:function(A){this.content.appendChild(A.getElement())},hideIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display="none"}},showIcons:function(B){for(var A=0;A<B.length;A++){this.icons[B[A]].style.display=""}},iconWasClicked:function(A,B){In2iGui.callDelegates(this,"iconWasClicked",A,B)},showAtElement:function(B,A){A=A||{};In2iGui.positionAtElement(this.element,B,A);if(this.visible){return }if(n2i.browser.msie){this.element.style.display="block"}else{n2i.setStyle(this.element,{"display":"block","opacity":0});n2i.ani(this.element,"opacity",1,150)}this.visible=true;if(A.autoHide){this.boundElement=B;n2i.listen(B,"mouseout",this.hider);n2i.addClass(B,"in2igui_overlay_bound")}if(this.options.modal){var C=In2iGui.nextAlertIndex();this.element.style.zIndex=C+1;In2iGui.showCurtain({widget:this,zIndex:C})}return },show:function(B){B=B||{};if(!this.visible){n2i.setStyle(this.element,{"display":"block",visibility:"hidden"})}if(B.element){n2i.place({source:{element:this.element,vertical:0,horizontal:0.5},target:{element:B.element,vertical:0.5,horizontal:0.5},insideViewPort:true})}if(this.visible){return }In2iGui.bounceIn(this.element);this.visible=true;if(B.autoHide&&B.element){this.boundElement=B.element;n2i.listen(B.element,"mouseout",this.hider);n2i.addClass(B.element,"in2igui_overlay_bound")}if(this.options.modal){var C=In2iGui.nextAlertIndex();this.element.style.zIndex=C+1;var A=n2i.getStyle(document.body,"background-color");In2iGui.showCurtain({widget:this,zIndex:C,color:A})}},$curtainWasClicked:function(){this.hide()},hide:function(){In2iGui.hideCurtain(this);this.element.style.display="none";this.visible=false},clear:function(){In2iGui.destroyDescendants(this.content);this.content.innerHTML=""}};In2iGui.Upload=function(A){this.options=n2i.override({url:"",parameters:{},maxItems:50,maxSize:"20480",types:"*.*",useFlash:true,fieldName:"file",chooseButton:"Choose files..."},A);this.element=n2i.get(A.element);this.itemContainer=n2i.firstByClass(this.element,"in2igui_upload_items");this.status=n2i.firstByClass(this.element,"in2igui_upload_status");this.placeholder=n2i.firstByClass(this.element,"in2igui_upload_placeholder");this.name=A.name;this.items=[];this.busy=false;this.loaded=false;this.useFlash=this.options.useFlash;if(this.options.useFlash){this.useFlash=In2iGui.Flash.getMajorVersion()>=10}In2iGui.extend(this);this.addBehavior()};In2iGui.Upload.nameIndex=0;In2iGui.Upload.create=function(A){A=A||{};A.element=n2i.build("div",{"class":"in2igui_upload",html:'<div class="in2igui_upload_items"></div><div class="in2igui_upload_status"></div>'+(A.placeholder?'<div class="in2igui_upload_placeholder"><span class="in2igui_upload_icon"></span>'+(A.placeholder.title?"<h2>"+n2i.escape(A.placeholder.title)+"</h2>":"")+(A.placeholder.text?"<p>"+n2i.escape(A.placeholder.text)+"</p>":"")+"</div>":"")});return new In2iGui.Upload(A)};In2iGui.Upload.prototype={addBehavior:function(){if(!this.useFlash){this.createIframeVersion();return }In2iGui.onDomReady(this.createFlashVersion.bind(this))},setParameter:function(A,D){if(this.useFlash){alert("Not implemented for flash")}else{var C=this.form.getElementsByTagName("input");for(var B=0;B<C.length;B++){if(C[B].name==A){C[B].value=D;return }}this.form.appendChild(n2i.build("input",{"type":"hidden","name":A,"value":D}))}},createIframeVersion:function(){In2iGui.Upload.nameIndex++;var A="in2igui_upload_"+In2iGui.Upload.nameIndex;var F=this.form=n2i.build("form");F.setAttribute("action",this.options.url||"");F.setAttribute("method","post");F.setAttribute("enctype","multipart/form-data");F.setAttribute("encoding","multipart/form-data");F.setAttribute("target",A);if(this.options.parameters){for(var C in this.options.parameters){var G=n2i.build("input",{"type":"hidden","name":C});G.value=this.options.parameters[C];F.appendChild(G)}}var E=this.iframe=n2i.build("iframe",{name:A,id:A,src:In2iGui.context+"/In2iGui/html/blank.html"});E.style.display="none";this.element.appendChild(E);this.fileInput=n2i.build("input",{"type":"file","class":"file","name":this.options.fieldName});n2i.listen(this.fileInput,"change",this.iframeSubmit.bind(this));F.appendChild(this.fileInput);var B=n2i.build("span",{"class":"in2igui_upload_button"});var D=n2i.build("span",{"class":"in2igui_upload_button_input"});D.appendChild(F);B.appendChild(D);if(this.options.widget){In2iGui.onDomReady(function(){var H=In2iGui.get(this.options.widget);H.element.parentNode.insertBefore(B,H.element);H.element.parentNode.removeChild(H.element);B.appendChild(H.element)}.bind(this))}else{B.innerHTML='<a href="javascript:void(0);" class="in2igui_button"><span><span>'+this.options.chooseButton+"</span></span></a>";this.element.appendChild(B)}n2i.listen(E,"load",function(){this.iframeUploadComplete()}.bind(this))},iframeUploadComplete:function(){if(!this.uploading){return }n2i.log("iframeUploadComplete uploading: "+this.uploading+" ("+this.name+")");this.uploading=false;this.form.reset();var B=n2i.getFrameDocument(this.iframe);var A=this.items[this.items.length-1];if(B.body.innerHTML.indexOf("SUCCESS")!=-1){if(A){A.update({progress:1,filestatus:"Frdig"})}this.fire("uploadDidComplete",{});n2i.log("Iframe upload succeeded")}else{if(A){A.setError("Upload af filen fejlede!");n2i.log("Iframe upload failed!");this.fire("uploadDidFail",{})}}this.fire("uploadDidCompleteQueue");this.iframe.src=In2iGui.context+"/In2iGui/html/blank.html";this.endIframeProgress()},iframeSubmit:function(){this.startIframeProgress();this.uploading=true;if(n2i.browser.msie){n2i.each(this.options.parameters,function(B,C){this.form[B].value=C}.bind(this))}this.form.submit();this.fire("uploadDidStartQueue");var A=this.fileInput.value.split("\\").pop();this.addItem({name:A,filestatus:"I gang"}).setWaiting();n2i.log("Iframe upload started!")},startIframeProgress:function(){this.form.style.display="none"},endIframeProgress:function(){this.form.style.display="block";this.form.reset()},clear:function(){for(var A=0;A<this.items.length;A++){if(this.items[A]){this.items[A].destroy()}}this.items=[];this.itemContainer.style.display="none";this.status.style.display="none";if(this.placeholder){this.placeholder.style.display="block"}},getAbsoluteUrl:function(B){var C=new String(document.location);var A=C.slice(0,C.lastIndexOf("/"));while(B.indexOf("../")===0){B=B.substring(3);A=A.slice(0,A.lastIndexOf("/"))}A+="/"+B;return A},createFlashVersion:function(){n2i.log("Creating flash verison");var E=this.getAbsoluteUrl(this.options.url);var C=n2i.cookie.get("JSESSIONID");if(C){E+=";jsessionid="+C}var F=n2i.cookie.get("PHPSESSID");if(F){E+="?PHPSESSID="+F}var D=n2i.build("span",{"class":"in2igui_upload_button"});var G=n2i.build("span",{"class":"in2igui_upload_button_object",parent:D});if(this.options.widget){var A=In2iGui.get(this.options.widget);A.element.parentNode.insertBefore(D,A.element);A.element.parentNode.removeChild(A.element);D.appendChild(A.element)}else{D.innerHTL='<a href="javascript:void(0);" class="in2igui_button"><span><span>'+this.options.chooseButton+"</span></span></a>";this.element.appendChild(D)}var B=this;this.loader=new SWFUpload({upload_url:E,flash_url:In2iGui.context+"/In2iGui/lib/swfupload/swfupload.swf",file_size_limit:this.options.maxSize,file_queue_limit:this.options.maxItems,file_post_name:this.options.fieldName,file_upload_limit:this.options.maxItems,file_types:this.options.types,debug:true,post_params:this.options.parameters,button_placeholder_id:"x",button_placeholder:G,button_width:"100%",button_height:30,swfupload_loaded_handler:this.flashLoaded.bind(this),file_queued_handler:B.fileQueued.bind(B),file_queue_error_handler:this.fileQueueError.bind(this),file_dialog_complete_handler:this.fileDialogComplete.bind(this),upload_start_handler:this.uploadStart.bind(this),upload_progress_handler:this.uploadProgress.bind(this),upload_error_handler:this.uploadError.bind(this),upload_success_handler:this.uploadSuccess.bind(this),upload_complete_handler:this.uploadComplete.bind(this)})},startNextUpload:function(){this.loader.startUpload()},flashLoaded:function(){n2i.log("flash loaded");this.loaded=true},addError:function(B,A){var C=this.addItem(B);C.setError(A)},fileQueued:function(A){this.addItem(A)},fileQueueError:function(B,A,C){if(B!==null){this.addError(B,A)}else{In2iGui.showMessage({text:In2iGui.Upload.errors[A],duration:4000})}},fileDialogComplete:function(){n2i.log("fileDialogComplete");this.startNextUpload()},uploadStart:function(){this.status.style.display="block";n2i.log("uploadStart");if(!this.busy){this.fire("uploadDidStartQueue")}this.busy=true},uploadProgress:function(B,A,C){this.updateStatus();this.items[B.index].updateProgress(A,C)},uploadError:function(B,A,C){n2i.log("uploadError file:"+B+", error:"+A+", message:"+C);if(B){this.items[B.index].update(B)}},uploadSuccess:function(A,B){n2i.log("uploadSuccess file:"+A+", data:"+B);this.items[A.index].updateProgress(A.size,A.size)},uploadComplete:function(A){this.items[A.index].update(A);this.startNextUpload();this.fire("uploadDidComplete",A);if(this.loader.getStats().files_queued==0){this.fire("uploadDidCompleteQueue")}this.updateStatus();this.busy=false},addItem:function(B){var A=B.index;if(A===undefined){A=this.items.length;B.index=A}var C=new In2iGui.Upload.Item(B);this.items[A]=C;this.itemContainer.appendChild(C.element);this.itemContainer.style.display="block";if(this.placeholder){this.placeholder.style.display="none"}return C},updateStatus:function(){var A=this.loader.getStats();if(this.items.length==0){this.status.style.display="none"}else{n2i.dom.setText(this.status,"Status: "+Math.round(A.successful_uploads/this.items.length*100)+"%");this.status.style.display="block"}n2i.log(A)}};In2iGui.Upload.Item=function(A){this.element=n2i.build("div",{className:"in2igui_upload_item"});if(A.index%2==1){n2i.addClass(this.element,"in2igui_upload_item_alt")}this.content=n2i.build("div",{className:"in2igui_upload_item_content"});this.icon=In2iGui.createIcon("file/generic",2);this.element.appendChild(this.icon);this.element.appendChild(this.content);this.info=document.createElement("strong");this.status=document.createElement("em");this.progress=In2iGui.ProgressBar.create({small:true});this.content.appendChild(this.progress.getElement());this.content.appendChild(this.info);this.content.appendChild(this.status);this.update(A)};In2iGui.Upload.Item.prototype={update:function(A){n2i.dom.setText(this.status,In2iGui.Upload.status[A.filestatus]||A.filestatus);if(A.name){n2i.dom.setText(this.info,A.name)}if(A.progress!==undefined){this.setProgress(A.progress)}if(A.filestatus==SWFUpload.FILE_STATUS.ERROR){n2i.addClass(this.element,"in2igui_upload_item_error");this.progress.hide()}},setError:function(A){n2i.dom.setText(this.status,In2iGui.Upload.errors[A]||A);n2i.addClass(this.element,"in2igui_upload_item_error");this.progress.hide()},updateProgress:function(A,B){this.progress.setValue(A/B);return this},setProgress:function(A){this.progress.setValue(A);return this},setWaiting:function(A){this.progress.setWaiting();return this},hide:function(){this.element.hide()},destroy:function(){n2i.dom.remove(this.element)}};if(window.SWFUpload){(function(){var B=In2iGui.Upload.errors={};B[SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED]="Der er valgt for mange filer";B[SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT]="Filen er for stor";B[SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE]="Filen er tom";B[SWFUpload.QUEUE_ERROR.INVALID_FILETYPE]="Filens type er ikke understttet";B[SWFUpload.UPLOAD_ERROR.HTTP_ERROR]="Der skete en netvrksfejl";B[SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL]="Upload-adressen findes ikke";B[SWFUpload.UPLOAD_ERROR.IO_ERROR]="Der skete en IO-fejl";B[SWFUpload.UPLOAD_ERROR.SECURITY_ERROR]="Der skete en sikkerhedsfejl";B[SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED]="Upload-strrelsen er overskredet";B[SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED]="Upload af filen fejlede";B[SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND]="Filens id kunne ikke findes";B[SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED]="Validering af filen fejlede";B[SWFUpload.UPLOAD_ERROR.FILE_CANCELLED]="Filen blev afbrudt";B[SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED]="Upload af filen blev stoppet";var A=In2iGui.Upload.status={};A[SWFUpload.FILE_STATUS.QUEUED]="I k";A[SWFUpload.FILE_STATUS.IN_PROGRESS]="I gang";A[SWFUpload.FILE_STATUS.ERROR]="Filen gav fejl";A[SWFUpload.FILE_STATUS.COMPLETE]="Frdig";A[SWFUpload.FILE_STATUS.CANCELLED]="Afbrudt"}())}In2iGui.ProgressBar=function(A){this.element=n2i.get(A.element);this.name=A.name;this.WAITING=A.small?"in2igui_progressbar_small_waiting":"in2igui_progressbar_waiting";this.COMPLETE=A.small?"in2igui_progressbar_small_complete":"in2igui_progressbar_complete";this.options=A||{};this.indicator=n2i.firstByTag(this.element,"div");In2iGui.extend(this)};In2iGui.ProgressBar.create=function(B){B=B||{};var A=B.element=n2i.build("div",{"class":B.small?"in2igui_progressbar in2igui_progressbar_small":"in2igui_progressbar"});A.appendChild(document.createElement("div"));return new In2iGui.ProgressBar(B)};In2iGui.ProgressBar.prototype={setValue:function(B){var A=this.element;if(this.waiting){n2i.removeClass(A,this.WAITING)}n2i.setClass(A,this.COMPLETE,B==1);n2i.ani(this.indicator,"width",(B*100)+"%",200)},setWaiting:function(){this.waiting=true;this.indicator.style.width=0;n2i.addClass(this.element,this.WAITING)},reset:function(){var A=this.element;if(this.waiting){n2i.removeClass(A,this.WAITING)}n2i.removeClass(A,this.COMPLETE);this.indicator.style.width="0%"},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display="block"}};In2iGui.Gallery=function(A){this.options=A||{};this.name=A.name;this.element=n2i.get(A.element);this.objects=[];this.nodes=[];this.selected=[];this.width=100;this.height=100;this.revealing=false;In2iGui.extend(this);if(this.options.source){this.options.source.listen(this)}if(this.element.parentNode&&n2i.hasClass(this.element.parentNode,"in2igui_overflow")){this.revealing=true;n2i.listen(this.element.parentNode,"scroll",this._reveal.bind(this))}};In2iGui.Gallery.create=function(A){A=A||{};A.element=n2i.build("div",{"class":"in2igui_gallery"});return new In2iGui.Gallery(A)};In2iGui.Gallery.prototype={setObjects:function(A){this.objects=A;this.render();this.fire("selectionReset")},getObjects:function(){return this.objects},$objectsLoaded:function(A){this.setObjects(A)},$itemsLoaded:function(A){this.setObjects(A)},render:function(){this.nodes=[];this.maxRevealed=0;this.element.innerHTML="";var A=this;n2i.each(this.objects,function(D,E){var C=A.resolveImageUrl(D),G=0;if(C!==null){C=C.replace(/&amp;/,"&")}if(D.height<D.width){G=(A.height-(A.height*D.height/D.width))/2}var B=n2i.build("img",{style:"margin:"+G+"px auto 0px"});B.setAttribute(A.revealing?"data-src":"src",C);var F=n2i.build("div",{"class":"in2igui_gallery_item",style:"width:"+A.width+"px; height:"+A.height+"px"});F.appendChild(B);n2i.listen(F,"click",function(){A.itemClicked(E)});F.dragDropInfo={kind:"image",icon:"common/image",id:D.id,title:D.name||D.title};F.onmousedown=function(H){In2iGui.startDrag(H,F);return false};n2i.listen(F,"dblclick",function(){A.itemDoubleClicked(E)});A.element.appendChild(F);A.nodes.push(F)});this._reveal()},$$layout:function(){if(this.nodes.length>0){this._reveal()}},_reveal:function(){if(!this.revealing){return }var C=this.element.parentNode;var B=C.scrollTop+C.clientHeight;if(B<=this.maxRevealed){return }this.maxRevealed=B;for(var E=0,A=this.nodes.length;E<A;E++){var F=this.nodes[E];if(F.revealed){continue}if(F.offsetTop<B){var D=F.getElementsByTagName("img")[0];F.className="in2igui_gallery_item in2igui_gallery_item_busy";D.onload=function(){F.className="in2igui_gallery_item"};D.src=D.getAttribute("data-src");F.revealed=true}}},updateUI:function(){var B=this.selected;for(var A=0;A<this.nodes.length;A++){n2i.setClass(this.nodes[A],"in2igui_gallery_item_selected",n2i.inArray(B,A))}},resolveImageUrl:function(A){return In2iGui.resolveImageUrl(this,A,this.width,this.height);for(var B=0;B<this.delegates.length;B++){if(this.delegates[B]["$resolveImageUrl"]){return this.delegates[B]["$resolveImageUrl"](A,this.width,this.height)}}return""},itemClicked:function(A){this.selected=[A];this.fire("selectionChanged");this.updateUI()},getFirstSelection:function(){if(this.selected.length>0){return this.objects[this.selected[0]]}return null},itemDoubleClicked:function(A){this.fire("itemOpened",this.objects[A])},setSource:function(A){if(this.options.source!=A){if(this.options.source){this.options.source.removeDelegate(this)}A.listen(this);this.options.source=A;A.refresh()}}};In2iGui.Calendar=function(A){this.name=A.name;this.options=n2i.override({startHour:7,endHour:24},A);this.element=n2i.get(A.element);this.head=n2i.firstByTag(this.element,"thead");this.body=n2i.firstByTag(this.element,"tbody");this.date=new Date();In2iGui.extend(this);this.buildUI();this.updateUI();if(this.options.source){this.options.source.listen(this)}};In2iGui.Calendar.prototype={show:function(){this.element.style.display="block";if(this.options.source){this.options.source.refresh()}},hide:function(){this.element.style.display="none"},getFirstDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+1);A.setHours(0);A.setMinutes(0);A.setSeconds(0);return A},getLastDay:function(){var A=new Date(this.date.getTime());A.setDate(A.getDate()-A.getDay()+7);A.setHours(23);A.setMinutes(59);A.setSeconds(59);return A},clearEvents:function(){this.events=[];var A=n2i.byClass(this.element,"in2igui_calendar_event");for(var B=0;B<A.length;B++){n2i.dom.remove(A[B])}this.hideEventViewer()},$objectsLoaded:function(A){try{this.setEvents(A)}catch(B){n2i.log(B)}},$sourceIsBusy:function(){this.setBusy(true)},$sourceShouldRefresh:function(){return this.element.style.display!="none"},setEvents:function(D){D=D||[];for(var C=0;C<D.length;C++){var F=D[C];if(typeof (F.startTime)!="object"){F.startTime=new Date(parseInt(F.startTime)*1000)}if(typeof (F.endTime)!="object"){F.endTime=new Date(parseInt(F.endTime)*1000)}}this.setBusy(false);this.clearEvents();this.events=D;var A=this;var G=(this.options.endHour-this.options.startHour)*40;var B=this.getFirstDay().getWeekOfYear();var E=this.getFirstDay().getYear();n2i.each(this.events,function(L){var I=n2i.byClass(A.body,"in2igui_calendar_day")[L.startTime.getDay()-1];if(!I){return }if(L.startTime.getWeekOfYear()!=B||L.startTime.getYear()!=E){return }var K=n2i.build("div",{"class":"in2igui_calendar_event",parent:I});var M=((L.startTime.getHours()*60+L.startTime.getMinutes())/60-A.options.startHour)*40-1;var H=(L.endTime.getTime()-L.startTime.getTime())/1000/60/60*40+1;H=Math.min(G-M,H);n2i.setStyle(K,{"marginTop":M+"px","height":H+"px",visibility:"hidden"});var J=n2i.build("div",{parent:K});n2i.build("p",{"class":"in2igui_calendar_event_time",text:L.startTime.dateFormat("H:i"),parent:J});n2i.build("p",{"class":"in2igui_calendar_event_text",text:L.text,parent:J});if(L.location){n2i.build("p",{"class":"in2igui_calendar_event_location",text:L.location,parent:J})}window.setTimeout(function(){In2iGui.bounceIn(K)},Math.random()*200);n2i.listen(K,"click",function(){A.eventWasClicked(K)})})},eventWasClicked:function(A){this.showEvent(A)},setBusy:function(A){n2i.setClass(this.element,"in2igui_calendar_busy",A)},updateUI:function(){var C=this.getFirstDay();var D=n2i.byClass(this.head,"day");for(var B=0;B<D.length;B++){var A=new Date(C.getTime());A.setDate(A.getDate()+B);n2i.dom.setText(D[B],A.dateFormat("l \\d. d M"))}},buildUI:function(){var F=n2i.firstByClass(this.element,"in2igui_calendar_bar");this.toolbar=In2iGui.Toolbar.create({labels:false});F.appendChild(this.toolbar.getElement());var E=In2iGui.Button.create({name:"in2iguiCalendarPrevious",text:"",icon:"monochrome/previous"});E.listen(this);this.toolbar.add(E);var A=In2iGui.Button.create({name:"in2iguiCalendarToday",text:"Idag"});A.click(function(){this.setDate(new Date())}.bind(this));this.toolbar.add(A);var C=In2iGui.Button.create({name:"in2iguiCalendarNext",text:"",icon:"monochrome/next"});C.listen(this);this.toolbar.add(C);this.datePickerButton=In2iGui.Button.create({name:"in2iguiCalendarDatePicker",text:"Vlg dato..."});this.datePickerButton.listen(this);this.toolbar.add(this.datePickerButton);var G=n2i.firstByClass(this.body,"in2igui_calendar_day");for(var B=this.options.startHour;B<=this.options.endHour;B++){var D=n2i.build("div",{"class":"in2igui_calendar_time",html:"<span><em>"+B+":00</em></span>"});if(B==this.options.startHour){n2i.addClass(D,"in2igui_calendar_time_first")}if(B==this.options.endHour){n2i.addClass(D,"in2igui_calendar_time_last")}G.appendChild(D)}},$click$in2iguiCalendarPrevious:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()-7);this.setDate(A)},$click$in2iguiCalendarNext:function(){var A=new Date(this.date.getTime());A.setDate(this.date.getDate()+7);this.setDate(A)},setDate:function(A){this.date=new Date(A.getTime());this.updateUI();this.refresh();if(this.datePicker){this.datePicker.setValue(this.date)}},$click$in2iguiCalendarDatePicker:function(){this.showDatePicker()},refresh:function(){this.clearEvents();this.setBusy(true);var A={"startTime":this.getFirstDay(),"endTime":this.getLastDay()};this.fire("calendarSpanChanged",A);In2iGui.firePropertyChange(this,"startTime",this.getFirstDay());In2iGui.firePropertyChange(this,"endTime",this.getLastDay())},valueForProperty:function(A){if(A=="startTime"){return this.getFirstDay()}if(A=="endTime"){return this.getLastDay()}return this[A]},showDatePicker:function(){if(!this.datePickerPanel){this.datePickerPanel=In2iGui.BoundPanel.create();this.datePicker=In2iGui.DatePicker.create({name:"in2iguiCalendarDatePicker",value:this.date});this.datePicker.listen(this);this.datePickerPanel.add(this.datePicker);this.datePickerPanel.addSpace(3);var A=In2iGui.Button.create({name:"in2iguiCalendarDatePickerClose",text:"Luk",small:true,rounded:true});A.listen(this);this.datePickerPanel.add(A)}this.datePickerPanel.position(this.datePickerButton.getElement());this.datePickerPanel.show()},$click$in2iguiCalendarDatePickerClose:function(){this.datePickerPanel.hide()},$dateChanged$in2iguiCalendarDatePicker:function(A){this.setDate(A)},showEvent:function(B){if(!this.eventViewerPanel){this.eventViewerPanel=In2iGui.BoundPanel.create({width:270,padding:3});this.eventInfo=In2iGui.InfoView.create(null,{height:240,clickObjects:true});this.eventViewerPanel.add(this.eventInfo);this.eventViewerPanel.addSpace(5);var A=In2iGui.Button.create({name:"in2iguiCalendarEventClose",text:"Luk"});A.listen(this);this.eventViewerPanel.add(A)}this.eventInfo.clear();this.eventInfo.setBusy(true);this.eventViewerPanel.position(B);this.eventViewerPanel.show();In2iGui.callDelegates(this,"requestEventInfo");return },updateEventInfo:function(A,B){this.eventInfo.setBusy(false);this.eventInfo.update(B)},click$in2iguiCalendarEventClose:function(){this.hideEventViewer()},hideEventViewer:function(){if(this.eventViewerPanel){this.eventViewerPanel.hide()}}};In2iGui.DatePicker=function(A){this.name=A.name;this.element=n2i.get(A.element);this.options={};n2i.override(this.options,A);this.cells=[];this.title=n2i.firstByTag(this.element,"strong");this.today=new Date();this.value=this.options.value?new Date(this.options.value.getTime()):new Date();this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);In2iGui.extend(this);this.addBehavior();this.updateUI()};In2iGui.DatePicker.create=function(J){var C=J.element=n2i.build("div",{"class":"in2igui_datepicker",html:'<div class="in2igui_datepicker_header"><a class="in2igui_datepicker_next"></a><a class="in2igui_datepicker_previous"></a><strong></strong></div>'}),H=n2i.build("table",{parent:C}),F=n2i.build("thead",{parent:H}),G=n2i.build("tr",{parent:F});for(var D=0;D<7;D++){G.appendChild(n2i.build("th",{text:Date.dayNames[D].substring(0,3)}))}var E=n2i.build("tbody",{parent:H});for(var B=0;B<6;B++){var I=n2i.build("tr",{parent:E});for(var A=0;A<7;A++){n2i.build("td",{parent:I})}}return new In2iGui.DatePicker(J)};In2iGui.DatePicker.prototype={addBehavior:function(){var A=this;this.cells=n2i.firstByClass(this.element,"td");this.each(this.cells,function(D,E){n2i.listen(D,"mousedown",function(){A.selectCell(E)})});var B=n2i.firstByClass(this.element,"in2igui_datepicker_next");var C=n2i.firstByClass(this.element,"in2igui_datepicker_previous");n2i.listen(B,"mousedown",function(){A.next()});n2i.listen(C,"mousedown",function(){A.previous()})},setValue:function(A){this.value=new Date(A.getTime());this.viewDate=new Date(A.getTime());this.viewDate.setDate(1);this.updateUI()},updateUI:function(){this.title.update(this.viewDate.dateFormat("F Y"));var C=this.value.getFullYear()==this.viewDate.getFullYear();var E=this.viewDate.getMonth();for(var D=0;D<this.cells.length;D++){var B=this.indexToDate(D);var A=this.cells[D];if(B.getMonth()<E){A.className="in2igui_datepicker_dimmed"}else{if(B.getMonth()>E){A.className="in2igui_datepicker_dimmed"}else{A.className=""}}if(B.getDate()==this.value.getDate()&&B.getMonth()==this.value.getMonth()&&C){n2i.addClass(A,"in2igui_datepicker_selected")}if(B.getDate()==this.today.getDate()&&B.getMonth()==this.today.getMonth()&&B.getFullYear()==this.today.getFullYear()){n2i.addClass(A,"in2igui_datepicker_today")}n2i.dom.setText(A,B.getDate())}},getPreviousMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()-1);return A},getNextMonth:function(){var A=new Date(this.viewDate.getTime());A.setMonth(A.getMonth()+1);return A},previous:function(){this.viewDate=this.getPreviousMonth();this.updateUI()},next:function(){this.viewDate=this.getNextMonth();this.updateUI()},selectCell:function(A){this.value=this.indexToDate(A);this.viewDate=new Date(this.value.getTime());this.viewDate.setDate(1);this.updateUI();In2iGui.callDelegates(this,"dateChanged",this.value)},indexToDate:function(B){var D=this.viewDate.getDay(),E=this.viewDate.getDaysInMonth(),C=this.getPreviousMonth().getDaysInMonth(),A;if(B<D){A=this.getPreviousMonth();A.setDate(C-D+B+1)}else{if(B>D+E-1){A=this.getPreviousMonth();A.setDate(B-D-E+1)}else{A=new Date(this.viewDate.getTime());A.setDate(B+1-D)}}return A}};Date.monthNames=["Januar","Februar","Marts","April","Maj","Juni","Juli","August","September","Oktober","November","December"];Date.dayNames=["Sndag","Mandag","Tirsdag","Onsdag","Torsdag","Fredag","Lrdag"];In2iGui.Layout=function(A){this.name=A.name;this.options=A||{};this.element=n2i.get(A.element);In2iGui.extend(this)};In2iGui.Layout.prototype={$$layout:function(){if(n2i.browser.gecko){n2i.firstByClass(this.element,"in2igui_layout_center").style.height="100%"}if(!n2i.browser.msie7&&!n2i.browser.msie8&&!n2i.browser.msie9){return }if(this.diff===undefined){var E=n2i.firstByClass(this.element,"in2igui_layout_top");var F=n2i.firstByTag(E,"*").clientHeight;var D=n2i.firstByTag(n2i.firstByTag(this.element,"tfoot"),"td");var B=0;if(D){B=n2i.firstByTag(D,"*").clientHeight}F+=n2i.getTop(this.element);this.diff=B+F;if(this.element.parentNode!==document.body){this.diff+=15}else{}}var C=n2i.firstByTag(this.element,"tbody");var A=n2i.firstByTag(C,"td");A.style.height=(n2i.getViewPortHeight()-this.diff+5)+"px"}};In2iGui.Columns=function(A){this.name=A.name;this.options=A||{};this.element=n2i.get(A.element);this.body=n2i.firstByTag(this.element,"tr");In2iGui.extend(this)};In2iGui.Columns.create=function(A){A=A||{};A.element=n2i.build("table",{"class":"in2igui_columns",html:"<tbody><tr></tr></tbody>"});return new In2iGui.Columns(A)};In2iGui.Columns.prototype={addToColumn:function(A,B){var C=this.ensureColumn(A);C.appendChild(B.getElement())},setColumnStyle:function(A,B){var C=this.ensureColumn(A);n2i.setStyle(C,B)},setColumnWidth:function(A,B){var C=this.ensureColumn(A);C.style.width=B+"px"},ensureColumn:function(A){var C=n2i.getChildren(this.body);for(var B=C.length-1;B<A;B++){this.body.appendChild(n2i.build("td",{"class":"in2igui_columns_column"}))}return n2i.getChildren(this.body)[A]}};In2iGui.Dock=function(A){this.options=A;this.element=n2i.get(A.element);this.iframe=n2i.firstByTag(this.element,"iframe");this.progress=n2i.firstByClass(this.element,"in2igui_dock_progress");n2i.listen(this.iframe,"load",this._load.bind(this));this.name=A.name;In2iGui.extend(this);this.diff=-69;if(this.options.tabs){this.diff-=15}this.busy=true};In2iGui.Dock.prototype={setUrl:function(A){this._setBusy(true);n2i.getFrameDocument(this.iframe).location.href=A},_load:function(){this._setBusy(false)},_setBusy:function(A){if(A){n2i.setStyle(this.progress,{display:"block",height:this.iframe.clientHeight})}else{this.progress.style.display="none"}},$$layout:function(){var A=n2i.getViewPortHeight();this.iframe.style.height=(A+this.diff)+"px";this.progress.style.height=(A+this.diff)+"px"}};In2iGui.Box=function(A){this.options=n2i.override({},A);this.name=A.name;this.element=n2i.get(A.element);this.body=n2i.firstByClass(this.element,"in2igui_box_body");this.close=n2i.firstByClass(this.element,"in2igui_box_close");if(this.close){n2i.listen(this.close,"click",function(B){n2i.stop(B);this.hide();this.fire("boxWasClosed")}.bind(this))}In2iGui.extend(this)};In2iGui.Box.create=function(A){A=A||{};A.element=n2i.build("div",{"class":A.absolute?"in2igui_box in2igui_box_absolute":"in2igui_box",html:(A.closable?'<a class="in2igui_box_close" href="#"></a>':"")+'<div class="in2igui_box_top"><div><div></div></div></div><div class="in2igui_box_middle"><div class="in2igui_box_middle">'+(A.title?'<div class="in2igui_box_header"><strong class="in2igui_box_title">'+n2i.escape(A.title)+"</strong></div>":"")+'<div class="in2igui_box_body" style="'+(A.padding?"padding: "+A.padding+"px;":"")+(A.width?"width: "+A.width+"px;":"")+'"></div></div></div><div class="in2igui_box_bottom"><div><div></div></div></div>',style:A.width?A.width+"px":null});return new In2iGui.Box(A)};In2iGui.Box.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(A){if(A.getElement){this.body.appendChild(A.getElement())}else{this.body.appendChild(A)}},show:function(){var D=this.element;if(this.options.modal){var B=In2iGui.nextPanelIndex();D.style.zIndex=B+1;In2iGui.showCurtain({widget:this,zIndex:B})}if(this.options.absolute){n2i.setStyle(D,{display:"block",visibility:"hidden"});var A=D.clientWidth;var C=(n2i.getViewPortHeight()-D.clientHeight)/2+n2i.getScrollTop();n2i.setStyle(D,{"marginLeft":(A/-2)+"px",top:C+"px"});n2i.setStyle(D,{display:"block",visibility:"visible"})}else{D.style.display="block"}In2iGui.callVisible(this)},hide:function(){In2iGui.hideCurtain(this);this.element.style.display="none"},curtainWasClicked:function(){this.fire("boxCurtainWasClicked")}};In2iGui.Wizard=function(A){this.options=A||{};this.element=n2i.get(A.element);this.name=A.name;this.container=n2i.firstByClass(this.element,"in2igui_wizard_steps");this.steps=n2i.byClass(this.element,"in2igui_wizard_step");this.anchors=n2i.byClass(this.element,"in2igui_wizard_selection");this.selected=0;In2iGui.extend(this);this.addBehavior()};In2iGui.Wizard.prototype={addBehavior:function(){var A=this;n2i.each(this.anchors,function(C,B){n2i.listen(C,"mousedown",function(D){n2i.stop(D);A.goToStep(B)});n2i.listen(C,"click",function(D){n2i.stop(D)})})},goToStep:function(A){var B=this.container;B.style.height=B.clientHeight+"px";n2i.removeClass(this.anchors[this.selected],"in2igui_selected");this.steps[this.selected].style.display="none";n2i.addClass(this.anchors[A],"in2igui_selected");this.steps[A].style.display="block";this.selected=A;n2i.ani(B,"height",this.steps[A].clientHeight+"px",500,{ease:n2i.ease.slowFastSlow,onComplete:function(){B.style.height=""}});In2iGui.callVisible(this)},next:function(){if(this.selected<this.steps.length-1){this.goToStep(this.selected+1)}},previous:function(){if(this.selected>0){this.goToStep(this.selected-1)}}};In2iGui.Articles=function(A){this.options=A;this.name=A.name;this.element=n2i.get(A.element);if(A.source){A.source.listen(this)}};In2iGui.Articles.prototype={$articlesLoaded:function(H){this.element.innerHTML="";var G=H.getElementsByTagName("article");for(var C=0;C<G.length;C++){var D=n2i.build("div",{"class":"in2igui_article"});var E=G[C].childNodes;for(var B=0;B<E.length;B++){if(n2i.dom.isElement(E[B],"title")){var F=n2i.dom.getText(E[B]);D.appendChild(n2i.build("h2",{text:F}))}else{if(n2i.dom.isElement(E[B],"paragraph")){var I=n2i.dom.getText(E[B]);var A=n2i.build("p",{text:I});if(E[B].getAttribute("dimmed")==="true"){A.className="in2igui_dimmed"}D.appendChild(A)}}}this.element.appendChild(D)}},$sourceFailed:function(){this.element.innerHTML="<div>Failed!</div>"},$sourceIsBusy:function(){this.element.innerHTML='<div class="in2igui_articles_loading">Loading...</div>'},$sourceIsNotBusy:function(){n2i.removeClass(this.element,"in2igui_list_busy")}};In2iGui.TextField=function(A){this.options=n2i.override({placeholderElement:null,validator:null},A);var B=this.element=n2i.get(A.element);this.element.setAttribute("autocomplete","off");this.value=this.validate(this.element.value);this.isPassword=this.element.type=="password";this.name=A.name;In2iGui.extend(this);this.addBehavior();if(this.options.placeholderElement&&this.value!=""){In2iGui.fadeOut(this.options.placeholderElement,0)}this.checkPlaceholder();try{if(B==document.activeElement){this.focused()}}catch(B){}};In2iGui.TextField.prototype={addBehavior:function(){var B=this.element;n2i.listen(B,"keyup",this.keyDidStrike.bind(this));var A=this.options.placeholderElement;n2i.listen(B,"blur",this.onBlur.bind(this));if(A){n2i.listen(B,"focus",this.focused.bind(this));n2i.listen(B,"blur",this.checkPlaceholder.bind(this));if(A){A.style.cursor="text";n2i.listen(A,"mousedown",this.focus.bind(this));n2i.listen(A,"click",this.focus.bind(this))}}},focused:function(){var B=this.element,A=this.options.placeholderElement;if(A&&B.value==""){In2iGui.fadeOut(A,0)}},validate:function(C){var B=this.options.validator,A;if(B){A=B.validate(C);n2i.setClass(this.element,"in2igui_invalid",!A.valid);return A.value}return C},checkPlaceholder:function(){if(this.options.placeholderElement&&this.value==""){In2iGui.fadeIn(this.options.placeholderElement,200)}if(this.isPassword&&!n2i.browser.msie){this.element.type="password"}},keyDidStrike:function(){if(this.value!==this.element.value){var A=this.validate(this.element.value);var B=A!==this.value;this.value=A;if(B){this.fire("valueChanged",this.value)}}},onBlur:function(){n2i.removeClass(this.element,"in2igui_invalid");this.element.value=this.value||""},getValue:function(){return this.value},setValue:function(A){if(A===undefined||A===null){A=""}this.element.value=A;this.value=this.validate(A)},isEmpty:function(){return this.value==""},isBlank:function(){return this.value.strip()==""},focus:function(){this.element.focus()},setError:function(A){var B=A?true:false;n2i.setClass(this.element,"in2igui_field_error",B);if(typeof (A)=="string"){In2iGui.showToolTip({text:A,element:this.element,key:this.name})}if(!B){In2iGui.hideToolTip({key:this.name})}}};In2iGui.InfoView=function(A){this.options=n2i.override({clickObjects:false},A);this.element=n2i.get(A.element);this.body=this.element.select("tbody")[0];this.name=A.name;In2iGui.extend(this)};In2iGui.InfoView.create=function(A){A=A||{};var B=A.element=n2i.build("div",{"class":"in2igui_infoview",html:"<table><tbody></tbody></table>"});if(A.height){n2i.setStyle(B,{height:A.height+"px","overflow":"auto","overflowX":"hidden"})}if(A.margin){B.style.margin=A.margin+"px"}return new In2iGui.InfoView(A)};In2iGui.InfoView.prototype={addHeader:function(B){var A=n2i.build("tr",{parent:this.body});n2i.build("th",{"class":"in2igui_infoview_header",colspan:"2",text:B,parent:A})},addProperty:function(A,C){var B=n2i.build("tr",{parent:this.body});n2i.build("th",{parent:B,text:A});n2i.build("td",{parent:B,text:C})},addObjects:function(B,D){if(!D||D.length==0){return }var E=n2i.build("tr",{parent:this.body});E.appendChild(n2i.build("th",{text:B}));var A=n2i.build("td",{parent:E});var C=this.options.clickObjects;n2i.each(D,function(G){var F=n2i.build("div",{text:G.title,parent:A});if(C){n2i.addClass(F,"in2igui_infoview_click");n2i.listen(F,"click",function(){In2iGui.callDelegates(this,"objectWasClicked",G)})}})},setBusy:function(A){n2i.setClass(this,element,"in2igui_infoview_busy",A)},clear:function(){n2i.dom.clear(this.body)},update:function(B){this.clear();for(var A=0;A<B.length;A++){switch(B[A].type){case"header":this.addHeader(B[A].value);break;case"property":this.addProperty(B[A].label,B[A].value);break;case"objects":this.addObjects(B[A].label,B[A].value);break}}}};In2iGui.Overflow=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this)};In2iGui.Overflow.create=function(A){A=A||{};var B=A.element=n2i.build("div",{"class":"in2igui_overflow"});if(A.height){B.style.height=A.height+"px"}return new In2iGui.Overflow(A)};In2iGui.Overflow.prototype={calculate:function(){var F,B,D,A;A=n2i.getViewPortHeight();D=this.element.parentNode;F=n2i.getTop(this.element);B=n2i.getTop(D)+D.clientHeight;var E=n2i.getAllNext(this.element);for(var C=0;C<E.length;C++){B-=E[C].clientHeight}this.diff=-1*(F+(A-B));if(n2i.browser.webkit){this.diff++}},add:function(A){if(A.getElement){this.element.appendChild(A.getElement())}else{this.element.appendChild(A)}return this},$$layout:function(){var A;if(!this.options.dynamic){if(this.options.vertical){A=n2i.getViewPortHeight();this.element.style.height=Math.max(0,A-this.options.vertical)+"px"}return }if(this.diff===undefined){this.calculate()}A=n2i.getViewPortHeight();this.element.style.height=Math.max(0,A+this.diff)+"px"}};In2iGui.SearchField=function(A){this.options=n2i.override({expandedWidth:null},A);this.element=n2i.get(A.element);this.name=A.name;this.field=n2i.firstByTag(this.element,"input");this.value=this.field.value;this.adaptive=n2i.hasClass(this.element,"in2igui_searchfield_adaptive");In2iGui.onDomReady(function(){this.initialWidth=parseInt(n2i.getStyle(this.element,"width"))}.bind(this));In2iGui.extend(this);this.addBehavior();this.updateClass()};In2iGui.SearchField.create=function(A){A=A||{};A.element=n2i.build("span",{"class":A.adaptive?"in2igui_searchfield in2igui_searchfield_adaptive":"in2igui_searchfield",html:'<em class="in2igui_searchfield_placeholder"></em><a href="javascript:void(0);" class="in2igui_searchfield_reset"></a><span><span><input type="text"/></span></span>'});return new In2iGui.SearchField(A)};In2iGui.SearchField.prototype={addBehavior:function(){var B=this;n2i.listen(this.field,"keyup",this.onKeyUp.bind(this));var C=n2i.firstByTag(this.element,"a");C.tabIndex=-1;var A=function(){B.field.focus();B.field.select()};n2i.listen(this.element,"mousedown",A);n2i.listen(this.element,"mouseup",A);n2i.listen(C,"mousedown",function(D){n2i.stop(D);B.reset();A()});n2i.listen(n2i.firstByTag(this.element,"em"),"mousedown",A);n2i.listen(this.field,"focus",function(){B.focused=true;B.updateClass()});n2i.listen(this.field,"blur",function(){B.focused=false;B.updateClass()});if(this.options.expandedWidth>0){this.field.onfocus=function(){n2i.ani(B.element,"width",B.options.expandedWidth+"px",500,{ease:n2i.ease.slowFastSlow})};this.field.onblur=function(){n2i.ani(B.element,"width",B.initialWidth+"px",500,{ease:n2i.ease.slowFastSlow,delay:100})}}},onKeyUp:function(A){this.fieldChanged();if(A.keyCode===Event.KEY_RETURN){this.fire("submit")}},setValue:function(A){this.field.value=A===undefined||A===null?"":A;this.fieldChanged()},getValue:function(){return this.field.value},isEmpty:function(){return this.field.value==""},isBlank:function(){return this.field.value.strip()==""},reset:function(){this.field.value="";this.fieldChanged()},updateClass:function(){var A="in2igui_searchfield";if(this.adaptive){A+=" in2igui_searchfield_adaptive"}if(this.focused&&this.value!=""){A+=" in2igui_searchfield_focus_dirty"}else{if(this.focused){A+=" in2igui_searchfield_focus"}else{if(this.value!=""){A+=" in2igui_searchfield_dirty"}}}this.element.className=A},fieldChanged:function(){if(this.field.value!=this.value){this.value=this.field.value;this.updateClass();this.fire("valueChanged",this.value);In2iGui.firePropertyChange(this,"value",this.value)}}};In2iGui.Fragment=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this)};In2iGui.Fragment.prototype={show:function(){this.element.style.display="block"},hide:function(){this.element.style.display="none"}};In2iGui.LocationPicker=function(A){A=A||{};this.name=A.name;this.options=A.options||{};this.element=n2i.get(A.element);this.defaultCenter=new google.maps.LatLng(57.0465,9.9185);In2iGui.extend(this)};In2iGui.LocationPicker.prototype={show:function(C){if(!this.panel){var A=this.panel=In2iGui.BoundPanel.create({width:300});var F=n2i.build("div",{style:"width:300px;height:300px"});A.add(F);var E=In2iGui.Buttons.create({align:"right",top:5});var D=In2iGui.Button.create({text:"Luk"});D.listen({$click:function(){A.hide()}});A.add(E.add(D));n2i.setStyle(A.element,{left:"-10000px",top:"-10000px",display:""});var B={zoom:15,mapTypeId:google.maps.MapTypeId.TERRAIN};this.map=new google.maps.Map(F,B);google.maps.event.addListener(this.map,"click",function(G){var H={latitude:G.latLng.lat(),longitude:G.latLng.lng()};this.setLocation(H);this.fire("locationChanged",H)}.bind(this));A.element.style.display="none"}this.setLocation(C.location);if(C.node){this.panel.position(C.node)}this.panel.show()},setLocation:function(A){if(!A&&this.marker){this.marker.setMap(null);this.map.setCenter(this.defaultCenter);return }A=this.buildLatLng(A);if(!this.marker){this.marker=new google.maps.Marker({position:A,map:this.map})}else{this.marker.setPosition(A);this.marker.setMap(this.map)}this.map.setCenter(A)},buildLatLng:function(A){if(!A){A={latitude:57.0465,longitude:9.9185}}return new google.maps.LatLng(A.latitude,A.longitude)}};In2iGui.Bar=function(A){this.options=n2i.override({},A);this.name=A.name;this.element=n2i.get(A.element);In2iGui.extend(this)};In2iGui.Bar.create=function(B){B=B||{};var A="in2igui_bar";if(B.variant){A+=" in2igui_bar_"+B.variant}if(B.absolute){A+=" in2igui_bar_absolute"}B.element=n2i.build("div",{"class":A});n2i.build("div",{"class":"in2igui_bar_body",parent:B.element});return new In2iGui.Bar(B)};In2iGui.Bar.prototype={addToDocument:function(){document.body.appendChild(this.element)},add:function(B){var A=n2i.firstByClass(this.element,"in2igui_bar_body");A.appendChild(B.getElement())},placeAbove:function(A){n2i.place({source:{element:this.element,vertical:1,horizontal:0},target:{element:A.getElement(),vertical:0,horizontal:0}});this.element.style.zIndex=In2iGui.nextTopIndex()},show:function(){this.element.style.visibility="visible"},hide:function(){this.element.style.visibility="hidden"}};In2iGui.Bar.Button=function(A){this.options=n2i.override({},A);this.name=A.name;this.element=n2i.get(A.element);n2i.listen(this.element,"click",this._click.bind(this));n2i.listen(this.element,"mousedown",this._mousedown.bind(this));n2i.listen(this.element,"mouseup",function(B){n2i.stop(B)});In2iGui.extend(this)};In2iGui.Bar.Button.create=function(A){A=A||{};var B=A.element=n2i.build("a",{"class":"in2igui_bar_button"});if(A.icon){B.appendChild(In2iGui.createIcon(A.icon,1))}return new In2iGui.Bar.Button(A)};In2iGui.Bar.Button.prototype={_mousedown:function(A){this.fire("mousedown");if(this.options.stopEvents){n2i.stop(A)}},_click:function(A){this.fire("click");if(this.options.stopEvents){n2i.stop(A)}},setSelected:function(A){n2i.setClass(this.element,"in2igui_bar_button_selected",A)}};In2iGui.IFrame=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this)};In2iGui.IFrame.prototype={setUrl:function(A){this.element.setAttribute("src",A)},getDocument:function(){return n2i.getFrameDocument(this.element)},getWindow:function(){return n2i.getFrameWindow(this.element)},reload:function(){this.getWindow().location.reload()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"}};In2iGui.VideoPlayer=function(A){this.options=A;this.element=n2i.get(A.element);this.placeholder=n2i.firstByTag(this.element,"div");this.name=A.name;this.state={duration:0,time:0,loaded:0};this.handlers=[In2iGui.VideoPlayer.HTML5,In2iGui.VideoPlayer.QuickTime,In2iGui.VideoPlayer.Embedded];this.handler=null;In2iGui.extend(this);if(this.options.video){if(this.placeholder){n2i.listen(this.placeholder,"click",function(){this.setVideo(this.options.video)}.bind(this))}else{In2iGui.onReady(function(){this.setVideo(this.options.video)}.bind(this))}}};In2iGui.VideoPlayer.prototype={setVideo:function(A){if(this.placeholder){this.placeholder.style.display="none"}this.handler=this.getHandler(A);this.element.appendChild(this.handler.element);if(this.handler.showController()){this.buildController()}},getHandler:function(C){for(var A=0;A<this.handlers.length;A++){var B=this.handlers[A];if(B.isSupported(C)){return new B(C,this)}}},buildController:function(){var A=n2i.build("div",{"class":"in2igui_videoplayer_controller",parent:this.element});this.playButton=n2i.build("a",{href:"javascript:void(0);","class":"in2igui_videoplayer_playpause",text:"wait!",parent:A});n2i.listen(this.playButton,"click",this.playPause.bind(this));this.status=n2i.build("span",{"class":"in2igui_videoplayer_status",parent:A})},onCanPlay:function(){this.playButton.update("Play")},onLoad:function(){this.state.loaded=this.state.duration;this.updateStatus()},onDurationChange:function(A){this.state.duration=A;this.updateStatus()},onTimeChange:function(A){this.state.time=A;this.updateStatus()},onLoadProgressChange:function(A){this.state.loaded=A;this.updateStatus()},playPause:function(){if(this.handler.isPlaying()){this.pause()}else{this.play()}},play:function(){this.handler.play()},pause:function(){this.handler.pause()},updateStatus:function(){this.status.innerHTML=this.state.time+" / "+this.state.duration+" / "+this.state.loaded}};In2iGui.VideoPlayer.HTML5=function(B,A){var C=this.element=n2i.build("video",{width:B.width,height:B.height,src:B.src});n2i.listen(C,"load",A.onLoad.bind(A));n2i.listen(C,"canplay",A.onCanPlay.bind(A));n2i.listen(C,"durationchange",function(D){A.onDurationChange(C.duration)});n2i.listen(C,"timeupdate",function(){A.onTimeChange(this.element.currentTime)}.bind(this))};In2iGui.VideoPlayer.HTML5.isSupported=function(A){if(n2i.browser.webkitVersion>528&&(A.type==="video/quicktime"||A.type==="video/mp4")){return true}return false};In2iGui.VideoPlayer.HTML5.prototype={showController:function(){return true},pause:function(){this.element.pause()},play:function(){this.element.play()},getTime:function(){return this.element.currentTime},isPlaying:function(){return !this.element.paused}};In2iGui.VideoPlayer.QuickTime=function(B,A){this.player=A;var C=this.element=n2i.build("object",{width:B.width,height:B.height,data:B.src,type:"video/quicktime"});C.innerHTML='<param value="false" name="controller"/><param value="true" name="enablejavascript"/><param value="undefined" name="posterframe"/><param value="false" name="showlogo"/><param value="false" name="autostart"/><param value="true" name="cache"/><param value="white" name="bgcolor"/><param value="false" name="aggressivecleanup"/><param value="true" name="saveembedtags"/><param value="true" name="postdomevents"/>';n2i.listen(C,"qt_canplay",A.onCanPlay.bind(A));n2i.listen(C,"qt_load",A.onLoad.bind(A));n2i.listen(C,"qt_progress",function(){A.onLoadProgressChange(C.GetMaxTimeLoaded()/3000)});n2i.listen(C,"qt_durationchange",function(D){A.onDurationChange(C.GetDuration()/3000)});n2i.listen(C,"qt_timechanged",function(){A.onTimeChange(C.GetTime())})};In2iGui.VideoPlayer.QuickTime.isSupported=function(A){return A.html==undefined};In2iGui.VideoPlayer.QuickTime.prototype={showController:function(){return true},pause:function(){window.clearInterval(this.observer);this.element.Stop()},play:function(){this.element.Play();this.observer=window.setInterval(this.observeVideo.bind(this),100)},observeVideo:function(){this.player.onTimeChange(this.element.GetTime()/3000)},getTime:function(){return this.element.GetTime()},isPlaying:function(){return this.element.GetRate()!==0}};In2iGui.VideoPlayer.Embedded=function(B,A){this.element=n2i.build("div",{width:B.width,height:B.height,html:B.html})};In2iGui.VideoPlayer.Embedded.isSupported=function(A){return A.html!==undefined};In2iGui.VideoPlayer.Embedded.prototype={showController:function(){return false},pause:function(){},play:function(){},getTime:function(){},isPlaying:function(){}};In2iGui.Segmented=function(A){this.options=n2i.override({value:null,allowNull:false},A);this.element=n2i.get(A.element);this.name=A.name;this.value=this.options.value;In2iGui.extend(this);n2i.listen(this.element,"mousedown",this.onClick.bind(this))};In2iGui.Segmented.prototype={onClick:function(E){E=new n2i.Event(E);var B=E.findByTag("a");if(B){var F=false;var D=B.getAttribute("rel");var A=n2i.byClass(this.element,"in2igui_segmented_selected");for(var C=0;C<A.length;C++){n2i.removeClass(A[C],"in2igui_segmented_selected")}if(D===this.value&&this.options.allowNull){F=true;this.value=null;this.fire("valueChanged",this.value)}else{n2i.addClass(B,"in2igui_segmented_selected");F=this.value!==D;this.value=D}if(F){this.fire("valueChanged",this.value)}}},setValue:function(C){if(C===undefined){C=null}var A=this.element.getElementsByTagName("a");this.value=null;for(var B=0;B<A.length;B++){if(A[B].getAttribute("rel")===C){n2i.addClass(A[B],"in2igui_segmented_selected");this.value=C}else{n2i.removeClass(A[B],"in2igui_segmented_selected")}}},getValue:function(){return this.value}};In2iGui.Flash={fullVersion:undefined,getMajorVersion:function(){var B=this.getFullVersion();if(B===null||B===undefined){return null}var A=(B+"").match(/[0-9]+/gi);return A.length>0?parseInt(A[0]):null},getFullVersion:function(){if(this.fullVersion!==undefined){return this.fullVersion}var G=null;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];var D=E[3];if(D==""){D=E[4]}if(D[0]=="d"){D=D.substring(1)}else{if(D[0]=="r"){D=D.substring(1);if(D.indexOf("d")>0){D=D.substring(0,D.indexOf("d"))}}}G=H+"."+B+"."+D}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2}else{if(n2i.browser.msie){G=this.getActiveXVersion()}}}}}this.fullVersion=G;return G},getActiveXVersion:function(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version")}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version")}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0"}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11"}catch(C){A=-1}}return A}};In2iGui.Link=function(A){this.options=A;this.name=A.name;this.element=n2i.get(A.element);In2iGui.extend(this);this.addBehavior()};In2iGui.Link.prototype={addBehavior:function(){var A=this;n2i.listen(this.element,"click",function(B){n2i.stop(B);window.setTimeout(function(){A.fire("click")})})}};In2iGui.Links=function(A){this.options=A;this.element=n2i.get(A.element);this.name=A.name;In2iGui.extend(this);this.items=[];this.addBehavior();this.selectedIndex=null;this.inputs={}};In2iGui.Links.prototype={addBehavior:function(){n2i.listen(this.element,"click",this.onClick.bind(this));n2i.listen(this.element,"dblclick",this.onDblClick.bind(this))},reset:function(){this.setValue([])},setValue:function(A){this.items=A;this.selectedIndex=null;this.build()},getValue:function(){return this.items},onDblClick:function(D){D=new n2i.Event(D);n2i.selection.clear();D.stop(D);var B=this.selectAndGetRow(D);var A={text:B.text};A[B.kind]=B.value;this.editedLink=B;var C=this.getEditWindow();this.editForm.reset();this.editForm.setValues(A);C.show()},onClick:function(B){B=new n2i.Event(B);B.stop();var A=B.getElement();if(n2i.hasClass(A,"in2igui_links_remove")){var C=B.findByClass("in2igui_links_row");In2iGui.confirmOverlay({element:A,text:"Vil du fjerne linket?",okText:"Ja, fjern",cancelText:"Annuller",onOk:function(){this.items.splice(C.in2igui_index,1);if(this.selectedIndex===C.in2igui_index){this.selectedIndex=null}this.build()}.bind(this)})}else{this.selectAndGetRow(B)}},selectAndGetRow:function(C){var D=C.findByClass("in2igui_links_row");if(D){var B=D.in2igui_index;if(this.selectedIndex!==null){var A=n2i.byClass(this.element,"in2igui_links_row")[this.selectedIndex];n2i.removeClass(A,"in2igui_links_row_selected")}this.selectedIndex=B;n2i.addClass(D,"in2igui_links_row_selected");return this.items[B]}},build:function(){var E=this.list||n2i.firstByClass(this.element,"in2igui_links_list"),B,D,G,C,F,A;E.innerHTML="";for(B=0;B<this.items.length;B++){D=this.items[B];G=n2i.build("div",{"class":"in2igui_links_row"});G.in2igui_index=B;G.appendChild(In2iGui.createIcon(D.icon,1));F=n2i.build("div",{"class":"in2igui_links_text",text:D.text});G.appendChild(F);C=n2i.build("div",{"class":"in2igui_links_info",text:n2i.wrap(D.info)});G.appendChild(C);A=In2iGui.createIcon("monochrome/round_x",1);n2i.addClass(A,"in2igui_links_remove");G.appendChild(A);E.appendChild(G)}},addLink:function(){this.editedLink=null;this.getEditWindow().show();this.editForm.reset();this.editForm.focus()},getEditWindow:function(){if(!this.editWindow){var F=this.editWindow=In2iGui.Window.create({title:"Link",width:300,padding:5});var E=this.editForm=In2iGui.Formula.create();var D=E.buildGroup({above:false},[{type:"Text",options:{label:"Tekst",key:"text"}}]);var C=In2iGui.Formula.Text.create({label:"URL",key:"url"});D.add(C);this.inputs["url"]=C;var B=In2iGui.Formula.Text.create({label:"E-mail",key:"email"});D.add(B);this.inputs["email"]=B;page=In2iGui.Formula.DropDown.create({label:"Side",key:"page",source:this.options.pageSource});D.add(page);this.inputs["page"]=page;file=In2iGui.Formula.DropDown.create({label:"Fil",key:"file",source:this.options.fileSource});D.add(file);this.inputs["file"]=file;var A=this;n2i.each(this.inputs,function(G,H){H.listen({$valueChanged:function(){A.changeType(G)}})});D.createButtons().add(In2iGui.Button.create({text:"Gem",submit:true,highlighted:true}));this.editForm.listen({$submit:this.saveLink.bind(this)});F.add(E);if(this.options.pageSource){this.options.pageSource.refresh()}if(this.options.fileSource){this.options.fileSource.refresh()}}return this.editWindow},saveLink:function(){var A=this.editForm.getValues();var B=this.valuesToLink(A);var C=this.editedLink;if(C){n2i.override(C,B)}else{this.items.push(B)}this.build();this.editForm.reset();this.editWindow.hide();this.editedLink=null},valuesToLink:function(A){var B={};B.text=A.text;if(A.email!=""){B.kind="email";B.value=A.email;B.info=A.email;B.icon="monochrome/email"}else{if(A.url!=""){B.kind="url";B.value=A.url;B.info=A.url;B.icon="monochrome/globe"}else{if(n2i.isDefined(A.page)){B.kind="page";B.value=A.page;B.info=this.inputs["page"].getItem().title;B.icon="common/page"}else{if(n2i.isDefined(A.file)){B.kind="file";B.value=A.file;B.info=this.inputs["file"].getItem().title;B.icon="monochrome/file"}}}}return B},changeType:function(A){n2i.each(this.inputs,function(B,C){if(B!=A){C.setValue()}})}};In2iGui.MarkupEditor=function(A){this.name=A.name;this.options=n2i.override({debug:false,value:"",autoHideToolbar:true,style:"font-family: sans-serif; font-size: 11px;"},A);if(A.replace){A.replace=n2i.get(A.replace);A.element=n2i.build("div",{className:"in2igui_markupeditor"});A.replace.parentNode.insertBefore(A.element,A.replace);A.replace.style.display="none";A.value=A.replace.innerHTML}this.ready=false;this.pending=[];this.element=n2i.get(A.element);if(n2i.browser.msie){this.impl=In2iGui.MarkupEditor.MSIE}else{this.impl=In2iGui.MarkupEditor.webkit}this.impl.initialize({element:this.element,controller:this});if(this.options.value){this.setValue(this.options.value)}In2iGui.extend(this)};In2iGui.MarkupEditor.create=function(A){A=A||{};A.element=n2i.build("div",{className:"in2igui_markupeditor"});return new In2iGui.MarkupEditor(A)};In2iGui.MarkupEditor.prototype={implIsReady:function(){this.ready=true;n2i.log("I am ready!");for(var A=0;A<this.pending.length;A++){n2i.log(this.pending[A]);this.pending[A]()}},implFocused:function(){this._showBar()},implBlurred:function(){this.bar.hide();this.fire("blur")},implValueChanged:function(){this._valueChanged()},destroy:function(){n2i.dom.remove(this.element);In2iGui.destroy(this)},getValue:function(){return this.impl.getHTML()},setValue:function(A){this._whenReady(function(){this.impl.setHTML(A)}.bind(this))},focus:function(){this._whenReady(this.impl.focus.bind(this.impl))},_whenReady:function(A){if(this.ready){A()}else{this.pending.push(A)}},_showBar:function(){if(!this.bar){var A=[{key:"bold",icon:"edit/text_bold"},{key:"italic",icon:"edit/text_italic"},{key:"color",icon:"common/color"},{key:"addLink",icon:"common/link"},{key:"align",value:"left",icon:"edit/text_align_left"},{key:"align",value:"center",icon:"edit/text_align_center"},{key:"align",value:"right",icon:"edit/text_align_right"},{key:"align",value:"justify",icon:"edit/text_align_justify"},{key:"clear",icon:"edit/clear"}];this.bar=In2iGui.Bar.create({absolute:true,variant:"mini",small:true});n2i.each(A,function(C){var B=new In2iGui.Bar.Button.create({icon:C.icon,stopEvents:true});B.listen({$mousedown:function(){this._buttonClicked(C)}.bind(this)});this.bar.add(B)}.bind(this));this.bar.addToDocument()}this.bar.placeAbove(this);this.bar.show()},_buttonClicked:function(A){this.impl.saveSelection();if(A.key=="color"){this._showColorPicker()}else{if(A.key=="addLink"){this._showLinkEditor()}else{if(A.key=="align"){this.impl.align(A.value)}else{if(A.key=="clear"){this.impl.removeFormat()}else{this.impl.format(A)}}}}this._valueChanged();this.impl.restoreSelection()},_showColorPicker:function(){if(!this.colorPicker){this.colorPicker=In2iGui.Window.create();var A=In2iGui.ColorPicker.create();A.listen(this);this.colorPicker.add(A);this.colorPicker.listen({$userClosedWindow:function(){this.impl.restoreSelection()}.bind(this)})}this.colorPicker.show({avoid:this.element})},_showLinkEditor:function(){if(!this.linkEditor){this.linkEditor=In2iGui.Window.create({padding:5,width:300});this.linkForm=In2iGui.Formula.create();this.linkEditor.add(this.linkForm);var C=this.linkForm.buildGroup({},[{type:"Text",options:{key:"url",label:"Address:"}}]);this.linkEditor.add(this.linkForm);var B=C.createButtons();var A=In2iGui.Button.create({text:"OK",submit:true});this.linkForm.listen({$submit:this._updateLink.bind(this)});B.add(A)}this.temporaryLink=this.impl.getOrCreateLink();this.linkForm.setValues({url:this.temporaryLink.href});this.linkEditor.show({avoid:this.element});this.linkForm.focus()},_updateLink:function(){var A=this.linkForm.getValues();this.temporaryLink.href=A.url;this.linkForm.reset();this.temporaryLink=null;this.linkEditor.hide();this._valueChanged()},_valueChanged:function(){this.fire("valueChanged",this.impl.getHTML())},$colorWasSelected:function(A){this.impl.restoreSelection(function(){this.impl.colorize(A);this._valueChanged()}.bind(this))}};In2iGui.MarkupEditor.webkit={initialize:function(A){this.element=A.element;this.element.style.overflow="auto";this.element.contentEditable=true;var B=this.controller=A.controller;n2i.listen(this.element,"focus",function(){B.implFocused()});n2i.listen(this.element,"blur",function(){B.implBlurred()});n2i.listen(this.element,"keyup",this._keyUp.bind(this));B.implIsReady()},saveSelection:function(){},restoreSelection:function(A){if(A){A()}},focus:function(){this.element.focus()},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{document.execCommand(A.key,null,A.value)}}},getOrCreateLink:function(){var A=this._getSelectedNode();if(A&&A.tagName.toLowerCase()=="a"){return A}document.execCommand("createLink",null,"#");return this._getSelectedNode()},_getSelectedNode:function(){var C=window.getSelection();var A=C.getRangeAt(0);var B=A.commonAncestorContainer;if(!n2i.dom.isElement(B)){B=B.parentNode}return B},colorize:function(A){document.execCommand("forecolor",null,A)},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};document.execCommand(A[B],null,null)},_keyUp:function(){this.controller.implValueChanged();this._selectionChanged()},_wrapInTag:function(A){var D=window.getSelection();if(D.rangeCount<1){return }var B=D.getRangeAt(0);var C=B.commonAncestorContainer;if(!n2i.dom.isElement(C)){C=C.parentNode}if(C.tagName.toLowerCase()==A){this._unWrap(C)}else{var E=document.createElement(A);B.surroundContents(E);D.selectAllChildren(E)}},_getInlineTag:function(){var A=window.getSelection();if(A.rangeCount<1){return }},_unWrap:function(B){var C=B.childNodes;for(var A=0;A<C.length;A++){B.parentNode.insertBefore(C[A],B)}B.parentNode.removeChild(B)},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},_selectionChanged:function(){n2i.log({bold:document.queryCommandState("bold"),italic:document.queryCommandState("italic")})},removeFormat:function(){document.execCommand("removeFormat",null,null)},setHTML:function(A){this.element.innerHTML=A},getHTML:function(){var A=In2iGui.MarkupEditor.util.clean(this.element);return A.innerHTML}};In2iGui.MarkupEditor.MSIE={initialize:function(A){this.element=A.element;this.iframe=n2i.build("iframe",{style:"display:block; width: 100%; border: 0;",parent:this.element});n2i.listen(this.iframe,"load",this._load.bind(this));this.controller=A.controller},saveSelection:function(){this.savedRange=this.document.selection.createRange()},restoreSelection:function(A){window.setTimeout(function(){this.body.focus();this.savedRange.select();if(A){A()}}.bind(this))},_load:function(){this.document=n2i.getFrameDocument(this.iframe);this.body=this.document.body;this.body.contentEditable=true;n2i.listen(this.body,"keyup",this._keyUp.bind(this));n2i.listen(this.body,"mouseup",this._mouseUp.bind(this));this.controller.implIsReady()},_keyUp:function(){this.controller.implValueChanged();this.saveSelection()},_mouseUp:function(){this.saveSelection()},focus:function(){this.body.focus();this.controller.implFocused()},align:function(B){var A={center:"justifycenter",justify:"justifyfull",left:"justifyleft",right:"justifyright"};this.document.execCommand(A[B],null,null)},format:function(A){if(A.key=="strong"||A.key=="em"){this._wrapInTag(A.key)}else{if(A.key=="insert-table"){this._insertHTML("<table><tbody><tr><td>Lorem ipsum dolor</td><td>Lorem ipsum dolor</td></tr></tbody></table>")}else{this.document.execCommand(A.key,null,null)}}},removeFormat:function(){this.document.execCommand("removeFormat",null,null)},colorize:function(A){this.document.execCommand("forecolor",null,A);this.restoreSelection()},_wrapInTag:function(A){document.execCommand("inserthtml",null,"<"+A+">"+n2i.escape(n2i.getSelectedText())+"</"+A+">")},_insertHTML:function(A){document.execCommand("inserthtml",null,A)},setHTML:function(A){this.body.innerHTML=A},getHTML:function(){var A=In2iGui.MarkupEditor.util.clean(this.body);return A.innerHTML}};In2iGui.MarkupEditor.util={clean:function(C){var D=C.cloneNode(true);this.replaceNodes(D,{b:"strong",i:"em",font:"span"});var B=n2i.byClass(D,"Apple-style-span");for(var A=B.length-1;A>=0;A--){B[A].removeAttribute("class")}this.convertAttributesToStyle(D);return D},replaceNodes:function(F,G){for(var D in G){var B=F.getElementsByTagName(D);for(var C=B.length-1;C>=0;C--){var E=document.createElement(G[D]);var A=B[C].getAttribute("color");if(A){E.style.color=A}n2i.dom.replaceNode(B[C],E)}}},convertAttributesToStyle:function(C){var B=C.getElementsByTagName("*");for(var A=0;A<B.length;A++){var E=B[A];var D=E.getAttribute("align");if(D){E.style.textAlign=D;E.removeAttribute("align")}}}};In2iGui.ColorPicker=function(A){this.options=A||{};this.name=A.name;this.element=n2i.get(A.element);this.color=null;this.buttons=[];this.preview=n2i.firstByClass(this.element,"in2igui_colorpicker_preview");this.pages=n2i.byClass(this.element,"in2igui_colorpicker_page");this.input=n2i.firstByTag(this.element,"input");this.wheel1=this.pages[0];this.wheel2=this.pages[1];this.wheel3=this.pages[2];this.swatches=this.pages[3];In2iGui.extend(this);this.addBehavior();this.buildData()};In2iGui.ColorPicker.create=function(C){var A="",F,E,B;for(var D=0;D<360;D+=30){for(B=0.05;B<=1;B+=0.15){F=n2i.Color.hsv2rgb(D,B,1);E=n2i.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}for(B=1;B>=0.2;B-=0.15){F=n2i.Color.hsv2rgb(D,1,B);E=n2i.Color.rgb2hex(F);A+='<a style="background: rgb('+F[0]+","+F[1]+","+F[2]+')" rel="'+E+'"></a>'}}for(B=255;B>=0;B-=255/12){E=n2i.Color.rgb2hex([B,B,B]);A+='<a style="background: rgb('+Math.round(B)+","+Math.round(B)+","+Math.round(B)+')" rel="'+E+'"></a>'}C=C||{};C.element=n2i.build("div",{"class":"in2igui_colorpicker",html:'<div class="in2igui_bar in2igui_bar_window"><div class="in2igui_bar_body"><a class="in2igui_bar_button in2igui_bar_button_selected" href="javascript:void(0)" rel="0"><span class="in2igui_icon_1" style="background: url('+In2iGui.getIconUrl("colorpicker/wheel_pastels",1)+')"></span></a><a class="in2igui_bar_button" href="javascript:void(0)" rel="1"><span class="in2igui_icon_1" style="background: url('+In2iGui.getIconUrl("colorpicker/wheel_brightness",1)+')"></span></a><a class="in2igui_bar_button" href="javascript:void(0)" rel="2"><span class="in2igui_icon_1" style="background: url('+In2iGui.getIconUrl("colorpicker/wheel_saturated",1)+')"></span></a><a class="in2igui_bar_button" href="javascript:void(0)" rel="3"><span class="in2igui_icon_1" style="background: url('+In2iGui.getIconUrl("colorpicker/swatches",1)+')"></span></a><input class="in2igui_colorpicker"/></div></div><div class="in2igui_colorpicker_pages"><div class="in2igui_colorpicker_page in2igui_colorpicker_wheel1"></div><div class="in2igui_colorpicker_page in2igui_colorpicker_wheel2"></div><div class="in2igui_colorpicker_page in2igui_colorpicker_wheel3"></div><div class="in2igui_colorpicker_page in2igui_colorpicker_swatches">'+A+'</div></div><div class="in2igui_colorpicker_preview"></div>'});return new In2iGui.ColorPicker(C)};In2iGui.ColorPicker.prototype={addBehavior:function(){var A=n2i.byClass(this.element,"in2igui_bar_button");for(var C=0;C<A.length;C++){var B=new In2iGui.Bar.Button({element:A[C]});B.listen(this);this.buttons.push(B)}n2i.listen(this.element,"click",this._click.bind(this));n2i.listen(this.wheel1,"mousemove",this._hoverWheel1.bind(this));n2i.listen(this.wheel1,"click",this._pickColor.bind(this));n2i.listen(this.wheel2,"mousemove",this._hoverWheel2.bind(this));n2i.listen(this.wheel2,"click",this._pickColor.bind(this));n2i.listen(this.wheel3,"mousemove",this._hoverWheel3.bind(this));n2i.listen(this.wheel3,"click",this._pickColor.bind(this));n2i.listen(this.element,"mousedown",function(D){n2i.stop(D)});n2i.listen(this.swatches,"mousemove",function(D){D=n2i.event(D);this._hoverColor(D.element.getAttribute("rel"))}.bind(this));n2i.listen(this.swatches,"click",this._pickColor.bind(this))},$click:function(B){var C=parseInt(B.element.getAttribute("rel")),A;for(A=this.pages.length-1;A>=0;A--){this.pages[A].style.display=A==C?"block":"none"}for(A=0;A<this.buttons.length;A++){this.buttons[A].setSelected(this.buttons[A]==B)}},_click:function(B){B=n2i.event(B);B.stop();var A=B.findByTag("input");if(A){A.focus()}},_pickColor:function(A){n2i.stop(A);this.fire("colorWasSelected",this.color)},_hoverColor:function(A){this.preview.style.background=A;this.color=A;this.fire("colorWasHovered",this.color);this.input.value=A},buildData:function(){var A=new Array();A[0]=new Array(0,1,0);A[1]=new Array(-1,0,0);A[2]=new Array(0,0,1);A[3]=new Array(0,-1,0);A[4]=new Array(1,0,0);A[5]=new Array(0,0,-1);A[6]=new Array(255,1,1);var E=new Array(360);for(var D=0;D<6;D++){for(var C=0;C<60;C++){E[60*D+C]=new Array(3);for(var B=0;B<3;B++){E[60*D+C][B]=A[6][B];A[6][B]+=(A[D][B]*4)}}}this.colorArray=E},_hoverWheel1:function(O){O=n2i.event(O);var B=n2i.getPosition(this.wheel1);var E=4*(O.getLeft()-B.left);var C=4*(O.getTop()-B.top);var I=E-512;var G=C-512;var S=(I<0)?0:1;var R=(G<0)?0:1;var J=2*R+S;var D=new Array(-180,360,180,0);var N=Math.abs(I);var A=Math.abs(G);var P=A*45/N;if(A>N){P=90-(N*45/A)}var F=Math.floor(Math.abs(D[J]-P));I=Math.abs(E-512);G=Math.abs(C-512);var H=Math.sqrt((I*I)+(G*G));if(E==512&C==512){var Q="000000"}else{var K=0;for(var M=0;M<3;M++){var L=this.colorArray[F][M]*H/256;if(H>256){L+=Math.floor(H-256)}if(L>255){L=255}K=256*K+Math.floor(L)}Q=K.toString(16)}while(Q.length<6){Q="0"+Q}this._hoverColor("#"+Q)},_hoverWheel2:function(J){var K,E,D;J=n2i.event(J);var L=n2i.getPosition(this.wheel2);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{if(A>=0.5){E=1-((A-0.5)*2);D=1;K=n2i.Color.hsv2rgb(O,E,D)}else{E=1;D=A*2;K=n2i.Color.hsv2rgb(O,E,D)}}}this._hoverColor(n2i.Color.rgb2hex(K))},_hoverWheel3:function(J){var K,E,D;J=n2i.event(J);var L=n2i.getPosition(this.wheel3);var N=(J.getLeft()-L.left);var M=(J.getTop()-L.top);if(M>256){return }var G=N-128;var F=128-M;var I=G*G;var C=F*F;var B=Math.sqrt(I+C);var A=B/128;if(B==0){E=0;D=0;K=new Array(0,0,0)}else{var H=Math.acos(G/B);var P=(F>=0)?H:2*Math.PI-H;var O=360*P/(2*Math.PI);if(A>1){K=new Array(255,255,255);E=1;D=1}else{E=A;D=1;K=n2i.Color.hsv2rgb(O,E,D)}}this._hoverColor(n2i.Color.rgb2hex(K))}}